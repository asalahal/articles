Since January 2020 Elsevier has created a COVID-19 resource centre with
free information in English and Mandarin on the novel coronavirus COVID-
   19. The COVID-19 resource centre is hosted on Elsevier Connect, the
                company's public news and information website.
     Elsevier hereby grants permission to make all its COVID-19-related
research that is available on the COVID          -19 resource centre - including this
   research content - immediately available in PubMed Central and other
publicly funded repositories, such as the WHO COVID database with rights
for unrestricted research re-use and analyses in any form or by any means
    with acknowledgement         of the original source. These permissions are
 granted for free by Elsevier       for as long as the COVID       -19 resource centre
                                     remains active.

                                                                   Contents lists available at ScienceDirect
                                                       Artificial Intelligence In Medicine
                                                         journal           homep               age:      www.el               sevier.com/l                    ocate/artmed
Research  paper
An  integrated  LSTM-HeteroRGNN  model  for  interpretable  opioid  overdose
risk  prediction
Xinyu  Dong         a,  Rachel  Wongb,  Weimin  Lyu                    a,  Kayley  Abell-Hart            b,  Jianyuan  Deng            b,  Yinan  Liu       a,
Janos  G.  Hajagos           b,  Richard  N.  Rosenthal              c,  Chao  Chen         a,b,*,  Fusheng  Wang             a,b,**
aDepartment of Computer Science, Stony Brook University, Stony Brook, NY, United States of America
bDepartment of Biomedical Informatics, Stony Brook University, Stony Brook,  NY, United  States of America
cDepartment of Psychiatry, Renaissance School of Medicine at Stony Brook University, Stony Brook, NY, United States of America
ARTICLE                          INFO                     ABSTRACT
Keywords:                                                 Opioid overdose (OD) has become a leading cause of accidental death in the United States, and overdose deaths
Opioid overdose                                           reached a record high during the COVID-19 pandemic. Combating the opioid crisis requires targeting high-need
Opioid poisoning                                          populations by identifying individuals at risk of OD. While deep learning emerges as a powerful method for
Deep learning                                             building predictive models using large scale electronic health records (EHR), it is challenged by the complex
Clinical decision support                                 intrinsic relationships among EHR data. Further, its utility is limited by the lack of clinically meaningful
Electronic health records                                 explainability, which is necessary for making informed clinical or policy decisions using such models. In this
Long short-term memory
Graph neural network                                      paper, we present LIGHTED, an integrated deep learning model combining long short term memory (LSTM) and
                                                          graph neural networks (GNN) to predict patients' OD risk. The LIGHTED model can incorporate the temporal
                                                          effects of disease progression and the knowledge learned from interactions among clinical features. We evaluated
                                                          the model using Cerner's Health Facts database with over 5 million patients. Our experiments demonstrated that
                                                          the model outperforms traditional machine learning methods and other deep learning models. We also proposed
                                                          a novel interpretability method by exploiting embeddings provided by GNNs to cluster patients and EHR features
                                                          respectively, and conducted qualitative feature cluster analysis for clinical interpretations. Our study shows that
                                                          LIGHTED can take advantage of longitudinal EHR data and the intrinsic graph structure of EHRs among patients
                                                          to provide effective and interpretable OD risk predictions that may potentially improve clinical decision support.
1. Introduction                                                                                    In recent years, deep learning methods have gained popularity in
                                                                                               building predictive models to assist clinical decision support. Sequential
    The United States is experiencing an opioid crisis, with an estimated                      models such as the recurrent neural network (RNN) have been widely
10 million people aged 12 or older misusing opioids in 2019 [1], and                           applied to diseases such as Parkinson, Alzheimer's, and heart disease
130 deaths a day from opioid overdose (OD) [2]. The estimated eco-                             [4–6] for their ability to incorporate the temporal effects of disease
nomic burden of the opioid epidemic is approximately 78.5 billion                              development. Advanced RNN models like long short-term memory
dollars per year [3]. Early intervention to reduce the risk of OD can help                     (LSTM) models have been shown to have high performance in opioid
to decrease opioid-related mortality, and building a predictive risk                           related disease prediction [7–9].
model for OD can help to inform interventions. Large-scale electronic                              In addition to the temporal dynamics of EHR data, complex in-
health records (EHRs) provide enormous amounts of data that can be                             teractions and extreme sparsity of features are also major challenges for
used to build data-driven models. Such models can identify patients at                         developing predictive models with EHR data. Graph neural networks
high risk of OD and reveal critical explanatory knowledge for the                              (GNNs) are frequently used in building predictive models on data that
prediction.                                                                                    can be described by graphs [10], and hold the potential to address the
 *Correspondence to: C. Chen, Department of Biomedical Informatics, Stony Brook University, 2313C Computer Science, Stony Brook, NY 11794-8330, United
States of America.
 **Correspondence to: F. Wang, Department of Biomedical Informatics, Department of Computer Science, Stony Brook University, 2313D Computer Science, Stony
Brook, NY 11794-8330, United States of America.
    E-mail addresses: chao.chen.1@stonybrook.edu (C. Chen), fusheng.wang@stonybrook.edu (F. Wang).
https://doi.org/10.1016/j.artmed.2022.102439
Received 11 January 2022; Received in revised form 27 September 2022; Accepted 28 October 2022

X.  Dong et al.
above    challenges.    Traditional    deep    neural    networks    such    as    convolu-                              2.2.                 Study  population
tional neural networks (CNNs) and RNNs assume an underlying domain
with          a          regular          structure,          but          for          graph-structured          data,          the          local In this study, we use EHR data from January 1, 2008 to December 31,
neighborhood of each node does not have a fixed connectivity. Various                                                    2017.   For  the   patient   cohort,   we  extracted   all   patients  who   were   pre-
types of GNNs have been proposed to address this issue, such as graph                                                    scribed  medications  containing  active  opioid  ingredients.  We  used  the
convolutional networks (GCN) and graph attention transformers (GAT),                                                     Anatomical Therapeutic Chemical (ATC) level 3 code ‘N02A’           and cate-
resulting    in   powerful   predictive   models    [11–          13].    During    the   learning                       gory description ‘opioid’          to retrieve all relevant active ingredients from
phase    of   GNNs,    the    feature    representation    of    each    node    is    iteratively                       DrugBank   5.1.4   [21].  To   define   opioid   poisoning,   we  used   a   group  of
updated  based  on  information  from  itself  and  from  neighbors.  The  in-                                           ICD-9 and ICD-10 codes identified by Moore [22] to select patients with
formation         from         a         neighbor,         called         the         message,         is         a         linear         trans-opioid overdose.
formation       of       the       neighbor's       representation       in       its       previous       iteration.         The    distributions    of    the    first    opioid    medication    exposure    between
Furthermore,             heterogeneous             and             relational             GNN             models             can             set non-OD    and    OD   patients    are   not    identical;    compared    to    OD    patients,
different   types   to   nodes   and   edges   and   assign   different   parameters   to                                non-OD    patients    have    a    much    higher    proportion    of    patients    younger
them, then learn the variation with different parameters depending on                                                    than  16  years  and  a  much  lower  proportion  of  patients  who  are  older
the type of edge within the graph. With these more complex structures,                                                   than 66 years [23,24]. To make the distribution more consistent and also
rich   information   can   be   encoded   in   graphs,   which   achieve   better   pre-                                 to    prevent    bias    toward    age,    we    filtered    the    patients    to    include    those
diction   performance   [14–          16].   We   envision   that   GNN   can   be   useful   in                         between 16 and 66 [8].
clinical practice for two reasons. The complex relations between patients                                                     Patients     with     a     cancer     diagnosis     were     excluded.     They     often     have
sharing similar health conditions and diagnoses can be represented by a                                                  acute and varying symptoms of pain due to disease or treatment which
graph, which can be well represented by the graph structure of a GNN                                                     requires   opioid  therapy   for   pain  control.   As  medical  practitioners   and
model.  Moreover,  GNN  is  effective  in  tackling  the  sparsity  problem  in                                          public    health    leaders    have    largely    focused     on    guidelines    for    patients
EHR data. In the traditional tabular method to represent EHR data, the                                                   with     chronic      non-cancer     pain,      we      excluded     patients      with     cancer     di-
input data are extremely sparse as an indivieual patient is mostly asso-                                                 agnoses from our model [25]. We identified cancer diagnoses based on
ciated with a a limited set of clinical codes or tests while a large number                                              cancer         related         ICD-9         [26]         and         ICD-10         codes         [27]         (Supplementary
of features are available in the EHR database. GNN can help to address                                                   Table 2). The flowchart for patient selection is shown in Fig. 1.
the  sparsity  issue  since  patients  are  not  connected  to  features  that  are
absent in their encounters.                                                                                              2.3.                 Feature  selection
     Because        of        the        difficulty        in        interpreting        complex        deep        learning
models and the demand to find clinical meanings from the models, along                                                        We    extracted    the    following    five    categories    of    clinical    features    for
with   the   development   of   more   advanced   deep   learning   models,   many                                       prediction:      diagnosis      codes,      procedure      codes,      lab      tests,      medications,
efforts       have       been       made       to       interpret       the       models       and       give       clinically
meaningful   explanations.   Some   methods   attempt   to   give   explanations                                         clinical events, and demographic information. The following paragraphs
indirectly;    for    example,    model-agnostic    methods    use    an    interpretable                                detail the features in each category and how they were processed. Our
model to simulate deep learning models and use the interpretable model                                                   data preprocessing follows the methods used in our prior work [7,9].
as  a  proxy  to  provide  explanations  [17].  Other  interpretation  methods                                                Diagnosis          codes          specify          patients'          diseases          and          symptoms,          which
measure     feature     importance    based    on    the    changes     in    prediction    per-                         contain critical information for predicting future clinical events such as
formance after manipulating distributions of input feature values, such                                                  OD.    There    are   two   versions    of    ICD   codes,   ICD-9    and   ICD-10,    used    in
as  the  Local Surrogate model  (LIME) [18]  and  the permutation  impor-                                                Health Facts to record diagnoses. We converted ICD-9 codes to ICD-10
tance method [19].                                                                                                       when    they    indicate    the    same    clinical    meaning    to    avoid    dispersion    of
     In         this         work,         we         propose         a         longitudinal         and         graph         integrated predictability  [28].  Then,  in  order  to  reduce  granularity,  we  extracted
(LIGHTED) prediction  model using electronic health  records that com-                                                   the first 3 digits of each code as features.
bines LSTM and GNN for predicting opioid overdose risk in patients who                                                        Medications     are     recorded      by     National      Drug     Code      (NDC)     codes     in
have been prescribed opioid medications. LIGHTED takes advantage of                                                      Health Facts. The NDC code is a universal product identifier for human
not only the longitudinal history of patients' EHRs, but also the knowl-                                                 drugs specific to the individual label. Instead of manufacturer or pack-
edge           learned           from           relationships           among           patients,           encounters,           and ager   level   information,   a   clinically   meaningful   representation   is   more
different   types   of   features.   Our   experimental   results   demonstrate   that                                   useful            to            predictive            models,            so            we            converted            all           NDC            codes            to
our sequential deep learning model provides superior performance, with
a F1 score higher than traditional machine learning methods as well as
other    state-of-the-art    deep    learning    models.    We    also    propose    a    novel
interpretability        approach        in        which        we        group        features        and        patients
respectively using GNN representations, generating less redundant and
more                  semantically                  meaningful                  feature                  clusters                  for                  clinical                  in-
terpretations and informing clinical decision support.
2.                 Dataset  description
2.1.                 Data  source
     We chose Cerner's Health Facts database [20] as our data source to
build       the       dataset.       It       is       one       of       the       largest       EHR       databases,       with       de-
identified         data         from     >   65         million         patients         and         over         600         different
healthcare  facilities  in  the  United  States.  It  includes  records  of  patient
demographics,    encounters,    diagnoses,   prescriptions,    procedures,   labo-
ratory tests, and medical billing information.
                                                                                                                                                     Fig. 1.            Flowchart of  selecting patients.

X.  Dong et al.
Anatomical Therapeutic Chemical (ATC) codes. An ATC code is a unique                                                        encounter with a diagnosis of opioid poisoning. For negative cases, the
code    indicating    the    active    ingredients    according    to    the    system/organ                                last  encounter  was  used  as  the  target  encounter.  We  then  selected  the
they      target      and      how     they      work.      Moreover,      ATC     level      3     codes     were          last 5 encounters that occurred at least 14 days and at most 12 months
chosen    [29]   to    represent   all    medications,   because   level   3   is   the   most                              before    the    target    encounter    to    build    the    feature    vectors    (Fig.    2).    If    a
detailed therapeutic/pharmacological class, whereas higher levels (i.e.,                                                    patient had fewer than 5 encounters for the prediction, we repeated the
4,5) are for chemical classes. For each medication, the total medication                                                    last available encounter to fill the gap. For instance, if a patient had only
quantity prescribed to each patient was calculated as a feature for each                                                    3 encounters prior to the prediction encounter, then the feature matrix
medication.  In  addition,  morphine  milligram  equivalents  (MME)  were                                                   for   the   patient   would   be   composed   of   one   feature   vector   for   the   first
specifically calculated as an aggregate feature. MME is a value assigned                                                    encounter,        one        feature        vector        for        the        second        encounter,        and        three
to  opioids  representing  their  relative  potencies  compared  to  morphine                                               feature vectors replicated from the third encounter [7–          9]. We evaluated
[30,31],   which   is   an   informative   standardized   indicator   of   a   patient's                                    different numbers of encounters, and 5 was the optimal number with the
overall opioid intake. We summed all MMEs  for each encounter as the                                                        best  performance.  The  12  months'  constraint  is  a  common  standard  in
value for that feature.                                                                                                     previous  opioid  overdose  studies,  which  is  also  employed in  insurance
     Lab    Tests   record   a   sample   of   a   patient's   blood,   urine,   other   bodily                             claims and Veterans Health Administration areas [32–          35]. The 14 days'
fluid or body tissue, and analyze the sample to gain information about                                                      constraint is employed to exclude encounters with a close time frame to
the   patient's   health.   Common   lab   tests   include   complete   blood   count,                                      the date of the target.
prothrombin time, hemoglobin, etc. For each lab test, Health Facts not
only provides a  numeric value  result, but also a standardized interpre-                                                   3.                Methodology
tation    of    the   value   indicating    whether    it   is    high,    low,   or   normal.   We
calculated the portion of high and low values that each patient received                                                    3.1.                 Input  feature  matrix  construction
for      each      test,      as      well      as      the      total      number      of      tests      that      the      patients
received.                                                                                                                         Our data input is composed of two parts; we denote them as 1) raw
     Clinical events are other related personal health situations that are not                                              feature matrix and 2) graph embeddings. The raw feature matrix is built
formally     classified     into     medical     codes,    like     height,     weight,     and     BMI.                    by  following  the   procedure   in   the   previous  section   to   record  the   exis-
Some clinical events are highly relevant to opioid use, such as pain score                                                  tence    or    value    of    mentioned    clinical    features.    Graph    embeddings    are
indicating the pain level, and substance use history, which includes to-                                                    obtained by the GNN model described next to represent the interactions
bacco and alcohol.                                                                                                          of  features  and  patients.  Although  we  split  them  into  two  parts,  in  ac-
     Demographic     information     was     extracted     as     features,     including     age,                          tuality,  the  GNN  model  learns  graph  embeddings  from  the  graph  built
gender, and race/ethnicity.                                                                                                 through     extracting     feature     relations     from     the     raw     feature     input.     The
     To prevent overfitting, features of low co-occurrence with an opioid                                                   design of how we build each input feature matrix and feed them to the
overdose   diagnosis   were   removed,   which   we   defined   as  <   1   %   preva-                                      models is shown in Fig. 3.
lence  in  prior  records  of  all  opioid  overdose  patients.  For  this  filtering
threshold    of   1    %,    we    performed   an   experiment    to   test   the   prediction                              3.2.                 Heterogeneous  relational  graph  model  construction
performance with a threshold from 0.5 % to 5 % and also with a fixed
number of features from 100 to 2000 in previous work [7–          9]. Based on                                                    Heterogeneous       GNNs      are       a       variant       of      GNN       models      that      contain
the LSTM model's performance, we had the best result with a threshold                                                       different     types     of     nodes     and     edges     and     are     capable     of     capturing     the
of 1 %. To keep the work consistent and comparable, we continue with                                                        characteristics   of   different   node   and   edge   types   [14,15].   We   incorpo-
this           threshold           of          1          %.           After          the          removal           process,          1185           features rated      3      different      types      of      nodes:      patient,      encounter      and      feature,      as
remained, which included 414 diagnosis codes features, 394 laboratory                                                       shown in Fig. 4.
test   features,  3  demographic  features,  227   clinical  event  features,  and                                                Each     patient     node     represents     a     patient     and     each     encounter     node
147 medication features (summarized in Table 1).                                                                            represents one encounter for one patient. For each pair of node types, we
                                                                                                                            defined an edge type, such as a patient-encounter edge between patient
2.4.                 Encounter  selection for  input  construction                                                          and encounter nodes, or an encounter-feature edge between encounter
                                                                                                                            and feature nodes.
     For            input            feature            matrix            construction,            we            first            identified            the To    initiate    the    feature     node    vectors,    we     used    a    one-hot     encoding
encounter where the prediction target, or diagnosis of opioid poisoning,                                                    vector. The i-th entry with the value of 1 indicates a specific lab test was
first occurred. For positive cases, the prediction encounter was the first                                                  performed or a specific diagnosis was given (as shown in Fig. 5), and the
                                                                                                                            value of 0 indicates it was not present. For example, to represent the 414
                                                                                                                            different     diagnosis     features,     the     vector     for     the     diagnosis     node     had     a
Table 1                                                                                                                     length of 414 with value 1 or 0 indicating the presence or absence of a
Summary of features.                                                                                                        diagnosis respectively. Initial input vectors to nodes were then projected
  Datasets                                             Category                                                                                                             # of Description into a shared latent space with a trainable weight matrix W according to
                                               Features                                                                     different  feature  types.  Inspired  by  relational  GCN  models,  we  defined
                    Diagnosis                                                                                                  414                                                                                            First 3 digits of ICD-10 (ICD-9 codes the   following   propagation   model   for   calculating   the   forward-pass   up-
                                                                  were converted to ICD-10)                                 date of nodes:
                    Laboratory Test                                                                                                      ⎛                                   ⎞
                    Result                                                                                                                                  394                                                                                            Number of high, low and normal values for each test ∑1
                    Demographics                                                                             3                                                                                            Gender, Age, Race/Ethnicity hl+1=σ⎝∑Wlhl+Wlhl⎠
                                                                  Other related personal health                               i                       rci ,r  r  j       0  i
                                                                                                                                             r ∈R j∈Ni
  Health                                                          situations that are not formally
                                                                  classified into medical codes, e.g.,                            hl+1 is the hidden state of the node i in layer l +1, while hl is for layer
     Facts                                                        height, weight, BMI, smoking                                    r i                                                                                         i
                    Clinical Events                                               227 history and other substance use       l. Ni   denotes the set of neighbor indices of node i under relation r. For
                                                                                                                            each edge type, there is a weight vector Wr indicating the linear trans-
                                                                  history. Continuous variables like                                                                                              r
                                                                  height, weight, BMI are recorded by                       formation of that edge type. To ensure that the representation of a node
                                                                  their numeric value.                                      at layer l + 1 can also be informed by the corresponding representation
                                                                                                                            at layer l, we added weight Wl                      to the representation of layer l. c                        is a
                    Medication                                                                                  147                                                                                            Total quantity prescribed for each medication  0i,   r
                                                                                                                            problem-specific   normalization   constant   that   can   either   be   learned   or

X.  Dong et al.
                                                                                  Fig. 2.            Encounters for  prediction and building feature  matrix.
                                                                                          Fig.  3.            Structure of  input feature matrix and  model.
                                                                                          Fig.  4.            Structure of  heterogeneous relational  graph.
chosen   in   advance,   for   which   we   use   c                          =         ∣           Nr∣   .   During   the   training      3.3.                 Integration  with LSTM  model
                                                                        i,     r        i
phase, we obtained the weights for different types of edges. During the
test        phase,       we        reconstructed       the       graph        based       on       the        test        set        with       We        integrated        the        embeddings        learned        from        the        Heterogeneous
different edge connections and the same edge weights.                                                                                     graph with the LSTM model to form our proposed HeteroRGCN+LSTM

X.  Dong et al.
Fig. 5.            An example visual representation of features in a heterogeneous graph. The vector for each node is updated by aggregating node vectors of its neighborhood
nodes  and  its own  vector  from the  last layer. The  feature node vector  will be  initiated  by one-hot  encoding.
model, which we entitled “        LIGHTED”        . Long Short-Term Memory (LSTM)                               common   approach   is   to   rank   features   based   on   the   importance   of   the
networks  are  a  version  of  RNNs.  LSTM  has  two  main  advantages  over                                    predictions, through methods such as permutation importance [19] and
common   RNNs;   LSTM   has   better   memory   of   knowledge   learned   from                                 Shapley values [44]. However, feature importance ranking may not be
past inputs, and LSTM can solve the vanishing gradient problem faced by                                         informative enough for clinical use. First, some top features may not be
RNNs    [36].    The    embedding    of    patient    encounter    nodes    was    concate-                     available  in  the  EHR  for  a  specific  patient  due  to  the  sparse  nature  of
nated  with  original  feature  inputs,  together  forming  the  input  features                                EHR  data.  Second,  values  of  some  features  may  have  multiple  clinical
for  the  LSTM  model.  The  structure  of  the  proposed  LIGHTED  model  is                                   meanings;    for    example,   a    higher   weight   may    result   from    a   variety   of
shown   in  Fig.  6.  The  parameters  of   the  LSTM   and  graph  were  trained                               different health conditions. Lastly, the large number of features may be
simultaneously.        We         implemented        the         integrated         network        with        two intimidating    or    infeasible    for    clinicians    to    interpret,    considering    that
layers of HeteroRGCN with 100-dimensional embeddings and two layers                                             more than a thousand EHR features are used in the predictions.
of LSTM with 64 hidden units. The whole model was trained with binary                                                To    address    these    challenges,    we    first    provide    a    global    importance
cross-entropy loss function and Adam optimizer. These parameters were                                           ranking      for      all      features,      based      on      permutation      importance,      Shapley
chosen for their performance in preliminary experiments.                                                        value,  and  model-agnostic  methods.  Then,  we  apply  a  clustering  algo-
                                                                                                                rithm to group features based on graph embeddings extracted from the
3.4.                 Interpretability                                                                           LIGHTED model. Graph embedding is an approach to transform features
                                                                                                                and their graphic information into a vector space, and use those trans-
    Unlike inferential models, deep learning based predictive modeling                                          formed  vectors  as  representations  of  the  features.  It  is  commonly  ach-
can result in a “        black box”             with predictions difficult to interpret [37]. A                 ieved    by   the    inner    output    from    a    GNN    model    [55].   When    building    a
                                                                           Fig. 6.            Structure of integrated  LSTM-GNN  model.

X.  Dong et al.
graphic relation on the input features, every input feature is constructed                                        and   precision.   Therefore,   the   F1   score,   as   a   measurement   considering
as     a     numeric     vector     for     a     node     or     edge.     Then     a     GNN     model     can     be both precision and recall, is regarded as the best aggregated assessment
applied      to     those      input      features      correlated     by      the     graph      structure      to of the overall prediction performance. Along with the metrics, we also
perform  a  prediction  task. The  node  and  edge  vectors which  represent                                      applied t-tests to compare the results between our proposed model and
the   input  feature  are   updated  during   the  training  phase.  Finally,   after                             comparison methods to demonstrate that the novel model is statistically
training, the updated vectors are used as a graph embedding. Nodes or                                             significantly better than existing models. We repeated the experiment 30
edges   of   similar   structures   in   the   graph   will   have   similar   embeddings                         times,   then   applied   a   t-test   to   the   sequence   of   F-1   scores   and   AUROC
[56], which means similar effects in terms of the prediction task. Thus                                           scores separately to compute the p-value.
the graph embeddings are naturally suited for grouping by a clustering                                                 Our        implementation        environment        was        the        Python        programming
algorithm.   Fig.   7   shows   the   workflow   we   used   to   apply   clustering   al-                        language        (2.7).        Traditional        machine        learning        methods        were        imple-
gorithms on graph embeddings.                                                                                     mented  with the  Python  Scikit-Learn  package [38].  Deep  learning was
     In our LIGHTED model, EHR features are processed as node vectors,                                            implemented      with      Python      TensorFlow      [39],      Python      Keras      [40]      and
and       the       machine       learning       task       is       opioid       overdose       prediction.       After PyTorch Geometric [41]. Other libraries  used included Python  NumPy
training, the heterogeneous relational graph node features are updated                                            [42],    Python    Pandas    [43],    and    Python    SHAP    [44].    The    training    was
accordingly, and there is a vector of fixed length for each feature node                                          performed on an NVIDIA Tesla V100 (16GB RAM).
that can be used as a graph embedding for the feature. The clustering of
features' graph embeddings provides simplification of the feature set and                                         4.2.                 Prediction  result
reduces redundancy. Feature clustering may be more usable for clinical
interpretations, since the grouped features in a feature's cluster may help                                            We  compared  our  models  with  other  machine  learning  methods  to
to    infer    its   meaning.    Our    resulting    feature    clusters    were    qualitatively                 evaluate        the        effectiveness        of        the        proposed        model.        The        comparison
evaluated    by    2    board-certified   clinicians   to    1)    assess    clinically    mean-                  methods   can   be   classified   into   four   categories:   1)   traditional   methods
ingful patterns and to potentially map the clusters to clinical topics, and                                       (random        forest,        decision        tree,        logistic        regression        and        dense        neural
2) reassess the contents of the derived clusters for face-validity.                                               network) are applied on raw input matrix without graph embeddings; 2)
4.                 Experiment                                                                                     sequential    methods    (LSTM,    bidirectional    LSTM    [45],    attention    model
                                                                                                                  [46]      and      transformer      [47]      are      applied      on      raw      input      without      graph
4.1.                 Experiment  setting                                                                          embeddings;     and     3)     graph     models     (GCN     [12],     GAT     [13]     and     Heter-
                                                                                                                  oRGCN   [16])   are   applied   on   the   graph   embedding   without   raw   input
     After selection, a dataset was built consisting of 5,231,614 patients                                        matrix;  and  4)  sequential  graph  combined  models  (LSTM-GNN,  LSTM-
with at least one opioid prescription. Among them, 44,774 patients had                                            GCN    and    LSTM-GAT)   are   applied    on    both    graph    embedding    and   raw
an   opioid   poisoning   diagnosis   (“        positive”        )   and   5,186,840   patients   did             input feature matrix in the same way as LIGHTED (LSTM-HeteroRGNN)
not   have   any   recorded   opioid   poisoning   event   (“        negative”        ).   The   total            but        with        a        homogeneous        graph.        Table        2        shows        the        results        for        all
cohort of negative patients was portioned into 10 equal parts of 518,684                                          compared methods.
negative     patients     each.     Each     negative     patient     portion     was     combined                     The LIGHTED model achieved an F1 score of 0.8006. For precision,
with   all  the  positive  patients  together   for  an  evaluation,  with  random                                the best performance the LIGHTED model achieved was 0.8182, which
selection of 80 % as a training set and the remaining 20 % as the test set.                                       indicates    the    accuracy    of    a    positive    OD    prediction    for    a    patient.    The
We repeated the evaluation for all 10 portions, and an average value of                                           LIGHTED model also achieved the best recall, 0.7865, which measures
each performance metric was reported for evaluation.                                                              the ability to find all the OD patients in the dataset. In terms of F1 score,
     We          calculated         common          machine         learning          performance         metrics, the LIGHTED model had better performance than comparison methods.
including        precision,        recall,        F1        score,        and        Area        Under        the        Receiver For the transformer model, the difference was not statistically significant
Operating  Characteristic  curve  (AUROC).  Recall  is  a  critical  factor  for                                  (p-value≥0.05). As for AUROC, the LIGHTED model performed signifi-
prediction   models  as   it   identifies   how   many   potential   OD  patients   we                            cantly better than the transformer model, in addition to outperforming
can predict in advance. High recall can be achieved by tuning parame-                                             all other models.
ters  to  have  a  lower  precision,  since  there  is  a  tradeoff  between  recall                                   Fig. 8(A) shows the ROC curves for 6 major methods: random forest,
                                                                                                                  dense neural network, LSTM, Transformer, HeteroRGCN, and LIGHTED.
                                                         Fig.  7.            The workflow  of applying  clustering algorithms on  graph  embeddings.

X.  Dong et al.
Table 2
Summary of prediction performance results.
     Model                                                                                                                                                                                                                                                                             Precision                                                                                                                                                                                            Recall                                                                                                                                                                                                                         F-1                                                                                                                                                                                                                                                     AUROC                                                                                                                                                                                                          p-value p-value
                                                                                                                                                                                                                                                                                                                                                                                                          (F-1)                                           (AUROC)
     Traditional Methods (on raw feature input matrix)
     Random Forest                                                                                                                                                                                        0.7695 ± 0.0056                                                                                                               0.7055 ± 0.0038                                                                                                               0.7361 ± 0.0057                                                                                                               0.8291 ± 0.0037                                                   <  0.01                                                     <  0.01
     Decision Tree                                                                                                                                                                                                      0.7277 ± 0.0053                                                                                                               0.7047 ± 0.0029                                                                                                               0.7160 ± 0.0029                                                                                                               0.7892 ± 0.0048                                                   <  0.01                                                     <  0.01
     Logistic Regression                                                                                                                                                 0.7539 ± 0.0029                                                                                                               0.6050 ± 0.0026                                                                                                               0.6647 ± 0.0025                                                                                                               0.7147 ± 0.0035                                                   <  0.01                                                     <  0.01
     DNN                                                                                                                                                                                                                                                                                           0.8006 ±                  0.0052                                                                                                         0.7329 ±                  0.0046                                                                                                        0.7683 ±                  0.0027                                                                                                         0.8414 ±                  0.0028                                                <  0.01                                                     <  0.01
     Sequential Models (on raw feature input matrix)
     LSTM                                                                                                                                                                                                                                                                                  0.7884 ± 0.0054                                                                                                               0.7616 ± 0.0027                                                                                                               0.7798 ± 0.0060                                                                                                               0.8618 ± 0.0051                                                   <  0.01                                                     <  0.01
     Bi-LSTM                                                                                                                                                                                                                                                        0.7879 ± 0.0013                                                                                                               0.7615 ± 0.0012                                                                                                               0.7796 ± 0.0012                                                                                                               0.8593 ± 0.0065                                                   <  0.01                                                     <  0.01
     Attention                                                                                                                                                                                                                                               0.8128 ±                  0.0019                                                                                                         0.7512 ± 0.0012                                                                                                               0.7815 ± 0.0022                                                                                                               0.8749 ± 0.0024                                                   <  0.01                                                     <  0.01
     Transformer                                                                                                                                                                                                                   0.8124 ± 0.0086                                                                                                               0.7654 ±                  0.0109                                                                                                        0.7911 ±                  0.0019                                                                                                         0.8766 ±                  0.0060                                                                                                        0.117                                                       <  0.01
     Graph Models (on graph embeddings)
     GCN                                                                                                                                                                                                                                                                                             0.7867 ± 0.0089                                                                                                               0.7533 ± 0.0056                                                                                                               0.7696 ± 0.0020                                                                                                               0.8395 ± 0.0082                                                                                                               0.046                                                       <  0.01
     GAT                                                                                                                                                                                                                                                                                              0.7831 ± 0.0016                                                                                                               0.7433 ± 0.0086                                                                                                               0.7580 ± 0.0036                                                                                                               0.8292 ± 0.0095                                                   <  0.01                                                     <  0.01
     HeteroRGCN                                                                                                                                                                                                             0.8003 ±                  0.0060                                                                                                         0.7679 ±                  0.0021                                                                                                        0.7750 ±                  0.0017                                                                                                         0.8429 ±                  0.0046                                                <  0.01                                                     <  0.01
     Sequential Graph Combined Models (on both raw input and graph embeddings)
     LSTM-GNN                                                                                                                                                                                                                             0.7884 ± 0.0094                                                                                                               0.7728 ± 0.0096                                                                                                               0.7851 ± 0.0079                                                                                                               0.8589 ± 0.0133                                                   <  0.01                                                     <  0.01
     LSTM-GCN                                                                                                                                                                                                                               0.7991 ±                  0.0093                                                                                                         0.7767 ±                  0.0088                                                                                                        0.7877 ±                  0.0052                                                                                                         0.8608 ± 0.0085                                                   <  0.01                                                     <  0.01
     LSTM-GAT                                                                                                                                                                                                                                0.7971 ± 0.0076                                                                                                               0.7692 ± 0.0112                                                                                                               0.7828 ± 0.0047                                                                                                               0.8667 ±                  0.0076                                                <  0.01                                                     <  0.01
     Proposed Model
     LIGHTED                                                                                                                                                                                                                                                                                                                                                                                              *
          (LSTM-HeteroRGNN)                                                                                                         0.8182 ±                  0.0072                                                                                                         0.7856 ±                  0.0103                                                                                                        0.8006 ±                  0.073                                                                                                                     0.8969 ±                  0.0115
The best performance of each metric in every category is marked in bold.
     *    p-values are generated by comparing each method with LIGHTED, so there are no p-values in the row of LIGHTED itself.
Fig.    8(B)    shows    how    sensitivity    and    specificity    change    over    different                                                                                                                                                    probability when specificity equals 0.9 as the threshold for the medium
score  thresholds  for  binary  classification  in  LIGHTED.  Fig.  8(C)  shows                                                                                                                                                                     risk group. For all the medium risk patients, we excluded the patients in
the average time needed for one epoch when training each model. The                                                                                                                                                                                 the  high  risk  group,  while  for  the  low  risk  group,  we  excluded  the  pa-
LIGHTED     model     requires     longer     than     common     sequential     and     graph                                                                                                                                                      tients in high and medium risk groups. As a comparison, we applied the
models, but shorter training time than the transformer model.                                                                                                                                                                                       traditional clinical practice CMS opioid safety measure to split the risk
                                                                                                                                                                                                                                                    group level. Table 3 shows the portion of true positive and true negative
                                                                                                                                                                                                                                                    patients in each group after applying each grouping method.
4.3.                 Risk  scoring                                                                                                                                                                                                                            In  the  high  risk  group, >   96  %  of  patients  are  positive.  For  the  me-
                                                                                                                                                                                                                                                    dium risk group, around 60 % of patients are positive across the different
          To support clinical decision, model should be able to give an estimate                                                                                                                                                                    methods. Compared to the clinical practice, CMS opioid safety measure,
of the level of risk beyond a binary prediction. The clinical practices to                                                                                                                                                                          we have a low chance of misclassifying positive patients as negative. In
evaluate risk level of OD in the US are largely based on guidance from                                                                                                                                                                              the low risk group, only around 5 % of patients are positive. The ability
the CDC, where risk assessment is primarily driven by findings from the                                                                                                                                                                             to accurately identify risk groups can help clinicians and policymakers
literature. While some tools have recently been developed for prediction                                                                                                                                                                            to better target interventions toward patients at high risk of OD.
of   OD  risk,   they  are   mostly   based   on  MME.   For  example,   in   the   2019
CMS opioid safety measures [57], patients of high OD risk are identified
by high dose opioid use and concurrent use of benzodiazepines. Overall,                                                                                                                                                                             4.4.                 Interpretation
those tools are limited to make assessments on MME and a few related
medications.       Given       the       paucity       of       tools       for       clinical       practitioners       in                                                                                                                                   To    provide    better    interpretability    of   the    LIGHTED    model,    we    first
assessing     risk     of     overdose,     we     suggest     several     methods     for     grouping                                                                                                                                             provided and compared three importance feature ranking methods. We
patients into high/medium/low risk categories.                                                                                                                                                                                                      then   proposed   a   novel   interpretability   approach   by   grouping   features
          Based    on    the    patients'    probability    scores    from    LIGHTED,    we    used                                                                                                                                                and patients with the graph neural network representations.
four different methods to risk-stratify and group patients [32]. First, we
split the test dataset into two equal parts, used the first part to decide the                                                                                                                                                                      4.4.1.                 Feature  importance ranking
probability threshold to split the different risk level groups, then applied                                                                                                                                                                                  We    applied    population    level    feature    ranking    methods    to    our    pro-
the thresholds to the second part to report the negative and positive rates                                                                                                                                                                         posed       LIGHTED       method,       with       the       top       50       ranked       features       for       each
for each risk level group to validate the performance. For the high risk                                                                                                                                                                            method   listed   in   Table   4.   We   used   permutation   feature   importance,   a
group,     we      ranked      patients     by      probability     scores      and     then     identified                                                                                                                                         model-agnostic  decision  tree,  and  Shapley  values  to  rank  features.  For
those in the percentile <   1 % as high risk patients. We defined medium                                                                                                                                                                            the             permutation             method,             we             defined             feature             importance             as             the
risk      as      those      patients      with     probability      scores      in     the      1     %      to   <   10      %                                                                                                                    decreased  value  in  AUROC  metric   when  the  value  of  that  feature  was
percentile,     with     the     remaining     patients     designated     as     low     risk.     As     a                                                                                                                                        blinded  to  the  model  [19].  Model-agnostic  methods  include  the  use  of
second method for scoring patient risk, we set the probability threshold                                                                                                                                                                            interpretable surrogate models such as a decision tree to simulate black-
that maximizes the F1 score as the threshold for the medium risk group.                                                                                                                                                                             box         deep         learning         models;         the         intrinsically         interpretable         model         is
Our third method for risk scoring was to take the probability threshold                                                                                                                                                                             trained using the  black box model predictions  instead of the  outcomes
when the summation of the sensitivity and specificity was maximized for                                                                                                                                                                             from  the  original  data  set.  The  surrogate  model  output  is  then  used  to
the        medium        risk        group        [48].        For        the        fourth        method,        we        took       the                                                                                                          rank     the     features     [17].     Shapley     values     involve     a     game     theory-based

X.  Dong et al.
Fig. 8.            (A) ROC curves for different models. (B) Specificity and sensitivity curves of LIGHTED over different probability thresholds. (C) Average time for epoch in
training  phase for  each model.
Table 3
True positive and negative ratios by different high/medium/low grouping rules.
       Risk Group                                                                                                                                                                                                                                                                                                               High Risk                                                                                                                                                                                                                                                                                                                                                  Medium Risk Low Risk
                                                                                                                                                                                                                                                                                                                               (exclude high risk)                                                                                                                                                         (exclude high and medium risk)
                                                                                                                                                               Positive                                                                      Negative                                                                          Positive                                                                                  Negative                                                                          Positive                                                                      Negative
                                                                                                                                                               (%)                                                                           (%)                                                                               (%)                                                                                       (%)                                                                               (%)                                                                           (%)
       Grouping Method                                                                                                             <  1 percentile                                                                                                                                                                             >  1 and <         10 percentile                                                                                                                                            other
                                                                                                                                                               (1216)                                                                                                                                                          (4956)                                                                                                                                                                      (50,174)
                                                                                                                                                               96.65                                                                                                                                                         3.35                                                                                                                                                                               60.69                                                                                                                                                                                          39.31                                                                                                                                                                   6.96                                                                                                                                                                      93.04
                                                                                                                                                               <  1 percentile                                                                                                                                                 Maximum F1 score                                                                                                                                                            other
                                                                                                                                                               (1216)                                                                                                                                                          (4708)                                                                                                                                                                      (50,422)
                                                                                                                                                               96.65                                                                                                                                                         3.35                                                                                                                                                                               62.11                                                                                                                                                                                          37.89                                                                                                                                                                   7.09                                                                                                                                                                      92.91
                                                                                                                                                               <  1 percentile                                                                                                                                                 Maximum                                                                                                                                                                     other
                                                                                                                                                               (1216)                                                                                                                                                          Sensitivity + Specificity                                                                                                                                                   (48,602)
                                                                                                                                                                                                                                                                                                                               (6528)
                                                                                                                                                               96.65                                                                                                                                                         3.35                                                                                                                                                                               52.48                                                                                                                                                                                          47.52                                                                                                                                                                   6.37                                                                                                                                                                      93.63
                                                                                                                                                               <  1 percentile                                                                                                                                                 Specificity = 0.9                                                                                                                                                           other
                                                                                                                                                               (1216)                                                                                                                                                          (5268)                                                                                                                                                                      (49,862)
                                                                                                                                                               96.65                                                                                                                                                         3.35                                                                                                                                                                               58.81                                                                                                                                                                                          41.19                                                                                                                                                                   6.83                                                                                                                                                                      93.16
       CMS Opioid Safety Measurea                                                                                                                              High Risk Group                                                                                                                                                                                                                                           Low Risk Group
                                                                                                                                                               (10,049)                                                                                                                                                                                                                                                  (46,297)
                                                                                                                                                               Positive: 34.30 %, Negative: 65.7 %                                                                                                                                                                                                                                                                                                                                             Positive: 2.22 %, Negative: 97.78 %
      a       The 2019 CMS opioid safety measures are meant to identify high-risk individuals or utilization behavior [57]. These measures include 3 metrics: (1) high-dose use,
defined as higher than 120 morphine milligram equivalent (MME) for 90 or more continuous days, (2) 4 or more opioid prescribers and 4 or more pharmacies, and (3)
concurrent opioid and benzodiazepine use for 30 or more days.

X.  Dong et al.
Table 4                                                                                                                                                                                                                                   Table 4 (continued            )
Top   50   features   for   each   interpretation   method   on   LIGHTED   model.   Features                                                                                                                                                  Rank                                 Shapley Value                                                                                                                                            Model-Agnostic Permutation
with clinical relevance are labeled with a number, (1) features related to pain/                                                                                                                                                                                                                                                              Method (Decision                                                   Importance
opioids/drug misuse, (2) features related to a mental health disorder (3) features                                                                                                                                                                                                                                                            Tree)
related to the respiratory system.                                                                                                                                                                                                                  30                                     White Blood Cell Count                                                  Carbon dioxide (3)                                                                         Nondependent
     Rank                                 Shapley Value                                                                                                                                            Model-Agnostic Permutation                                                                                                                                                                                    abuse of drugs (1)
                                                                                                    Method (Decision                                                  Importance                                                                    31                                     Mean Platelet Volume                                                                Mean Corpuscular                  Red Blood Cell
                                                                                                    Tree)                                                                                                                                                                                                                                     Hemoglobin                                                         Count
          1                                                 N02A: Opioids (1)                                                                                                     N02A: Opioids (1)                                                                               N02A: Opioids (1)  32                                     SPO2 (Saturation of Weight, Daily                                    Glomerular
          2                                                 Other and unspecified                   Blood Pressure                                                    Pain Scale Score                                                                                peripheral oxygen) (3)                                                  Kilograms                                                          Filtration Rate
                           disorders of back (1)                                                    Diastolic                                                         (1)                                                                                                                                                                                                                                        Estimated
          3                                                 Nondependent abuse of                   MME (1)                                                                                                                                                                          Antipropulsives  33                                     Anion Gap                                                                                                                                                                               Lymphocyte Percent                                                           Posterior pituitary
                           drugs (1)                                                                                                                                                                                                                                                                                                                                                                             lobe hormones
          4                                                 MME (1)                                                                                                                                                                                                Anesthetics, general                                                               Anesthetics, 34                                     Mean Corpuscular Posterior pituitary lobe BSA, Body Surface
                                                                                                                                                                      general                                                                                         Hemoglobin                                                              hormones                                                           Area
          5                                                 Weight                                                                                                                                                                                                                 Antipropulsives                                                                                                          Alcohol Use (1)  35                                     Chloride, Serum                                                                                                                         Weight, Ideal                                                                                                                               Potassium, Serum
          6                                                 Carbon dioxide (3)                                                                                               Respiratory Rate (3)                                                            Other analgesics 36                                     Glasgow Coma Score (3)                                        Glomerular Filtration         Hematocrit
                                                                                                                                                                      and antipyretics                                                                                                                                                        Rate Estimated
                                                                                                                                                                      (1)                                                                           37                                     Platelet Count                                                                                                                                             Temperature Temporal Pain, not
          7                                                 Essential hypertension                                                             Other analgesics and   Blood Pressure                                                                                                                                                          Artery                                                             elsewhere
                                                                                                    antipyretics (1)                                                  Diastolic                                                                                                                                                                                                                                  classified (1)
          8                                                 BSA, Body Surface Area                                                Height                                                                                                                                                                                               Blood Pressure 38                                     O2 Saturation (SO2) (3)                                             Creatinine, Serum Calcium, Serum
                                                                                                                                                                      Systolic (1)                                                                                                                                                            Quantitative
          9                                                 Aspartate                               Heart Rate                                                                                                                                                         Hypnotics and 39                                     Calcium, Serum                                                                                                                             Mean Corpuscular Creatinine, Serum
                           Aminotransferase / SGOT                                                                                                                    sedatives (2)                                                                                                                                                           Hemoglobin                                                         Quantitative
          10                                     General symptoms                                                                                                   BMI, Body Mass Index                                         Mean Corpuscular                                                                                             Concentration
                                                                                                                                                                      Hemoglobin                                                                    40                                     Episodic mood disorders                            Height, Inches                                                                                                                     Anxiolytics (2)
          11                                     Respiratory Rate (3)                                                                                  Weight                                                                                                                                                                                           Red Blood Cell (2)
                                                                                                                                                                      Distribution Width                                                            41                                     Other postprocedural                               Chloride, Serum                                                                                                    Blood Gas CO2
                                                                                                                                                                      (RDW)                                                                                           states                                                                                                                                     Total, Arterial (3)
          12                                     Diabetes mellitus                                                                                                                Pulse                                                                                                                                                                                                             MME (1)  42                                     Drug dependence (1)                                                                          Alkaline Phosphatase, Lymphocyte
          13                                     Other analgesics and                               Mean Arterial Pressure                                    Smoke, Exposure                                                                                                                                                                 Serum                                                              Percent
                           antipyretics (1)                                                                                                                           to Tobacco Smoke                                                              43                                     Potassium, Serum                                                                                                          Glucose, Serum/ Drug dependence
                                                                                                                                                                      (1)                                                                                                                                                                     Plasma Quantitative                                                (1)
          14                                     Other disorders of soft                            Temperature Oral                                                                                    Uterotonics                                 44                                     Prothrombin Time                                                                                                    ETCO2 (End Tidal UA White Blood
                           tissues                                                                                                                                                                                                                                                                                                            CO2) (3)                                                           Cell
          15                                     Creatinine, Serum                                  O2 Saturation (SO2)                                               Blood Urea                                                                    45                                     Symptoms involving                                 Albumin, Serum                                                                                                   Irrigating solutions
                           Quantitative                                                             (3)                                                               Nitrogen                                                                                        digestive system
          16                                     Blood Urea Nitrogen                                                                               Uterotonics                                                                                                                                                 Alkaline 46                                     Albumin, Serum                                                                                                                         Mean Platelet Volume                                           Essential (Primary)
                                                                                                                                                                      Phosphatase,                                                                                                                                                                                                                               Hypertension
                                                                                                                                                                      Serum                                                                         47                                     INR (International                                 BSA, Body Surface Area                                 Neutrophil Percent
          17                                     Glucose, Serum/Plasma                              Red Blood Cell                                                    Heart Rate                                                                                      Normalized Ratio)
                           Quantitative                                                             Distribution Width                                                                                                                              48                                     Sodium, Serum (3)                                                                                                Occupant of pick-up Erythrocytes Blood
                                                                                                    (RDW)                                                                                                                                                                                                                                     truck or van injured in                                            Automated Count
          18                                     Occupant of pick-up                                Pulse Peripheral                                                                                                   Chloride, Serum                                                                                                        noncollision transport
                           truck or van injured in                                                                                                                                                                                                                                                                                            accident (1)
                           noncollision transport                                                                                                                                                                                                   49                                     Chronic airway                                     Neutrophil Count                                                                                        Ammonia
                           accident (1)                                                                                                                                                                                                                               obstruction, not
          19                                     Red Blood Cell                                     SPO2 (Saturation of                                               Height                                                                                          elsewhere classified (3)
                           Distribution Width                                                       peripheral oxygen) (3)                                                                                                                          50                                     Blood Pressure Diastolic                                            Potassium, Serum                                                                                    Pulse
                           (RDW)
          20                                     Antiemetics and                                    Heart Rate Monitored                                              Weight                                                              approach to explain the output of any machine learning model [44].                                                       A
                           antinauseants
          21                                     Other symptoms                                     Blood Urea Nitrogen                                                         BMI, Body Mass                                            Shapley value measures the contribution of a given feature value to the
                           involving abdomen and                                                                                                                      Index                                                               difference between the actual prediction and the mean prediction. After
                           pelvis                                                                                                                                                                                                         calculating        the        Shapley        value        for        every        observed       value        of        a        given
          22                                     Anxiety, dissociative and                          Temperature (Route                                                Monocyte Count                                                      feature,  the  results  are  aggregated  by  taking  the  mean  (irrespective  of
                           somatoform disorders (2)                                                 Not Specified)
          23                                     Hemoglobin                                                                                                                                                                Weight, Pounds                                                                                                         Throat direction); this aggregate mean is compared across features to form an
                                                                                                                                                                      preparations                                                        importance ranking.
          24                                     Other and unspecified                              Cough suppressants,                                               Tobacco Use                                                                   After   ranking   the   features   according   to   each   of   the   three   methods
                           disorders of joint (1)                                                   excluding                                                         (Number of Years)                                                   (model-agnostic   decision  tree,  Shapley   value,  and  permutation  impor-
                                                                                                    combinations with                                                 (1)                                                                 tance), a practicing clinician investigator used knowledge of clinically-
                                                                                                    expectorants
          25                                     Pain, not elsewhere                                White Blood Cell Count                                 Albumin, Serum                                                                 recognizable   concepts   and   a   priori   features   with   a   known   OD   and/or
                           classified (1)                                                                                                                                                                                                 opioid      use      disorder      association      to      qualitatively      evaluate      the      top      50
          26                                     Symptoms involving                                 Pulse Oximetry (3)                                                                         Lymphocyte                                 features    from    each    interpretability    method    for    their    potential    clinical
                           respiratory system and                                                                                                                     Absolute Count                                                      relationships to opioid overdose. The characterization of features related
                           other chest symptoms (3)                                                                                                                                                                                       to     OD     are     shown     in     Table     4.                    Of     the     3    methods,     the     top     50     features
          27                                     Pain Scale Score (1)                                                                                     Glasgow Coma Score Basophils Percent
                                                                                                    (3)                                                                                                                                   identified     using     Shapley     values     (shown     in     Fig.     9)                    included     the     most
          28                                     Weight, Ideal                                                                                                                                                     Weight, Clinical                                                                                                     Other and clinically    meaningful    features    (20),    with    11    features    related    to    pain/
                                                                                                                                                                      unspecified                                                         opioid/non-medical drug use (marked with (1) in Table 4,                 yellow bars
                                                                                                                                                                      disorders of back                                                   in Fig. 8), 2 features corresponding to mental disorders (marked with (2)
                                                                                                                                                                      (1)
          29                                     Hematocrit                                                                                                                                                                         Hypnotics and Hemoglobin  in   Table   4,                  blue   bars   in   Fig.   8)   [49],                                                         and   7   corresponding   to   features
                                                                                                    sedatives (1)                                                                                                                         affecting the respiratory system (marked with (3) in Table 4,               green bars
                                                                                                                                                                                                                                          in Fig. 8) [50].

X.  Dong et al.
Fig.  9.            Top  50  important  features  identified  by  Shapley  value.  Features  in  yellow  are  related  to  pain/opioid/drug  misuse,  features  in  blue  are  related  to  mental
disorders and features in green are related to respiratory system. (For interpretation of the references to colour in this figure legend, the reader is referred to the web
version  of  this article.)
4.4.2.                 Feature  clustering                                                                                neural networks  can model the  interactions between  EHR  data.  There-
     To           potentially           simplify           the           feature           space           and           reduce           concept fore, we developed a new integrated model, LIGHTED, combining both
redundancy, we ran an agglomerative hierarchical clustering algorithm                                                     LSTM  and  GNN  frameworks  to  better  address  the  opioid  overdose  risk
on  the  graph  embeddings  of  all  features.  Clusters  were  evaluated  by  a                                          prediction problem.
clinical investigator to assess for clinically meaningful patterns where at                                                     Our        proposed        LIGHTED        integrated        model        achieved        a        promising
least   25%   of  the   features   had  a  definable  clinical  relationship  to   each                                   result,           with           a           higher            F1           score            than           traditional           learning           models,
other and thus gave the cluster potential explainability. Table 5 shows                                                   sequential     models,     or     graph      models      alone.     To      improve     model      inter-
partial    results    of    feature    clustering.    Some    clusters    (A,    B)    were    highly                     pretability, we identified top features related to opioid overdose, which
interpretable in the context of feature cluster relationship to OD, such as                                               could   be   used   as   explanatory   mechanisms   to   support   clinicians   in   the
clusters      with     multiple     diagnoses     related     to     accidental     injury     or     sub-                risk assessment process, and potentially, in a toolkit for clinical decision
stance/medication use or toxicity [51,52]. Other clusters (C), which we                                                   support.   We   also   explored   feature   embeddings   provided   by   the   graph
defined   as   intermediate   in   explainability,   contained   interpretable   fea-                                     clustering algorithm to group features into feature subsets with clinical
tures related to clinical reno-pulmonary systems. They may be related to                                                  meaning,   as   a   potential   simplified   representation   of   high   dimensional
OD     through     mechanisms      such     as     respiratory     depression     or     impaired                         EHR features.
renal       function      [53,54].       Some      clusters      (D)       did      not      have       any       clearly
identifiable patterns with clinical meaning.                                                                              5.1.                 Benefits of  the model
5.                 Discussion                                                                                                   Compared       with       other       traditional       and       deep       learning       models,       our
                                                                                                                          proposed          model          has          several          advantages.          First,          we          can          model          the
     With    the    wide    availability    of    electronic    health    records,    predictive                          dependence   relationship   between   observations   at   different   time   steps.
modeling  can  provide  a  powerful  approach  to  estimate  risks  of  opioid                                            Second,  the  interactions  between  features  and  patients  can  be  learned
overdose for patients and support early interventions for prevention and                                                  from  the  heterogeneous   graph  based  model.  Third,  graph  embeddings
risk     mitigation.     However,     the     complex     dynamics     and     interactions     of                        can be used to cluster features and glean higher-level interpretations of
EHR           data           make           it           difficult           for           traditional           machine           learning           and the features when clinically meaningful patterns emerge.
statistics-based   predictive   models   to   process.   Advanced   deep   learning
models can address these challenges of complex EHR data. Specifically,
the  sequential  LSTM  can  model  the  dynamics  of  EHR  data,  and  graph

X.  Dong et al.
 Table 5
 Samples of clustering result on graph embeddings.a
    Cluster A. Accidental Injury (High*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Cluster B. Substance/Medication Use or Toxicity (High*)
    Other slipping, tripping and stumbling and falls                                                                                                                             Acetaminophen, serum quantitative
       Occupant of pick-up truck or van injured in collision with fixed or stationary object                                                                                     Alcohol and/or drug, substance use
       Occupant of pick-up truck or van injured in noncollision transport accident                                                                                               Alcohol last use
       Occupant of pick-up truck or van injured in collision with heavy transport vehicle or bus                                                                                 Tobacco frequency other
       Other complications of procedures not elsewhere classified                                                                                                                Tobacco last use
       Motor vehicle traffic accidents                                                                                                                                           Smoking, attempt to quit in Past
       Accidents caused by submersion, suffocation, and foreign bodies                                                                                                           Smoking, willing to quit
       Other disorders of bone and cartilage                                                                                                                                     Smoking, readiness to quit
       Contusion of trunk                                                                                                                                                        Smoke, lives with someone who smokes
       Glasgow Coma Score                                                                                                                                                        Smoking packs/day
       BSA, body surface area estimated                                                                                                                                          Smoke, exposure to tobacco smoke
       Abdominal and pelvic pain                                                                                                                                                 Smoking history
       Injury of unspecified body region                                                                                                                                         Tobacco type
       Injury other and unspecified                                                                                                                                              Opioid related disorders
       Drugs, medicinal and biological substances causing adverse effects in therapeutic use                                                                                     Pain scale score
       MME                                                                                                                                                                       Muscle relaxants, peripherally acting agents
       Other personal history presenting hazards to health                                                                                                                       Drugs for constipation
       Pain, not elsewhere classified                                                                                                                                            Barbiturate, urine
       Pain associated with micturition                                                                                                                                          Poisoning by psychotropic agents
       Episodic mood disorders                                                                                                                                                   Antipsychotics
       Personality disorders                                                                                                                                                     Personal history of mental disorder
       Phencyclidine Urine                                                                                                                                                       QT corrected (QTc)
    Cluster C. Reno-Pulmonary Features (Intermediate*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Cluster D. No Identifiable Pattern (Low)
    Essential (primary) hypertension                                                                                                                             Vitamin B1, plain and in combination with vitamin B6 and B12
       Blood pressure diastolic sitting                                                                                                                          Red blood cell distribution width (RDW)
       Blood pressure systolic sitting                                                                                                                           Alcohol use
       Glomerular filtration rate/1.73 sq. M predicted among blacks creatinine based formula (MDRD)                                                              Blood pressure central venous
       UA bacteria                                                                                                                                               Neutrophil segmented percent
       Protein, urine                                                                                                                                            Intestinal anti-inflammatory agents
       Protein total, urine random                                                                                                                               Special screening examination for bacterial and spirochetal diseases
       Potassium, whole blood                                                                                                                                    Antivaricose therapy
       Calcium, serum                                                                                                                                            Other systemic drugs for obstructive airway diseases
       Bicarbonate HCO3                                                                                                                                          Disorders of external ear
       HCO3                                                                                                                                                      Encounter for immunization
       Other diseases of lung                                                                                                                                    LDL/HDL ratio
       Other diseases of respiratory system                                                                                                                      Gastritis and duodenitis
       Drugs for treatment of tuberculosis                                                                                                                       Unspecified viral hepatitis
       Symptoms involving respiratory system and other chest symptoms                                                                                            Carboxyhemoglobin
       Pain in throat and chest                                                                                                                                  Osteoarthrosis and allied disorders
       PIP (Peak inspiratory pressure)                                                                                                                           Symptoms involving urinary system
    a  * High/Medium/Low is the strength of connection between the features and their cluster titles, according to two board-certified clinicians.
5.2.                 Clinical  significance                                                                                             5.3.                 Limitations  and  future  work
      It is critical for OD prevention to identify high risk patients and learn                                                               Study    limitations    include    that    the    study    population    was    extracted
what features are related to the development of OD. Our model provides                                                                  from patients that received opioid prescriptions, so the results may not
the prediction for each patient and meaningful grouping of patients by                                                                  generalize    well   to    patients    who    used    non-prescribed    opioids.    Second,
the risk level. Moreover, it identifies EHR features most relevant to OD                                                                since the ground truth of the study was based on ICD codes in electronic
risk.     To     evaluate     which     features     were     most     important     for     prediction                                 health   records,   there  are   potentially   patients  who   had  OD  at   home  or
across different models, we identified 13 features that were included in                                                                who     were     coded     incorrectly     that     may     have     been     missed.     To     address
the    top    50    features    in    all    three    models.    Some    of    these    features    were                                those problems, we plan apply natural language processing methods to
directly  related  to  pain  or  opioid  related  treatment,  such  as  MME  and                                                        incorporate unstructured notes data in our model, since structured EHR
medication   category   N02A:   Opioids   and   Other   analgesics   and   antipy-                                                      data may have missing information. Third, our model is based on data
retics. Three additional features may have an indirect influence on risk                                                                from the Health Facts database, which may not be applied to other EHRs
of      OD:      high      Creatinine,      Serum      Quantitative;      low      Albumin;      and      low                           directly. To address this issue, in future studies, we will exploit transfer
Weight.      These      features      clinically      correspond      to      patients      with      either                            learning methods to integrate knowledge learned from the Health Facts
impaired  renal  function,  poor  nutritional  status  or  poor  synthetic  liver                                                       data with EHR data from our local health system.
function, which could increase the risk of OD because of impaired ability
to        metabolize        opioids.        Other        features        did        not        have        a        recognizable        6.                Conclusion
mechanistic    correlation    with    risk    of    OD.    For    the    clustering    on    graph
embeddings  of features,  we can see that some groups show  high inter-                                                                       Opioid overdose has become a leading cause of accidental death in
pretability for opioid overdose patient identification. With those groups                                                               the        United        States,        which        requires        pharmacologic        interventions        and
of features with clear clinical meaning, simplified explanatory labels can                                                              health efforts to address the epidemic. Predicting patients with high risk
be given to represent the corresponding clinical concept, increasing the                                                                for   OD   can   guide   the   early   interventions   in   the   developmental   trajec-
explainability for clinicians and patients.                                                                                             tory.            Our            integrated            LSTM-HeteroRGNN            model            LIGHTED            showed
                                                                                                                                        promising results on prediction of high risk patients, and provided fea-
                                                                                                                                        tures and feature clusters that are clinically meaningful to OD risk.

X.  Dong et al.
Declaration  of competing  interest                                                                                         [20]             University of Texas Health Science Center at Houston. SBMI Data Service. Accessed
                                                                                                                                    September 22, 2020.  https://sbmi.uth.edu/sbmi-data-service/data-set/cerner/.
                                                                                                                            [21]             Wishart David S, Feunang Yannick D, Guo An C, Lo Elvis J, Marcu Ana, Grant Jason
     The authors do not have any conflicts of interest to disclose.                                                                 R, Sajed Tanvir, Johnson Daniel, Li Carin, Sayeeda Zinat, Assempour Nazanin,
                                                                                                                                    Iynkkaran Ithayavani, Liu Yifeng, Maciejewski Adam, Gale Nicola,  Wilson Alex,
Acknowledgements                                                                                                                    Chin Lucy, Cummings Ryan, Le  Diana, Pon Allison, Knox Craig, Wilson Michael.
                                                                                                                                    DrugBank 5.0: a major update to the DrugBank database  for 2018. Nucleic Acids
                                                                                                                                    Research 2018;46(D1):D1074–        82. https://doi.org/10.1093/nar/gkx1037.
     This work was funded partially by the Stony Brook University OVPR                                                      [22]             Moore B, Barrett M. Case study: exploring  how opioid-related diagnosis codes
Seed               Grant              1158484-63845-6               and              National              Institutes              of               Health translate from ICD-9-CM to ICD-10-CM2017; 2018.
5R01CA253368.                                                                                                               [23]             American Psychiatric Association. Diagnostic and statistical manual of mental
                                                                                                                                    disorders (DSM-5®). American Psychiatric Pub; 2013.
                                                                                                                            [24]             Deng Jianyuan, Yang Zhibo, Ojima Iwao, Samaras Dimitris, Wang Fusheng.
Appendix  A.                 Supplementary  data                                                                                    Artificial intelligence in drug discovery: applications and techniques. Briefings in
                                                                                                                                    Bioinformatics 2022;23(1):bbab430. https://doi.org/10.1093/bib/bbab430.
                                                                                                                            [25]             Dowell D, Haegerich TM, Chou R. CDC guideline for prescribing opioids for chronic
     Supplementary data to this article can be found online at https://doi.                                                         pain—                   United States, 2016. JAMA 2016;315(15):1624–        45. https://doi.org/
org/10.1016/j.artmed.2022.102439.                                                                                                   10.1001/jama.2016.1464.
                                                                                                                            [26]             Centers for Disease Control and Prevention. Screening list of ICD-9-CM codes for
                                                                                                                                    casefinding. https://www.cdc.gov/cancer/apps/ccr/icd9cm_codes.pdf (accessed
References                                                                                                                          March 21, 2021).
                                                                                                                            [27]             Centers for Disease Control and Prevention. ICD-10-CM table of NEOPLASMS. https
 [1]             Substance Abuse and Mental Health Services Administration. Key substance use                                       ://ftp.cdc.gov/pub/Health_Statistics/NCHS/Publications/ICD10CM/2019/ic
       and mental health indicators in the United States: results from the 2019 National                                            d10cm_neoplasm_2019.pdf (accessed March 21, 2021).
       Survey on Drug Use and Health. Rockville: Center for Behavioral Health Statistics                                    [28]             Fareed A, Stout S, Casarella  J, Vayalapalli S, Cox J, Drexler K. Illicit opioid
       and Quality, Substance Abuse and Mental Health Services Administration; 2020.                                                intoxication: diagnosis and treatment. Subst Abuse Res Treat 2011:5. https://doi.
 [2]             Center for  Disease Control and Prevention. Assessing and Addressing Opioid Use                                    org/10.4137/SART.S7090.
       Disorder (OUD). Available from:. 2020. https://www.cdc.gov/drugoverdose/traini                                       [29]             Haghpanah T, Afarinesh M, Divsalar K. A review on hematological factors in
       ng/oud/index.html.                                                                                                           opioid-dependent people (opium and heroin) after the withdrawal period.
 [3]             CDC/NCHS. National vital statistics system, mortality. Available from: htt                                         Winter–        Spring Addict Health 2010;2(1-2):9–        16. PMID: 24494095; PMCID:
       ps://wonder.cdc.gov; 2018.                                                                                                   PMC3905505.
 [4]             Che C, Xiao  C, Liang J, Jin B, Zho J, Wang F. An rnn architecture with dynamic                            [30]             Guzel Derya, Yazici Ahmet Bulent, Yazici Esra, Erol Atila. Evaluation of
       temporal matching for personalized predictions of Parkinson's disease. In:                                                   immunomodulatory and hematologic cell outcome in heroin/opioid addicts.
       Proceedings of the 2017 SIAM international conference on data mining. Society for                                            Journal of Addiction 2018;2018:2036145. https://doi.org/10.1155/2018/
       Industrial and Applied  Mathematics; 2017.  p. 198–        206.  https://doi.org/10.1137/                                    2036145. 8 pages.
       1.9781611974973.23.                                                                                                  [31]             Becker Daniel  E, Phero James C. Drug therapy in dental practice: nonopioid and
 [5]             Pillai NS, Bee KK, Kiruthika J. Prediction of heart disease using rnn algorithm.                                   opioid  analgesics. Anesth Prog 2005;52(4):140–        9. https://doi.org/10.2344/0003-
       International research journal ofEngineering and Technology 2019:5.                                                          3006(2005)52[140,DTD]2.0.CO;2.
 [6]             Cui R, Liu M, Li G. Longitudinal analysis for Alzheimer's disease diagnosis using                          [32]             Lo-Ciganic W-H, Huang JL, Zhang HH, Weiss JC, Wu Y, Kwoh CK, et al. Evaluation
       RNN. In: 2018 IEEE 15th international symposium on biomedical imaging  (ISBI                                                 of  machine-learning algorithms for predicting opioid overdose risk among
       2018); 2018. p. 1398–        401. https://doi.org/10.1109/ISBI.2018.8363833.                                                 medicare beneficiaries with opioid  prescriptions. J JAMA Network Open 2019;2
 [7]             Dong X, Deng J, Hou W, Rashidian S, Rosenthal RN, Saltz M, Saltz JH, Wang F.                                       (3):e190968-e. PMCID: PMC6583312.
       Predicting opioid overdose risk of  patients with opioid prescriptions using                                         [33]             White AG, Birnbaum HG, Schiller M, Tang J, Katz NP. Analytic models to identify
       electronic health records based on temporal deep learning. J Biomed Inform 2021                                              patients at risk for  prescription opioid  abuse. Am J Manag Care  2009;15(12):
       Apr;1(116):103725. https://doi.org/10.1016/j.jbi.2021.103725.                                                                897–        906. PMID: 20001171.
 [8]             Dong X, Rashidian S, Wang Y, Hajagos J, Zhao X, Rosenthal RN, Kong J, Saltz M,                             [34]             Rice JB, White AG, Birnbaum HG, Schiller M, Brown DA, Roland CL. A model to
       Saltz J, Wang  F. Machine  learning based opioid overdose prediction using                                                   identify patients at risk  for prescription opioid abuse, dependence, and misuse.
       electronic health records. In: AMIA Annu Symp Proc; 2020. p. 389–        98. PMID:                                           Pain Med 2012;13(9):1162–        73. https://doi.org/10.1111/j.1526-4637.2012.
       32308832; PMCID: PMC7153049.                                                                                                 01450.x.
 [9]             Dong Xinyu, Deng Jianyuan, Rashidian Sina, Abell-Hart Kayley, Hou Wei,                                     [35]             Oliva EM, Bowe T, Tavakoli S, et al. Development and applications of the veterans
       Rosenthal Richard N, Saltz Mary, Saltz Joel H, Wang Fusheng. Identifying risk of                                             health Administration's stratification tool for  opioid risk  mitigation (STORM) to
       opioid use disorder for patients taking opioid medications with deep learning. J Am                                          improve opioid safety and prevent overdose and suicide. Psychol Serv. 2017;14(1):
       Med Inform Assoc 2021;28(8):1683–        93. https://doi.org/10.1093/jamia/ocab043.                                          34–        49. https://doi.org/10.1037/ser0000099.
[10]             Scarselli F, Gori M, Tsoi AC, Hagenbuchner M, Monfardini G. The graph neural                               [36]             Hochreiter S, Schmidhuber J. Long short-term memory. Neural Comput 1997;9(8):
       network model. IEEE Trans Neural Netw 2009;20(1):61–        80. https://doi.org/                                             1735–        80. https://doi.org/10.1162/neco.1997.9.8.1735.
       10.1109/TNN.2008.2005605.                                                                                            [37]             Breiman  Leo. Statistical modeling: the two cultures  (with comments and a
[11]             Wu Z, Pan S, Chen F, Long G, Zhang C, Yu PS. A comprehensive survey on graph                                       rejoinder by the author). StatSci 2001;16(3):199–        231. https://doi.org/10.1214/ss/
       neural networks. IEEE Trans Neural Netw Learn Syst 2021;32(1):4–        24. https://doi.                                     1009213726.
       org/10.1109/TNNLS.2020.2978386.                                                                                      [38]             Pedregosa F, et al. In: Scikit-learn: machine learning in Python. 12; 2011.
[12]             Defferrard M, Bresson X, Vandergheynst P. Convolutional neural networks on                                         p. 2825–        30.
       graphs with fast localized spectral filtering.  Adv Neural Information Process Syst                                  [39]             Abadi M, et al. Tensorflow: A system for large-scale machine learning.  In: 12th
       2016;29:3844–        52.                                                                                                     {USENIX} Symposium on operating systems  design and implementation ({OSDI}
[13]             Veliˇckovi´c P, Cucurull G, Casanova A, Romero A, Lio P, Bengio Y. Graph attention                                 16); 2016.
       networks.  arXiv preprint; 2017. arXiv:1710.10903.                                                                   [40]             Chollet F, et al. Keras. Available from: GitHub; 2015.  https://github.com/fcholl
[14]             Zhang Chuxu, Song Dongjin, Huang  Chao, Swami Ananthram, Chawla Nitesh V.                                          et/keras.
       Heterogeneous graph neural network.  In: Proceedings of the 25th ACM SIGKDD                                          [41]             Fey M, Lenssen JE. Fast graph representation learning with PyTorch Geometric.
       international conference on knowledge discovery  &              data mining (KDD '19). New                                   arXiv preprint; 2019. arXiv:1903.02428.
       York, NY, USA: Association for Computing Machinery; 2019. p. 793–        803. https://                               [42]             Bressert E. SciPy and NumPy:  an overview for  developers. O'Reilly Media,  Inc.;
       doi.org/10.1145/3292500.3330961.                                                                                             2012.
[15]             Wanyan Tingyi, Honarvar Hossein, Azad Ariful, Ding Ying, Glicksberg Benjamin S.                            [43]             McKinney W.  “      pandas: a foundational Python library for data analysis and
       Deep learning with heterogeneous graph embeddings for mortality prediction from                                              statistics”      . In: Python for high performance and scientific computing. 14; 2011.
       electronic  health records. DataIntelligence 2021;3(3):329–        39. https://doi.org/                                      p. 1–        9. dlr.de.
       10.1162/dint_a_00097.                                                                                                [44]             Lundberg Scott M, Lee Su-In. A unified approach to interpreting model predictions.
[16]             Schlichtkrull M, Kipf TN, Bloem P, van den Berg R, Titov I, Welling M. Modeling                                    In: Proceedings of the 31st international conference on neural information
       relational  data with graph convolutional networks.  In: The semantic web. ESWC                                              processing systems (NIPS'17). Red Hook, NY, USA: Curran Associates Inc.; 2017.
       2018. lecture notes in computer science. 10843. Cham: Springer; 2018. https://doi.                                           p. 4768–        77.
       org/10.1007/978-3-319-93417-4_38.                                                                                    [45]             Schuster M, Paliwal KK. Bidirectional recurrent neural networks. IEEE Trans Signal
[17]             Ribeiro  MT, Singh S, Guestrin C. Model-agnostic interpretability of  machine                                      Process 1997;45(11):2673–        81. https://doi.org/10.1109/78.650093.
       learning.  arXiv preprint; 2016. arXiv:1606.05386.                                                                   [46]             Vaswani A, Shazeer  N, Parmar N, Uszkoreit J, Jones L, Gomez AN, Kaiser L,
[18]             Ribeiro  Marco Tulio, Singh Sameer, Guestrin Carlos. "Why should I trust you?":                                    Polosukhin I. Attention is all you need. In: 31st conference on neural information
       explaining  the predictions of  any classifier. In: Proceedings of the 22nd  ACM                                             processing systems; 2017. p. 5998–        6008. http://papers.nips.cc/paper/7181-attent
       SIGKDD international conference on knowledge discovery and data mining (KDD                                                  ion-is-all-you-need.pdf.
       '16). New York, NY, USA: Association for Computing Machinery; 2016. p. 1135–        44.                              [47]             Devlin J, Chang MW, Lee K, Toutanova K. Bert: Pre-training of deep bidirectional
       https://doi.org/10.1145/2939672.2939778.                                                                                     transformers for language understanding. arXiv preprint; 2018. arXiv:1810.04805.
[19]             Breiman  L. Bagging predictors. Mach Learn  1996;24(2):123–        40.                                     [48]             Fluss R, Faraggi D, Reiser B. Estimation of  the youden index  and its associated
                                                                                                                                    cutoff point. Biom J 2005;47:458–        72. https://doi.org/10.1002/bimj.200410135.

X.  Dong et al.
[49]             Turner BJ, Liang Y. Drug overdose in a retrospective cohort with non-cancer pain                                                            [53]             Vu Q, Beselman A, Monolakis J, Wang A, Rastegar D. Risk factors for  opioid
         treated with opioids, antidepressants, and/or sedative-hypnotics: interactions with                                                                           overdose among hospitalized patients. J Clin Pharm Ther 2018;43:784–9.                                                                                                                                      https://
         mental health disorders. J Gen Intern Med 2015;30:1081–96.                                                                                                                                                   https://doi.org/ doi.org/10.1111/jcpt.12701.
         10.1007/s11606-015-3199-4.                                                                                                                          [54]             Fox LM, Hoffman RS, Vlahov D, Manini AF. Risk factors for severe  respiratory
[50]             Nadpara Pramit A, Joyce  Andrew R, Murrelle ELenn, Carroll Nathan W,                                                                                  depression from prescription opioid overdose. Addiction 2018;113:59–66.                                                                                                                                      https://
         Carroll  Norman V, Barnard Marie, Zedler Barbara K. Risk  factors for serious                                                                                 doi.org/10.1111/add.13925.
         prescription opioid-induced respiratory depression or overdose: comparison of                                                                       [55]             Ji S, Pan S, Cambria E, Marttinen P, Yu PS. A survey on knowledge graphs:
         commercially insured and veterans health affairs populations. Pain Medicine 2018;                                                                             representation, acquisition, and applications. IEEE Trans Neural NetwLearn Syst
         19(1):79–96.                                                                                                https://doi.org/10.1093/pm/pnx038.                2022;33(2):494–514.                                                                                                                                                                   https://doi.org/10.1109/TNNLS.2021.3070843.
[51]             Asfaw A, Boden LI. Impact of workplace injury on opioid dependence, abuse, illicit                                                          [56]             Grover Aditya, Leskovec Jure. Node2vec: scalable feature learning for networks. In:
         use  and overdose: a 36-month retrospective study of insurance claims. Occup                                                                                  Proceedings of the 22nd  ACM SIGKDD international conference on knowledge
         Environ  Med 2020;77(9):648–53.                                                                                                                               discovery and data mining (KDD '16). New York, NY, USA: Association for
[52]             Barefoot  Elizabeth H, Cyr Julianne M, Brice Jane H, Bachman  Michael W,                                                                              Computing Machinery; 2016. p. 855–64.                                                 https://doi.org/10.1145/
         Williams Jefferson  G, Cabanas Jose G, Herbert Kyle  M. Opportunities for                                                                                     2939672.2939754.
         emergency  medical services  intervention to prevent opioid overdose mortality.                                                                     [57]             Centers for Medicare &             Medicaid Services (CMS). Announcement of calendar year
         Prehosp  Emerg Care  2021;25(2):182–90.                                                                                                                                                                   https://doi.org/10.1080/ (CY) 2019 Medicare Advantage capitation rates and Medicare Advantage and Part
         10903127.2020.1740363.                                                                                                                                        D payment policies and final call letter. Accessed November 6, 2018. https://www.
                                                                                                                                                                       cms.gov/Medicare/Health-Plans/MedicareAdvtgSpecRateStats/Downloads/
                                                                                                                                                                       Announcement2019.pdf.

