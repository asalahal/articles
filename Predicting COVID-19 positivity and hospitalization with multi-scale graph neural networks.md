                       OPEN                      Predicting COVID‑19 positivity
                                                 and                                                                                                                                                                                                           hospitalization with                                                                                                                                                                                                                                                  multi‑scale
                                                 graph neural networks
                                                 Konstantinos Skianis                                                                                                                                              1*                , Giannis Nikolentzos                                                                                                                                                                                      2, Benoit                          Gallix                              3,4, Rodolphe                          Thiebaut                                                                                                                                                                                     5,6 &
                                                 Georgios Exarchakis                                                                                                                                                                                                                                     3,4
                                                 The pandemic of COVID‑19 is undoubtedly one of the biggest challenges for modern healthcare. In
                                                 order to analyze the spatio‑temporal aspects of the spread of COVID‑19, technology has helped us
                                                 to track, identify and store information regarding positivity and hospitalization, across different
                                                 levels of municipal entities. In this work, we present a method for predicting the number of positive
                                                 and hospitalized cases via a novel multi‑scale graph neural network, integrating information from
                                                 fine‑scale geographical zones of a few thousand inhabitants. By leveraging population mobility data
                                                 and other features, the model utilizes message passing to model interaction between areas. Our
                                                 proposed model manages to outperform baselines and deep learning models, presenting low errors
                                                 in both prediction tasks. We specifically point out the importance of our contribution in predicting
                                                 hospitalization since hospitals became critical infrastructure during the pandemic. To the best of
                                                 our knowledge, this is the first work to exploit high‑resolution spatio‑temporal data in a multi‑scale
                                                 manner, incorporating additional knowledge, such as vaccination rates and population mobility data.
                                                 We believe that our method may improve future estimations of positivity and hospitalization, which is
                                                 crucial for healthcare planning.
                                                 Accurately modeling contagion dynamics is of paramount importance for preventing or controlling outbreaks of
                                                 infectious diseases. Thus, it comes as no surprise that a variety of models incorporating sophisticated contagion
                                                 mechanisms have been proposed over the past years     1–       3. These models have contributed to the design of bet -
                                                 ter public health policies since they allow us to improve our understanding of how infectious diseases spread.
                                                 However, these models are not always accurate and several challenges still need to be unresolved 4,5. This became
                                                 particularly evident during the worldwide pandemic of COVID-19. The SARS-CoV-2 virus which started spread-
                                                 ing in Wuhan, China in late 2019, spread to most countries around the world within a few months causing the
                                                 pandemic of the COVID-19 disease. The virus turned out to be particularly contagious. As of Februar y 14, 2022,
                                                 a total of 5,783,776 deaths and 404,910,528 cases of COVID-19 were confirmed worldwide               6. The COVID-19
                                                 pandemic has had a significant impact not only on the lives of individuals, but also on the global economy   7 and
                                                 on the environment 8, among others.
                                                       During a pandemic, it is critical for governments, policymakers and public health agencies to accurately
                                                 predict the spread of the infection. Among others, this will allow them to impose measures that will successfully
                                                 reduce the spread of the virus and also to effectively allocate healthcare resources. The standard approach to
                                                 predicting the spread of an infection is to use mathematical models such as the ones mentioned above. Several
                                                 such models have been developed for COVID-19            9–       13. There even exist models for determining the cost and
                                                 economic health outcomes of government inter ventions         14. However, such models usually integrate a limited
                                                 number of mechanisms and thus do not fully capture the complex nature of contagion dynamics. These models
                                                 can be made more complex by adding more detailed and sophisticated mechanisms. However, in many cases,
                                                 this requires a lot of effort or is practically not feasible. Furthermore, more complex models usually comprise of
                                                 a large number of parameters whose values can be difficult to infer from limited data.
                                                       Recently, there has been an increasing interest in machine learning and artificial intelligence approaches to
                                                 address the limitations of mathematical models  15,            16. This approach involves training predictive models on col-
                                                 lected real-world data. Such data-driven models can then be used for making accurate predictions, but also for
                                                 gaining insights into complex phenomena. Although these approaches were originally applied to other areas of
                                                 1BLUAI, Athens, Greece.  2École Polytechnique, Palaiseau, France. 3IHU, Strasbourg, France.  4ICube, CNRS,
                                                 University of Strasbourg, Strasbourg, France.  5INSERM     U1219,       Inria      SISTM,     University       of       Bordeaux,       Bordeaux,
                                                 France.     6Pôle     de    Santé     Publique,    Service     d’Information     Médicale,    CHU     de     Bordeaux,     Bordeaux,     France.  *email:
                                                 skianis.konstantinos@gmail.com
Scientific Reports |         (2023) 13:5235                                                                                                                                                                                                                                                                                           | https://doi.org/10.1038/s41598-023-31222-61

                                            physics 17, they have recently started being applied to epidemics spreading perhaps also motivated by the outbreak
                                            of COVID-19 18–                               20. Among the different families of deep learning approaches that have been developed in the past
                                            years, graph neural networks (GNNs)   21 are particularly suited to problems that involve some kind of network
                                            structure. These models have been applied with great success to different problems such as web recommenda-
                                            tions 22 and modeling physical systems  23. Thus, GNNs could offer great potential to build effective data-driven
                                            dynamical models on networks. Ideally, if we had access to the social network of all individuals which captures
                                            the interactions between them, we could build a model of the spread of the disease. Unfortunately, for the case
                                            of COVID-19, such information is not available.
                                                 In the absence of the aforementioned data, we use population mobility data instead. It has been reported that
                                            population movement between regions has a significant impact on the spread of the disease     24. Previous studies
                                            have also investigated what is the impact of other factors on the spread of COVID-19 such as the use of protec   -
                                            tive masks 25. By presenting a model with the amount of people that moved from one place to another, we can
                                            approximate, in a sense, the amount of people from the first region that came into contact with people from the
                                            second region. Mobility data can be represented as a graph where nodes correspond to regions and edges model
                                            the mobility between regions. Thus, the above becomes a well-suited setting for GNNs. Therefore, in this work,
                                            we show that GNNs can be used to model contagion dynamics on complex networks, i. e., networks that model
                                            mobility patterns. One of the key concepts behind GNNs is the concept of message passing. Specifically, there is
                                            a vector representation associated with each node of the graph, and this representation is updated for a number
                                            of iterations based on messages received from the node’s neighbors. Thus, each node (i. e., region) receives mes-
                                            sages that contain information about the spread of the virus in its neighboring nodes (i. e., regions) along with
                                            the number of people that arrived from these regions. In this study, we propose a multi-scale approach which uses
                                            GNNs to extract features from both low- and high-resolution data, thus leveraging information from different
                                            geographic levels. We apply the proposed architecture to the problem of modeling the spread of COVID-19 in
                                            France. Our findings indicate that in the context of COVID-19, leveraging additional features in a learning model
                                            can increase the model’s predictive ability. For instance, we found that disease spread depends on population
                                            mobility since this feature improves the predictive performance of our models. Similar conclusions were drawn
                                            for other features such as the vaccination rates. Finally, our analysis showed that the use of more granular data
                                            also benefits model performance. Note that COVID-19 spreading is a highly uncertain process which depends
                                            on many factors including human behavior, virus mutation, and vaccination rates. Thus, one cannot expect a
                                            model to always provide reliable predictions. Overall, this study shows that we can leverage mobility data to
                                            produce data-driven models which can complement existing methods.
                                                 Finally, it should be mentioned that this is not the first work to use GNNs to predict the spread of COVID-
                                            19 26–                                32. However, there are major differences between these studies and our work. For instance, some studies do
                                            not use mobility data  28. Others use single-scale models   26,            27,            29, while we Furthermore, most of these works do
                                            not focus on France, but on other countries such as the United States 26,                        28,                        31, Germany 29 or Japan 32. The datasets
                                            employed in these studies span time periods before the start of COVID-19 vaccination in the United States     26,            28
                                            or ignore or entirely ignore vaccination rates  30–                    32. On the other hand, in our work, we also consider the impact
                                            of vaccination on the spread of the disease.
                                            Data
                                            COVID‑19   positivity   and   hospitalization   datasets.                                                                                                                                                                       Modeling the spread and predicting COVID-19
                                            positivity and hospitalization requires high-quality data, which are freely available by Santé publique France.
                                            During the health crisis linked to the COVID-19 epidemic, Santé publique France is responsible for monitoring
                                            and understanding the dynamics of the epidemic, anticipating the various scenarios and implementing actions
                                            to prevent and limit the transmission of this virus on the national territor y. Santé publique France is the french
                                            national public health agency, created in May 2016. Towards this goal, the organization is gathering and offering
                                            freely numerous datasets that provide information regarding the COVID-19 pandemic. The virological sur veil-
                                            lance indicators come from the screening information system (SI-DEP), the objective of which is to report data
                                            from tests (RT-PCR) carried out by all city laboratories and hospitals concerning the SARS-COV-2.
                                                 Regarding positivity, data are available in both department and IRIS scale. IRIS represents the fundamental
                                            unit for dissemination of infra-municipal data. These units respect geographic and demographic criteria, while
                                            having clearly identifiable borders. The dataset provides information either in absolute numbers for departments,
                                            or about the class of positivity rate for all ages over 7 rolling days for IRIS areas. Concerning IRIS data, exact
                                            rates are not displayed in order to avoid identification of people tested, especially those who test positive. A
                                            screenshot of the Géodes                                                            tool33, created by Santé publique France, with regards to IRIS areas, is shown in Fig.     1.
                                            The positivity rate corresponds to the number of positive tests compared to the number of tests carried out. For
                                            the task of predicting hospitalization, we used the absolute number of new patients hospitalized in the last 24 h.
                                            Information and statistics on the data can be found in Table              1, while a visualization of the spread’s behavior
                                            throughout the studied duration is presented in Fig.   2. All data are accessible online  34.
                                            Facebook     mobility     dataset.                                                                                                                                    In order to study the spread of a virus like COVID-19, we need to track
                                            population movement, as it is one the most important factors. Responding to the COVID-19 outbreak, tech-
                                            nology companies and mobile phone operators are coming forward to provide important, epidemiologically-
                                            relevant data from mobile devices, that could help to inform policies that reduce the spread of the virus. As
                                            stated          in35, research and public health response communities can and should use population mobility data, with
                                            appropriate legal, organizational, and computational safeguards in place. After aggregation, these data can help
                                            refine inter ventions by providing near real-time information about changes in patterns of human movement. An
                                            example of these mobility datasets is provided by Facebook and this is the dataset we employed in this study 36.
Scientific Reports |         (2023) 13:5235  |                                                                                                                                                                                                                                                                                          https://doi.org/10.1038/s41598-023-31222-62

                                                                                                      Figure 1.                                          IRIS-level positive cases in Paris (27-01-2021 to 02-02-2021), visualized via the Géodes                                           tool33.
                                                                                                         Dataset
                                                                                                         Time Span                                                                                                                                                                                                                                     27/12/2020–27/6/2021
                                                                                                         Level                                                                                                                                                                                                                                                                                                         Department                                                                                                                                                                        Iris
                                                                                                         Regions                                                                                                                                                                                                                                                                        94                                                                                                                                                                                                                                                                                                  30,378
                                                                                                         Avg positive cases                                                                                                                                             180.65                                                                                                                                                                                                                                              –
                                                                                                         Avg hospitalized patients                                                      12.81                                                                                                                                                                                                                                                             –
                                                                                                      Table1.                                                                 Statistics of the dataset used in this study.
                                                                                                      Figure 2.                                          Mean, standard deviation and maximum difference of positive (left) and hospitalized cases (right) per
                                                                                                      d   a  y.
                                                                                                      Besides mobile phone applications, other major sources of mobility data include public transit systems and
                                                                                                      mobile operators 37.
                                                                                                      Vaccination  dataset.                                                                                                                                                                              Another significant factor that could help to study the spread of COVID-19, would
                                                                                                      be to look at vaccination percentages of each department. Vaccination can be crucial to block transmission
                                                                                                      and prevent severe hospitalization. As our study is focused in the first 6 months of 2021, we only incorporate
                                                                                                      information about 1-dose vaccinations. Vaccination information was integrated as additional node features. The
                                                                                                      dataset is publicly available 38.
                                                                                                      Results
                                                                                                      As already discussed, in this paper, we study the evolution of COVID-19 in France, and we thus train the pro     -
                                                                                                      posed model on data collected from this countr y. Specifically, among the different administrative divisions of
                                                                                                      France (i. e., administrative regions, departments, communes), we focus on departments since this is the finest
Scientific Reports |         (2023) 13:5235  |                                                                                                                                                                                                                                                                                          https://doi.org/10.1038/s41598-023-31222-6                                                                                   3

                                                                                                            (in terms of granularity) administrative division for which both the daily number of new cases and mobility data
                                                                                                            are available. In fact, departments lie in between administrative regions and communes; in our case we extract
                                                                                                            data for 93 departments in metropolitan France in total.
                                                                                                                       We represent the whole country as a graph G      =                                (V                                     ,    E ) where                                                                                  n    =|               V   | denotes the number of nodes and
                                                                                                           m    =|              E | denotes t he numb er of edges, as shown in Fig.|                                                                                                                                                                                                                                                                                                           3                                           . No des repres ent depar tments, w hile edges mo del
                                                                                                            mobi   lit  y p   atter    ns. =e weig     ht of an e   dge denotes t    he tot    a   l numb       er of p      e   ople t    hat move   d f       rom one dep   ar       t   ment
                                                                                                            to another department. Note that graph G                                                                                                                                                                                                                                                                                                                         can also contain self-loops which correspond to the mobility behav   -
                                                                                                            ior within the departments. Furthermore, the nodes of graph     G are annotated with attributes. Therefore, each
                                                                                                            vertex v in the graph is associated with a feature vector h(0)                                                                                                                                                    Rd where d          is the feature dimensionality. We use
                                                                                                                                                                                                                                                                                                            v                          ∈
                                                                                                            the following features for a node v (representing some department): (1) population of department; (2) number
                                                                                                            of cases for each one of the previous 7 days; (3) vaccination rate; and (4) volume of COVID-19 hospitalizations
                                                                                                            for each one of the previous 7 days (only for models trained to predict number of hospitalizations). Since the
                                                                                                            quantity of interest is the daily number of new cases, we do not create just a single graph, but a series of graphs,
                                                                                                            each corresponding to a specific day t                            , i. e., G (1)                                   ,    ...,                                         G (T                  ).
                                                                                                                       B efore presenting the results about the predictive ability of the proposed approach, we provide some intuition
                                                                                                            for w  hy GNNs cou ld b   e of interest to t  he study of dis  e  as  e spre  ad across a count r          y. For a g iven day, we assume
                                                                                                            t     hat t     he tot     a    l numb        er of p        osit    ive c  as       es in a reg    ion is a f     unc      t    ion of t     he numb        er of c  as       es rep        or         te    d for t     hat reg    ion
                                                                                                            in t  he pre  v ious d ays, t  he reg ion’s p   opu l at ion, t  he numb   er of vaccinate d indiv idu a ls residing in t  he reg ion and
                                                                                                            t   he p     opu   l at   ion mobi   lit y b     ot   h w it   hin t   he reg   ion and across reg   ions. If t   he no     des (i.)     e., reg   ions) of t   he g   raph are
                                                                                                            annotated with the .rst three features described above, then GNN models that employ message passing schemes
                                                                                                            can approximate the above function. Indeed, given a node and its neighbors, these models can learn to combine
                                                                                                            features received by the neighbors which contain information about the spreading status of those regions along
                                                                                                            with the spreading status of the region itself.
                                                                                                                       In our experiments, we investigate how accurate the proposed model is in predicting the number of new cases
                                                                                                            p  er dep ar   t ment as wel l as t he numb  er of hospit a lize d p at ients wit h C  OVID-19. O ur exp  er iment a l proto  col is
                                                                                                            simi l ar to t  hat of pr  ior work)                                                                                                                                                                                                                                                                                                                                                                           27                                                                                                                                                                    . Sp   e ci.c a l ly, we t rain t  he mo   dels using d at  a f   rom d ay 1 to d ay T                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               , and then use
                                                                                                            the model to predict the number of cases (or hospitalized patients) for each one of the next                                                                                                                                                                                                                                   τ days. τus, we
                                                                                                            make predictions for all days between                                                                                           T       +                      1 and T       +                         τ   . Following prior work                                                                                                                                                                                                           27              , we evaluate the e ectiveness of
                                                                                                            the model in short-, mid- and long-term predictions. τerefore, we consider three di erent time resolutions by
                                                                                                            setting                 τ to 3,         7 and 14, resp     e  c   t  ively. We exp     e  c   t t   he mo     del to ma  ke more acc   urate shor     t-ter   m pre  dic   t  ions t   han
                                                                                                            long-ter m pre dic t ions. It shou ld b  e ment ione d t hat we do not t rain a sing le mo  del t hat pre dic ts t he numb  er
                                                                                                            of c     as                es (or hospit            a          lizat          ions) for a          l          l d     ays f                     rom         T       +                      1 to             T       +                         τ                                                                                               . On t            he ot            her hand, we t          rain a di erent mo                   del to
                                                                                                            ma ke pre dic  t ions for d ays                                                           T       +                         i an d    T       +                         j w  here 0        <                  i ,           j       ≤                   τ an d    i       =                    j           . ius, t  here are τ di erent models, and
                                                                                                            e ach mo  del fo  c  us  es on a sing  le day b  etwe en                                                                                                T       +                      1 an d   T       +                         τ       . Note a ls  o t hat we do not consider a sing  le t ask,
                                                                                                            but multiple tasks instead. Formally, let K                                                                                                                                                                                                                                                                                                                                                              be the total number of days for which data is available (in our case, K
                                                                                                            is equal to 182 days (from 27/12/2020 to 27/06/2021)). Let also T                                                                                                                                                              the denote the minimum size of the training
                                                                                                            set. Ten, we de ne                                                  K       −                         τ       −                   T           +                      1 tasks in total. For the  rst task, the training set consists of all days between
                                                                                                            1 and                T       (i. e.,            T        =                     T  ). Likewise, for the second task, the training set consists of all days between 1 and                                                                                                                                                                                           T           +                      1
                                                                                                            (i. e.,          T        =                     T           +                      1   ). For the last task, the training set consists of days from 1 to                                                                                                             T        =                   K       −                         τ.
                                                                                                                       For a given task, to evaluate the performance of a model, we compute the mean absolute error which compares
                                                                                                            the predicted total number of cases (or hospitalized individuals) in each department against the corresponding
                                                                                                            ground truth, throughout the test set:
                                                                                                            Figure 3.                                          A map of the departments of metropolitan France (left). A graph where nodes represent departments
                                                                                                            of metropolitan France and edges capture mobility patterns (right). Two nodes (i. e., departments) are
                                                                                                            connected by an edge if people have moved from the one department to the another. Such graphs constructed
                                                                                                            from mobility data are given as input to the GNN model.
Scientific Reports |         (2023) 13:5235  |                                                                                                                                                                                                                                                                                          https://doi.org/10.1038/s41598-023-31222-6                                                                                                             4

                                                                                                                                                                                                                                                                                                                                                                    T +∑τ                 ∑
                                                                                                                                                                                                                                                                                                           error                    =                                                1                      |ˆy (t               )              t               )|                                                                                                                                                 (1)
                                                                                                                                                                                                                                                                                                                                                 nτ                                                                v                        −                         y (v
                                                                                                                                                                                                                                                                                                                                                                t =T                   +1 v∈        V
                                                                                                                                       where y (vt                ) denotes t  he numb   er of c as   es (or hospit  a lize d indiv idu a ls) in t  he dep ar   t ment repres   ente d by no   de v
                                                                                                                                       on day t         , and y (ˆ                                     t                ) denotes the predicted number of cases (or hospitalized individuals) for the same department
                                                                                                                                                                                                       v
                                                                                                                                       and day. yen, we compute the average of the errors of all tasks.
                                                                                                                                                      Tablet                                                   2             illustrates the average errors in terms of the number of positive cases of the di erent approaches (along
                                                                                                                                       wit h st andard de  viat ions across t he di erent t asks). We us  e (vac) to denote mo  dels t hat t a ke g raphs as input
                                                                                                                                       w                   hos                      e no                         des are annot                ate             d w       it                h vaccinat             ion rates. We a             ls                      o us                      e Mu             lt             i-s                      c       a             le to denote mo                         dels t                hat t                a             ke as input
                                                                                                                                       both department level and IRIS level graphs, i.te., models that combine coarse- and vne-level representations. We
                                                                                                                                       can see that our Multi-scale approach is the best performing method on all three considered time resolutions (i.te.,
                                                                                                                                       3−                , 7−         and               14−               days prediction). For short-term and mid-term predictions, instances of the proposed approach
                                                                                                                                       achie  ve a lmost simi l ar le  vels of p  er  for  mance as t  hos  e of PROPHET. For long-ter  m pre dic  t ions, t  he di erence
                                                                                                                                       b               et    we        en t         he p               er         for         mance of PROPHET and t         he ot         her met          ho               ds is quite w    ide. −e t    wo simple b        as             elines t          hat do
                                                                                                                                       not involve le ar ning (AVG and AVG WIND     OW) outp  er for m common le ar ning mo  dels such as ARIMA and
                                                                                                                                       LSTM on all three time resolutions. For a speci c department and a test day, the AVG baseline predicts a value
                                                                                                                                       equal to the average number of cases up to the time of the test day, while the AVG WINDOW baseline predicts
                                                                                                                                       a va   lue e   qu a   l to t    he average numb      er of c as     es in t    he p   ast d                                                                                                                                                                                      days (d was set equal to 7 in our experiments). They
                                                                                                                                       also outperform MPNN+LSTM in some cases. On the other hand, MPNN and its multi-scale variant yield lower
                                                                                                                                       average errors than the baselines in all cases. We also obser ve that adding the vaccination rate as a feature leads
                                                                                                                                       to slightly smaller average errors in most cases, while it seems to be more effective for mid-term predictions. The
                                                                                                                                       multi-scale variant of the proposed model also leads to performance improvements in all cases. For instance,
                                                                                                                                       in the case of the 3 and 7 days ahead forecasts, this model offers MPNN absolute improvements of 13.78% an   d
                                                                                                                                      12.63% in test er ror, resp  e c  t ively. O     vera l l, our exp  er iments demonst rate t hat t he prop  os  e d appro ach can s  er         ve
                                                                                                                                       as a us  ef u l st ate-of-t he-ar   t to  ol for pre dic  t ing t he numb  er of f uture C  OVID-19 cas  es, and t hus for comb at ing
                                                                                                                                       the spread of the disease. 1e results that are given in Table2                                                                                                                                                                                                                                                                                                                                                                                                                               2 measure the average error over the whole predic                                                                                                                                                                                                                                                                                                                                                                               -
                                                                                                                                       t ion hor izon and a l l t he 93 considere d dep ar  t ments in met rop olit an France. Even t houg h t he average er ror
                                                                                                                                       summar izes t he pre dic t ive p  er for mance of t he di6erent met ho  ds, to provide more cle ar insig hts ab  out t heir
                                                                                                                                       performance, we chose two out of the 93 departments (Bouches-du-Rhône and Seine-et-Marne) and we visual-
                                                                                                                                       ized the predicted number of cases (one day ahead prediction) for the di6erent approaches. 1e results are given
                                                                                                                                       in Fig  .2                                4                                                                                                                                                                                                                                                  . We obs       er                            ve t     hat AVG and ARIMA fai    l to achie       ve hig      h le       vels of p        er     for     mance, w      hi    le Prophet, MPNN,
                                                                                                                                       MPNN-LSTM and Multi-scale MPNN all predict the number of COVID-19 cases with high accuracy. It is hard
                                                                                                                                       to determine which model performs the best since the above 4 models provide similar predicted number of cases.
                                                                                                                                                      Table2                           3 illustrates the average errors in terms of the number of hospitalized patients of the di6erent approaches
                                                                                                                                       (along with standard deviations across the di6erent tasks). We obser ve that the proposed models outperform the
                                                                                                                                       baselines on all three considered time resolutions (i.2e.,                                                                                                                                                                                  3−               , 7−          and                14−              days prediction). −is demonstrates the
                                                                                                                                       us                                 ef                        u                    lness of t                        he considere                    d fe                         atures w                             hich t                         he prop                                      os                                  e                    d mo                                      dels are bui                    ld on (e. g          ., mobi                    lit          y d          at                         a, vaccinat                    ion
                                                                                                                                       rates, etc.). Sur            pr       ising        ly, we c   an s         e     e t       hat ver                                    y simple b     as         eline such as AVG and AVG WIND                      OW are ver                                    y com                                                                                                                                                                                                                                                -
                                                                                                                                       petitive with sophisticated machine learning models. For instance, those two baselines outperform ARIMA and
                                                                                                                                       LSTM on all three considered time resolutions, while they also outperform some variants of the proposed model
                                                                                                                                       (esp  e cia l ly in t he cas  e of long-ter m pre dic  t ions). −is hig  h lig  hts t he complexity of t he considere d pre dic  t ive
                                                                                                                                       task. Among the di erent baselines, standard MPNN and its variations are the best-performing ones, however,
                                                                                                                                       they are outperformed by at least one instance of the proposed model on all cases. Interestingly, we observe that
                                                                                                                                           Model                                                                                                                                                                                                                                                                                                                                                                                 3 days prediction                                          7 days prediction                                          14 days prediction
                                                                                                                                           Baselines
                                                                                                                                              AV G                                                                                                                                                                                                                                                                                                                                                                               117.33 ± 0.56                                                                                                 118.44 ± 1.21                                                                                                 121.27 ± 3.14
                                                                                                                                            AVG WINDOW                                                                                                                                                                                                                             88.43 ± 0.68                                                                                                               73.18 ± 3.26                                                                                                               87.02 ± 9.27
                                                                                                                                            ARIMA                                                                                                                                                                                                                                                                                                                                        118.98 ± 0.77                                                                                                 120.02 ± 2.42                                                                                                 121.65 ± 4.77
                                                                                                                                            PROPHET                                                                                                                                                                                                                                                                                                    68.37 ± 1.47                                                                                                               72.82 ± 3.78                                                                                                               93.06 ± 16.0
                                                                                                                                            LSTM                                                                                                                                                                                                                                                                                                                                                               146.00 ± 0.39                                                                                                 147.32 ± 1.21                                                                                                 153.06 ± 1.85
                                                                                                                                            MPNN                                                                                                                                                                                                                                                                                                                                                  71.57 ± 16.6                                                                                                               69.90 ± 9.73                                                                                                               76.25 ± 13.2
                                                                                                                                            MPNN+LSTM                                                                                                                                                                                                                                                   85.23 ± 28.8                                                                                                               91.05 ± 19.2                                                                                                               84.83 ± 16.1
                                                                                                                                           Proposed
                                                                                                                                            MPNN (vac)                                                                                                                                                                                                                                                                            66.72 ± 15.6                                                                                                               66.04 ± 11.0                                                                                                               121.12 ± 22.1
                                                                                                                                            MPNN+LSTM (vac)                                                                                                                                                                             83.22 ± 28.3                                                                                                               91.54 ± 20.1                                                                                                               112.49 ± 21.0
                                                                                                                                            Multi-scale MPNN (IRIS)                                                                                                                  57.79 ± 11.6                                                                                                                                                                                                                                                                 57.27 ± 8.96                                                                                                                                                                                                                                                 73.05 ± 14.4
                                                                                                                                            Multi-scale MPNN (IRIS, vac)                                                      61.54 ± 13.8                                                                                                               63.85 ± 10.7                                                                                                               83.34 ± 15.2
                                                                                                                                       Table2.                                                                 Average error for τ      ={1,...                                                            3}      , {1,             ...           7} and {1,                                ...           14} (± standard deviation over days of
                                                                                                                                       prediction), in number of positive cases per department. Bold indicates best mode. (vac) stands for using
                                                                                                                                       vaccination data.
Scientific Reports |         (2023) 13:5235  |                                                                                                                                                                                                                                                                                          https://doi.org/10.1038/s41598-023-31222-6                                                                                                                                                                                                                                        5

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Figure 4.                                          Number of COVID-19 cases per day for two departments of metropolitan France and predicted
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           number of cases by the different approaches.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Model                                                                                                                                                                                                                                                                                                                                                                                                                                                 3 days prediction                                          7 days prediction                                          14 days prediction
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Baselines
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               AV G                                                                                                                                                                                                                                                                                                                                                                                                                                             8.23 ± 0.03                                                                                                                              8.33 ± 0.10                                                                                                                              8.50 ± 0.19
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             AVG WINDOW                                                                                                                                                                                                                                                                                           6.13 ± 0.15                                                                                                                              5.38 ± 0.16                                                                                                                              6.07 ± 0.49
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ARIMA                                                                                                                                                                                                                                                                                                                                                                                                      8.51 ± 0.18                                                                                                                              8.92 ± 0.29                                                                                                                              9.74 ± 0.66
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             PROPHET                                                                                                                                                                                                                                                                                                                                                                 6.09 ± 0.06                                                                                                                              6.34 ± 0.17                                                                                                                              7.00 ± 0.57
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             LSTM                                                                                                                                                                                                                                                                                                                                                                                                                            7.41 ± 0.01                                                                                                                              7.82 ± 0.04                                                                                                                              6.98 ± 0.12
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             MPNN                                                                                                                                                                                                                                                                                                                                                                                                               6.66 ± 0.26                                                                                                                              6.10 ± 0.55                                                                                                                              5.71 ± 0.46
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            MPNN+LSTM                                                                                                                                                                                                                                                                                                                5.63 ± 0.58                                                                                                                              6.20 ± 0.59                                                                                                                              5.77 ± 0.31
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Proposed
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            MPNN (vac)                                                                                                                                                                                                                                                                                                                                          6.39 ± 1.13                                                                                                                              5.54 ± 0.33                                                                                                                              7.23 ± 0.76
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            MPNN+LSTM (vac)                                                                                                                                                                                                                                           5.92 ± 0.82                                                                                                                              5.65 ± 0.34                                                                                                                              6.66 ± 0.56
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            MPNN (pos+vac)                                                                                                                                                                                                                                                                            7.07 ± 1.67                                                                                                                              5.45 ± 0.38                                                                                                                              6.16 ± 0.58
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            MPNN+LSTM (pos+vac)                                                                                                                                                                             7.06 ± 1.56                                                                                                                              6.27 ± 0.81                                                                                                                              6.50 ± 0.66
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Multi-scale MPNN (IRIS)                                                                                                                                                                          5.53 ± 0.54                                                                                                                              5.20 ± 0.22                                                                                                                              6.60 ± 0.62
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Multi-scale MPNN (IRIS, pos+vac)                                                         5.36 ± 0.51                                                                                                                                                                                                                                                 5.18 ± 0.33                                                                                                                                                                                                                                                 5.66 ± 0.50
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Table3.                                                                 Average error for τ      ={1,...                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             3}                                    , {1,                                                                          ...                                                            7} and {1,                                                                                                                                                                                ...                                                            14} (± standard deviation over days of
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           prediction), in number of hospitalized patients per department. Bold indicates best model. (vac) stands for
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           using vaccination data and (pos) for using positive COVID cases.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           providing the models with the number of fully vaccinated individuals results into slightly less accurate short-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           term and long-term predictions, but into more accurate mid-term predictions. More specifically, in the case of
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           the 7 days ahead forecasts, the aforementioned feature offers MPNN and MPNN+LSTM absolute improvements
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           of 0.56% an  d                                                                                                                                                                                                                                                0.55% in test er   ror, resp     e  c    t  ively. A f   ur      t   her improvement is achie    ve  d w    hen t   he numb     er of c as    es of
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           the previous days is also given as input to the MPNN model for mid-term forecasts. 0e multi-scale variant that
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           takes as input both department level and IRIS level graphs outperforms all the other approaches for short- and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           mid-term forecasts. When the model also utilizes the two aforementioned features, it quite surprisingly achieves
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           lower er         rors for a        l        l shor                 t-, mid- and long-ter          m fore        c    asts. B                                  esides t          he resu        lts of Table.3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       , we a        ls             o chos             e again t          he
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           s       ame t   wo dep     ar            t     ments (B                        ouches-du-R              hône and S                 eine-et-Mar       ne) and v   isu   a     lize     d t       he pre     dic        te     d numb          er of hos                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           pit a lize d p at ients (one d ay a he ad pre dic  t ion) by t he di%erent appro aches. 0e resu lts are i l lust rate d in Fig ..                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                5.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Once again, we can see that AVG and ARIMA are the worst-performing methods. On the other hand, Prophet,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           MPNN, MPNN-LSTM and Mu lt i-s ca le MPNN yield go  o  d pre dic t ive p  er for mance since t he y a l l pre dic t t he
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           number of patients in hospital quite accurately. By manually inspecting Fig..                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              5, it is hard to determine which one
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           of t   he ab     ove 4 mo     dels outp     er   for   m t   he ot   hers in t   his t   ask. 0is hig    h   lig    hts t   he ne   e   d for qu ant   it   at   ive resu   lts such
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           as those presented in Table.                                                                                                                                                                                                   3        .
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Figure.                                             6                                                provides a qualit ative e valuation of t he prop os ed mo del. For e ach depar tment, it illustrates t he
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           average number of cases per day (right) and also the relative error of the predicted number of cases. 0e relative
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           error is de5ned as follows:
Scientific Reports |         (2023) 13:5235  |                                                                                                                                                                                                                                                                                          https://doi.org/10.1038/s41598-023-31222-6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  6

                                                                                                  Figure 5.                                          Number of patients in hospital due to COVID-19 per day for two departments of metropolitan
                                                                                                  France and predicted number of of patients in hospital by the different approaches.
                                                                                                  Figure 6.                                          Maps of the departments of metropolitan France where the intensity of the color of each department
                                                                                                  is determined based on the relative test error on positive cases incurred by Multi-Scale MPNN (left) or the
                                                                                                  ground truth number of positive cases (right). The more blue a department, the larger the relative test error
                                                                                                  (as defined in Eq. (2                            )) on positive cases incurred by Multi-Scale MPNN (left). The more red a department, the
                                                                                                  higher the ground truth number of positive cases (right).
                                                                                                                                                                                                                                                                            T +τ                                 tt                  tt
                                                                                                                                                                                                          relative          error                    =                                                       1∑∑|ˆy (v                        −                         y (v|
                                                                                                                                                                                                                                                              nτ                                                      −        (t               )                                                                                            (2)
                                                                                                                                                                                                                                                                         t =T                   +1v∈        V            v
                                                                                                  where y (vt                ) denotes t  he numb   er of c as   es (or hospit  a lize d indiv idu a ls) in t  he dep ar   t ment repres   ente d by no   de v
                                                                                                  on day t         , and y (ˆ                   t                ) denotes the predicted number of cases (or hospitalized individuals) for the same department
                                                                                                                                               v
                                                                                                  and day. We obs  er         ve t hat for dep ar   t ments wit h large numb  ers of cas  es (e.t       g., Île-de-France), t he relat ive er ror
                                                                                                  is relatively small. On the other hand, high values of relative error occur mainly in departments whose average
                                                                                                  numb  er of cas es is low. yis demonst rates t hat t he prop  os e d mo  del can ma ke more acc urate pre dic t ions for
                                                                                                  dep ar   t ments he avi ly hit by t he p andemic. yis is p ar   t ic  u larly imp  or   t ant since p  olic     yma kers and public he a lt h
                                                                                                  o cials usually put more focus on such regions, i.te., the ones hardest hit by the pandemic. On the other hand,
                                                                                                  regions w here t he outbre ak is not t hat intens e receive much less attention. For such regions, a large relative
                                                                                                  error might not be a serious problem. To make this clear, consider a department where in a given day, the actual
                                                                                                  numb  er of cas es is 10 and supp  os e t hat t he pre dic te d numb  er of cas es is 5. Even t houg h t he relat ive er ror is
                                                                                                  hig                             h, t                        his has since t                        he numb                                     er of c          as                                 es is rel          at                    ively sma                    l                    l. In t                         he c           as                                  e of reg                    ions w          it                         h l           arge numb                                     ers of c           as                                 es, a
                                                                                                  large relative error could be catastrophic since it would greatly enhance the risk of wrong decisions. As already
                                                                                                  dis  c uss  e d, for such dep ar  t ments, t he relat ive er ror of t he prop  os  e d appro ach is sma l l. Hence, t he pre dic t ions
                                                                                                  made by t          he mo               del cou        ld enable gover         nments and p               olic                           y    ma        kers to ma        ke more infor         me        d de        cisions in order to
                                                                                                  halt the spread of the disease.
                                                                                                            Figuret                                                             7                                                                                                i l lust rates t he average er ror of t he prop  os  e d mo  dels and s  ome of t he b as  elines for e ach one of t he
                                                                                                  next 14 days regarding hospitalization (long-term prediction task). It is clear that most instances of the proposed
Scientific Reports |         (2023) 13:5235  |                                                                                                                                                                                                                                                                                          https://doi.org/10.1038/s41598-023-31222-6                                                                7

                                           Figure 7.                                          Average error (as defined in Eq. (1                          )) of the different methods for the number of hospitalized patients
                                           per day in the task of 14 days ahead forecast.
                                           model achieve low levels of error in the first days, while the error gradually increases as we proceed further in
                                           the future. For instance, the multi-scale variant of the proposed model yields average errors of 4.6, 5.1 and 5.3 in
                                           the first three days, and errors of 6.2, 6.2 and 6.2 in the last three days (i. e., days 12 to 14). This is not surprising
                                           since the uncertainty of the model increases as time goes by because of the lack of obser ved data for the previous
                                           days. On the other hand, LSTM model variants achieve high errors for the whole forecasting period. Only the
                                           standard MPNN-LSTM approach manages to outperform our proposed model in long-term predictions, as
                                           opposed to it’s lower performance in short-term.
                                           Discussion
                                           Understanding and controlling the mechanisms that govern spreading processes in complex networks is a fun   -
                                           damental task in many fields including disease spreading among others. The stor y of COVID-19 has highlighted
                                           the limitations of mathematical models. These models might fail to capture the full complexity of the contagion
                                           dynamics underlying infectious diseases. During such emergency situations, it is necessar y to leverage all avail-
                                           able tools that can provide a better understanding of the situation. Machine learning has recently emerged as
                                           a promising tool and has shown great potential in modeling such processes. Importantly, machine learning
                                           approaches can learn useful patterns directly from empirical data. Thus, they do not assume the contagion
                                           dynamics to be known in advance. Due to their flexibility, these methods have been recently employed to model
                                           the spread of the COVID-19 epidemic in different countries. Accurate machine learning models could help
                                           public health officials and policymakers to plan allocation of health care resources and to control the spread of
                                           the virus more effectively. In this work, we presented an instance of such a machine learning model that lever  -
                                           ages population mobility data and other features to improve its predictive power. Message passing instances of
                                           GNNs can naturally model the interactions between regions, and can then combine this information with the
                                           one extracted from the input features. Then, the generated representations can be used for predicting the num-
                                           ber of new cases as well as hospitalization rates. Even though the proposed models outperformed the baselines
                                           in our experiments, we obser ved that ver y simple baseline methods such as a method that predicts the average
                                           number of cases that occurred in the past d          days achieve almost similar levels of performance with the proposed
                                           approach. This demonstrates that modeling contagion dynamics and especially predicting target variables related
                                           to them is a complex task even for ver y sophisticated learning algorithms. On the positive side, we obser ved
                                           that the proposed models yielded fairly accurate predictions for departments that have been severely hit by
                                           COVID-19. This is of critical importance for governments and other actors since they can capitalize on those
                                           predictions in order to adapt their policies and protocols, and plan ahead for the necessar y preventive steps.
                                           We should note that other studies that also employ message passing models and leverage mobility data have
                                           reached similar conclusions, i. e., that for deep learning models, introducing additional mobility data improves
                                           results   26,                         29,                         31. Furthermore, with regards to the different models that are evaluated in this study, our results
                                           indicate that multi-scale models (i. e., Multi-scale MPNN) outperform the rest of the methods both in the task
                                           of predicting the number of cases and in the task of predicting the number of hospitalized patients. In the latter
                                           task, our results also suggest that vaccination data (given to the model as features) leads to further performance
                                           improvements. This has been confirmed by a ver y recent study which also showed that capturing the multi-scale
                                           and multi-resolution structures of graphs of regions is important to extract information that play a critical role
                                           in understanding the dynamics of COVID-19  30.
                                               Perhaps even more importantly than their predictive power, these models can provide explanations and iden-
                                           tify which features have a strong relationship with the output variable. This can provide government officials and
Scientific Reports |         (2023) 13:5235  |                                                                                                                                                                                                                                                                                          https://doi.org/10.1038/s41598-023-31222-68

                                                              policymakers insights about the disease, e. g., the underlying factors contributing to the rapid spread of COVID-
                                                              19. For instance, our analysis showed that population mobility has some impact on the spread of COVID-19.
                                                              This is consistent with the findings of previous studies which showed that the probability that people living in a
                                                              region are infected by the virus increases given more people moving in and out from that region     35,            39–                    41. Other
                                                              features led to similar conclusions. For instance, adding vaccination rates to the list of considered features gen   -
                                                              erally improved the performance of the proposed models. This, for example, indicates that vaccination rate is
                                                              indeed related to the spread of COVID-19. Furthermore, we found that more fine-grained approaches could also
                                                              be more effective. This generally verifies our intuition that a person-to-person level analysis could lead to more
                                                              accurate models and to better empirical results. However, since such information is not available, we instead
                                                              consider the interactions between populations of individuals at different levels.
                                                                    In terms of future directions of research, we need to mention that the proposed model can be easily extended
                                                              to accommodate additional information. For instance, information about lockdown measures and weather condi-
                                                              tions could be incorporated as node attributes. The spread of COVID-19 is known to critically depend on such
                                                              features. Hence, we expect such features to improve the predictive performance of the proposed model. It would
                                                              be also interesting to investigate whether those features are good indicators of the target variables (i. e., number
                                                              of cases and hospitalization rates).
                                                              Methods
                                                              Models.                                                                                                         Graph neural networks (GNNs) have recently become the standard approach for dealing with
                                                              machine learning problems on graphs. These architectures can naturally model various systems of relations
                                                              and interactions, including social networks   42 and particle physics   43. Importantly, GNNs have been employed
                                                              in different application ranging from estimating the time of arrival in Google Maps    44 to discovering latent
                                                              node information 45. The increasing activity in the field of GNNs has resulted into dozens of architectures being
                                                              proposed in the past few years. Most of these architectures belong to the family of message passing neural net-
                                                              works  46. These models employ a message passing (or neighborhood aggregation) procedure to aggregate local
                                                              information of vertices. Specifically, to update its representation, each node combines the representations of its
                                                              neighbors with its own representation. Suppose we have a GNN model that contains K neighborhood                          aggrega-
                                                              tion layers. At each iteration (                         k      >          0  ), the hidden state        h(k              ) of a node v is updated as follows:
                                                                                                                                                                          v
                                                                                                                              (k              )                       k              )({h(k        −1)                 )
                                                                                                                           av                            =                      AGGREGATE(u                                                     :         u        ∈            N       (v                   )}
                                                                                                                              (k              )                k              )(k        −1)k              ))
                                                                                                                           hv                           =                      COMBINE(h(v                                                ,           a (v
                                                              where N       (v                   ) denotes the set of neighbors of node v                                                                                                                                                                                                                                                                                                                                                                                                                              , and AGGREGATE is a permutation invariant function that
                                                              maps t     he fe    ature ve    c     tors of t     he neig     hb       ors of a no       de v                                                                                                                                                                                                                                                                                     to an aggregated vector. This aggregated vector is passed
                                                              along with the previous representation of v           (i. e., h(t       −1)                                   ) to the     COMBINE function which combines those two
                                                                                                                                                                 v
                                                              vectors and produces the new representation of v                                                                                                                                                                                                                                                                                               . Different AGGREGATE and COMBINE functions give rise to
                                                              a diBerent GNN. ANer K                                                                                           neighborhood aggregation steps, the representation h(K                 ) of node                                                                          v takes into account
                                                                                                                                                                                                                         v
                                                              the entire k         -hop neighborhood of v         .
                                                                    In this work, we use an instance of the above framework to compute the new representations of the regions. As
                                                              already discussed, we construct two graph representations of regions at different granularities, namely IRIS areas
                                                              and departments. The edge weights of the two graphs capture the mobility patterns, i. e., how many people moved
                                                              from one region to another. Thus, each day t is associated with a pair of graphs                                                                       G (t                ) and G (t                )   . For a sequence of
                                                                                                                                                                         1)                   T                  )1)     DEP          T                  )IRIS
                                                              days     1,    ...,                                            T                 , we have t wo s    e  quences of g  raphs, i.         e., G (DEP,    ...           ,G (DEP and G (IRIS,    ...,G (IRIS. The representations
                                                              of the nodes of all those graphs are updated using a GNN. More specifically, we use the following neighborhood
                                                              aggregation scheme to update the representations of the nodes:
                                                                                                                                               (                           ∑      1                                )
                                                                                                                              h(k              )                                                          k         −1)
                                                                                                                                 v                             =                                f|N       (v                   )|+                                        1   Wk     h(u
                                                                                                                                                   u∈  N(v               )∪{                          v}
                                                              where Wk        ∈             Rdk ×d                     k−1 is a matrix of trainable parameters and f                                   is a non-linear activation function such as ReLU.
                                                              Note that in this setting,                         N       (v                   ) denotes the incoming neighbors of node v                                                                                                                                                                                                                                                                                                                                                                                                . Furthermore, following previous
                                                              works   47, we compute a weighted sum of the messages received by the neighbors. Specifically, the sum of all
                                                              weights is equal to 1 and is equally distributed among the neighbors of the node and itself. It should also
                                                              be mentioned that the above update scheme integrates the                                                              AGGREGATE an d                         COMBINE steps into a sing le
                                                              function. Finally, note that for simplicity of notation, we have omitted the time index. Ce above model is in fact
                                                              applied to all the input graphs                           G (1)      ,    ...           ,G (T                  ) separately. A different model is applied to all the IRIS level graphs
                                                                 1)                   (T                  )                DEP                  DEP
                                                              G (IRIS,    ...,                                         GIRIS. In both cases, the weight matrices are shared across all graphs. Thus, we have two sets of weight
                                                              matrices, i. e., W1                     ,    ...,                           WK for the department level and W1                     ,    ...,                           WK for the IRIS level.
                                                                                               DEP                   DEP                                                                  IRIS                  IRIS
                                                                    As discussed above, as the number of neighborhood aggregation layers increases, the final node
                                                              representations capture more global information. However, in some applications, local information might be
                                                              equally useful or even more useful. Thus, to also explicitly retain this information, we concatenate the node
                                                              representations that emerge at the different neighborhood aggregation layers                                                                                             h(0)     ,        h(K                  ) to obtain
                                                                                             (                             )                                                                                                             v                                 ,    ...v
                                                              hv        =                    CONCATh(v                   ,    ...0),                                                h(vK                  ), and the new representations can be regarded as vectors that encode multi-scale
                                                              structural information, including the initial features of the node.
Scientific Reports |         (2023) 13:5235  |                                                                                                                                                                                                                                                                                          https://doi.org/10.1038/s41598-023-31222-69

                                                                               Our objective is to generate a vector representation for each department and then feed this vector to a fully-
                                                                        connected network to compute the output. The GNN that is applied to the graphs whose nodes represent the
                                                                        different departments directly produce such representations hDEPv                                                                                 (for the di erent days from 1 to T                                                                                                                                                                                                                                                                                                                                    ). The second
                                                                        GNN that is employed generates vector representations for the IRIS areas. Since a department consists of a set
                                                                        of IRIS areas, we generate a second representation for each department by aggregating the representations of
                                                                        the IRIS areas of which it is composed. Formally, let v            be a node that represents a specific department in graphs
                                                                       G (1)       ,    ...           ,G (T                  ), and let S   (v                   ) denote a set that contains all the IRIS areas associated with that department. (en,
                                                                           DEP                     DEP
                                                                        a second representation of node v                                                                                                                                                                                                                                                                                                                                         is produced as follows:
                                                                                                                                                                            IRIS                  1            ∑
                                                                                                                                                                         hv                                           =RS   (v                   )|hu
                                                                                                                                                                                                            u∈   S(v               )
                                                                               We thus compute the mean of the vector representations of the IRIS areas. We also experimented with a max (                                                                                                                         )
                                                                        aggregator. Then, the final representation of the department is computed as hv        =                    CONCAT                                                                                                 hDEPv                                   ,     hIRISv.                                This
                                                                        representation is then passed onto one or more fully-connected layers to produce the output. For instance, if a
                                                                        single fully-connected layer is employed, the output is computed as follows:
                                                                                                                                                                         yˆ    =                       ReLU(Wv      +                 b
                                                                                                                                                                           v                               o    v           o  )
                                                                        where Wo        ∈            R1×d        and bo         ∈              R is a matrix of trainable parameters and the bias, respectively, while                                                                        yvˆ  is the number
                                                                        of pre dic  te d cas  es for t he dep ar   t ment repres  ente d by no  de v                                                                                                                                                                                                                                                                                                                                                                                                                                                                          in the graph. We apply the ReLU function to the
                                                                        output of the architecture since the number of new cases cannot take negative values. To train the model, we use
                                                                        the mean squared error as our loss function:
                                                                                                                                                                                      ∑T       ∑        (                         )2
                                                                                                                                                                 L     =                                              1  (t                )t                )                                                             (3)
                                                                                                                                                                              nT                              v            −ˆ  y (v
                                                                                                                                                                                       t =1    v∈        V
                                                                        where          y (vt                ) denotes t  he rep   or   te d numb   er of c as   es for reg ion                                                                                                                                                                                                                                                                                                                                                                                                                                                                           v at day t,  T denotes the considered days, and n                                is
                                                                        equal to the number of departments (i. e., number of nodes of the department level graphs). An over view of
                                                                        the proposed architecture is illustrated in Fig.  8. Note that the proposed model is developed to extract patterns
                                                                        from spatiotemporal data. Spatiotemporal graphs consist of time-var ying graph structure and features. In our
                                                                        setting, the graph structure depends on population mobility, while the features encode information such as the
                                                                        number of cases in the previous days, the vaccination rates, etc. The proposed MPNN model can deal with such
                                                                        spatiotemporal graphs since the different message passing layers are associated with discrete points in time and
                                                                        can capture the temporal aspects of the input data.
                                                                               To update the representations of the nodes of the department level graphs, besides the model described above
                                                                        (MPNN), we also follow a commonly-used approach in time series forecasting (MPNN-LSTM). Given a sequence
                                                                        of graphs G (1)                  ,    ...           ,G (T                  ) that correspond to a sequence of dates, we utilize a message passing model at each time
                                                                                                 DEP                     DEP
                                                                        Figure 8.                                          High-level illustration of our proposed multi-scale MPNN architecture. In the IRIS-level network
                                                                        each node is linked to an IRIS commune. In the department-level network each node represents a department.
                                                                        Each color is associated to a department.
Scientific Reports |         (2023) 13:5235  |                                                                                                                                                                                                                                                                                          https://doi.org/10.1038/s41598-023-31222-610

                                                                 step, to obtain a sequence of representations h(1)                                                    ,        h(T                  ) for each node v representing some department. These
                                                                                                                                                               v                                 ,    ...v
                                                                 representations are then fed into a Long-Short Term Memor y network (LSTM)    48 which can capture the long-
                                                                 range temporal dependencies in time series. We expect the hidden states of an LSTM to capture the temporal
                                                                 information and nonlinear dynamics from the historical data of COVID-19. The new representation of a given
                                                                 region is the hidden state of the last time step of the LSTM model. These representations are then passed on to
                                                                 fully-connected layers to produce the output.
                                                                 Experimental  setup.                                                                                                                                 We next present the values of the hyperparameters of the proposed models. We set
                                                                 the number of epochs to 500 epochs with early stopping applied when the validation accuracy does not increase
                                                                 for 50 epochs. Early stopping starts to occur from epoch 100 and onward. The batch size is set to 8. We used the
                                                                 Adam optimizer with a learning rate of 10−3                                                   . We set the number of hidden units of the message passing layers
                                                                 to 64. Each message passing layer is followed by a batch normalization layer and a dropout layer with a dropout
                                                                 rat io of 0.5. 1e mo  del t hat achie ve d t he hig hest va lidat ion acc urac    y is store d in t he disk and is t hen ret r ie  ve d
                                                                 and used to make predictions for the test samples. For the MPNN+LSTM model, the dimension size of the hid-
                                                                 den states of the LSTM is set equal to 64.
                                                                 Baselines.                                                                                                                                                             We compare the proposed models against the following 6 baselines and benchmark methods,
                                                                 which have been applied to the problem of COVID-19 forecasting: (1) AVG: The average number of cases for the
                                                                 specific region up to the time of the test day ; (2) AVG WINDOW: The average number of cases in the past d for
                                                                 the specific region where d is the size of the window ; (3) LAST DAY: The number of cases in the previous days
                                                                 is the prediction for the next days; (4)                                                                                                  LSTM49: A two-layer LSTM that takes as input the sequence of new cases
                                                                 in a region for the previous week; (5)                                                                                         ARIMA50: A simple autoregressive moving average model where the input
                                                                 is the whole time-series of the region up to before the testing day ; and (6)                                                                               PROPHET51: A forecasting model for
                                                                 various types of time series whose input is similar to that of ARIMA.
                                                                 Data availability
                                                                 Hospitalization, positivity, vaccination, and IRIS datasets are provided as supplementar y material. They are also
                                                                 available publicly at data.gouv.fr and from the corresponding author on reasonable request. The mobility data
                                                                 that support the findings of this study are available from dataforgood.facebook.com but restrictions apply to the
                                                                 availability of these data, which were used under license for the current study, and so are not publicly available.
                                                                 Received: 6 June 2022; Accepted: 8 March 2023
                                                                 References
                                                                              1.                  Hethcote, H. W. The mathematics of infectious diseases. SIAM Review                                        42, 599–653 (2000).
                                                                                2.            Kiss, I. Z., Miller, J. S. & Simon, P. Mathematics of Epidemics on Networks: From Exact to Approximate Models (Springer International
                                                                         Publishing, 2017).
                                                                              3.                  Brauer, F., Castillo-Chavez, C. & Feng, Z. Mathematical Models in Epidemiology          Vol. 32 (Springer, 2019).
                                                                               4.           y Piontti, A. P., Perra, N., Rossi, L., Samay, N. & Vespignani, A. Charting the Next Pandemic: Modeling Infectious Disease Spreading
                                                                         in the Data Science Age (Springer, 2019).
                                                                              5.                  Viboud, C. & Vespignani, A. The future of influenza forecasts. Proc. Natl. Acad. Sci.                 116, 2802–2804 (2019).
                                                                     6.  World Health Organization Coronavirus (COVID-19) Dashboard. https://covid19.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   w ho.int (2022). [Online; accessed
                                                                         14-February-2022].
                                                                              7.                  Foroutan, P. & Lahmiri, S. The effect of COVID-19 pandemic on return-volume and return-volatility relationships in cryptocur-
                                                                         rency markets. Chaos Solitons Fractals               162, 112443 (2022).
                                                                              8.                  Saadat, S., Rawtani, D. & Hussain, C. M. Environmental perspective of COVID-19. Sci. Total Environ.                    728, 138870 (2020).
                                                                              9.                  Tuan, N. H., Mohammadi, H. & Rezapour, S. A mathematical model for COVID-19 transmission by using the Caputo fractional
                                                                         derivative. Chaos Solitons Fractals 140, 110107 (2020).
                                                                  10.        Tuite, A. R., Fisman, D. N. & Greer, A. L. Mathematical modelling of COVID-19 transmission and mitigation strategies in the
                                                                         population of Ontario, Canada. Cmaj                 192, E497–E505 (2020).
                                                                  11.          Ndaïrou, F., Area, I., Nieto, J. J. & Torres, D. F. Mathematical modeling of COVID-19 transmission dynamics with a case study of
                                                                         Wuhan. Chaos Solitons Fractals 135, 109846 (2020).
                                                                  12.        Khajanchi, S., Sarkar, K., Mondal, J., Nisar, K. S. & Abdelwahab, S. F. Mathematical modeling of the COVID-19 pandemic with
                                                                         intervention strategies. Results Phys.                         25, 104285 (2021).
                                                                  13.            Nadim, S. S., Ghosh, I. & Chattopadhyay, J. Short-term predictions and prevention strategies for COVID-19: A model-based study.
                                                                         Appl. Math. Comput.         404, 126251 (2021).
                                                                  14.        Asamoah, J. K. K. et al. Optimal control and comprehensive cost-effectiveness analysis for COVID-19. Results Phys.                           33, 105177
                                                                         (2022).
                                                                  15.          Karniadakis, G. E. et al.                 Physics-informed machine learning. Nat. Rev. Phys.                 3, 422–440 (2021).
                                                                  16.            Murphy, C., Laurence, E. & Allard, A. Deep learning of contagion dynamics on complex networks. Nat. Commun.                                       12, 1–11 (2021).
                                                                  17.          Kutz, J. N. Deep learning in fluid dynamics. J. Fluid Mech.          814, 1–4 (2017).
                                                                   18.         Wu, Y., Yang, Y., Nishiura, H. & Saitoh, M. Deep learning for epidemiological predictions. In The 41st International ACM SIGIR
                                                                         Conference on Research & Development in Information Retrieval   1085–1088 (2018).
                                                                   19.            Wang, P., Zheng, X., Li, J. & Zhu, B. Prediction of epidemic trends in COVID-19 with logistic model and machine learning technics.
                                                                         Chaos Solitons Fractals 139, 110058 (2020).
                                                                   20.           Wieczorek, M., Siłka, J. & Woźniak, M. Neural network powered Covid-19 spread forecasting model. Chaos Solitons Fractals                           140,
                                                                         110203 (2020).
                                                                  21.                                                         Wu,          Z.     et al. A comprehensive survey on graph neural networks. IEEE Trans. Neural Netw. Learn. Syst.                             32, 4–24 (2020).
                                                                  22.                                      Ying,         R .    et al. Graph convolutional neural networks for web-scale recommender systems. In Proceedings of the 24th ACM SIGKDD
                                                                         International Conference on Knowledge Discovery & Data Mining 974–983 (2018).
                                                                   23.           Battaglia, P., Pascanu, R., Lai, M., Jimenez Rezende, D. et al. Interaction networks for learning about objects, relations and physics.
                                                                         In Advances in Neural Information Processing Systems (2016).
Scientific Reports |         (2023) 13:5235  |                                                                                                                                                                                                                                                                                          https://doi.org/10.1038/s41598-023-31222-611

                                                            24.         Soriano-Paños, D., Ghoshal, G., Arenas, A. & Gómez-Gardeñes, J. Impact of temporal scales and recurrent mobility patterns on
                                                                   the unfolding of epidemics. J. Stat. Mech. Theory Exp.                        2020, 024006 (2020).
                                                            25.           Ma, X., Luo, X.-F., Li, L., Li, Y. & Sun, G.-Q. The influence of mask use on the spread of COVID-19 during pandemic in New York
                                                                   City. Results Phys. 34, 105224 (2022).
                                                           26.                                      Kapoor,         A.    et al. Examining COVID-19 forecasting using spatio-temporal graph neural networks. In 16th International Workshop
                                                                   on Mining and Learning with Graphs (2020).
                                                            27.        Panagopoulos, G., Nikolentzos, G. & Vazirgiannis, M. Transfer graph neural networks for pandemic forecasting. In Proceedings
                                                                   of the 35th AAAI Conference on Artificial Intelligence   (2021).
                                                            28.        Davahli, M. R., Fiok, K., Karwowski, W., Aljuaid, A. M. & Taiar, R. Predicting the dynamics of the COVID-19 pandemic in the
                                                                   United States using graph theory-based neural networks. Int. J. Environ. Res. Public Health                             18, 3834 (2021).
                                                            29.       Fritz, C., Dorigatti, E. & Rügamer, D. Combining graph neural networks and spatio-temporal disease models to improve the
                                                                   prediction of weekly COVID-19 cases in Germany. Sci. Rep.                   12, 3930 (2022).
                                                            30.         Hy, T. S., Nguyen, V. B., Tran-Thanh, L. & Kondor, R. Temporal multiresolution graph neural networks for epidemic prediction.
                                                                   In Workshop on Healthcare AI and COVID-19 21–32 (2022).
                                                            31.          Xie, F., Zhang, Z., Li, L., Zhou, B. & Tan, Y. EpiGNN: Exploring spatial transmission with graph neural network for regional epi      -
                                                                   demic forecasting. In Proceedings of the 2022 European Conference on Machine Learning and Principles and Practice of Knowledge
                                                                   Discovery in Databses (2022).
                                                            32.            Xue, J., Yabe, T., Tsubouchi, K., Ma, J. & Ukkusuri, S. Multiwave COVID-19 prediction from social awareness using web search and
                                                                   mobility data. In Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining 4279–4289 (2022).
                                                            33.          Lucas, E., Guillet, A., Bonaldi, C., Caserio-Schönemann, C. & Le Strat, Y. Géodes: The health indicators web portal of the french
                                                                   public health agency. https://        geodes. sante        publi quefr ance.                     fr/ (2019).
                                                             34.                    Données de laboratoires infra-départementales durant l’épidémie COVID-19. https:// www. data. gouv. fr/ en/ datas                                                                                                                                                                                                                                                                                         ets/ donne                                                es- de-
                                                                   labor atoir es- infra-            depar temen tales- durant- lepid emie- covid- 19/             (2022). [Online; accessed 14-February-2022].
                                                             35.          Buckee, C. O. et al. Aggregated mobility data could help fight COVID-19. Science                                368, 145–146 (2020).
                                                             36.          Data For Good. https:// dataf                          orgood. faceb        ook. com/ dfg/ tools (2022). [Online; accessed 14-February-2022].
                                                            37.                                      Hu,            T.     et al. Human mobility data in the COVID-19 pandemic: Characteristics, applications, and challenges. Int. J. Digit. Earth
                                                                   14, 1126–1147 (2021).
                                                             38.           Données relatives aux personnes vaccinées contre la Covid-19. https://                                                                                                                                                  www.        data. gouv.                              fr/ fr/                                               datas ets/ donne                                                es- relat                                      ives-                                      aux- perso
                                                                   nnes- vacci nees- contre- la-            covid- 19-1/             (2022). [Online; accessed 14-February-2022].
                                                             39.           Xiong, C., Hu, S., Yang, M., Luo, W. & Zhang, L. Mobile device data reveal the dynamics in a positive relationship between human
                                                                   mobility and COVID-19 infections. Proc. Natl. Acad. Sci.                            117, 27087–27089 (2020).
                                                            40.                                      Arenas,         A.     et al. Modeling the spatiotemporal epidemic spreading of COVID-19 and the impact of mobility and social distancing
                                                                   interventions. Phys. Rev. X                                       10, 041055 (2020).
                                                             41.           Levin, R., Chao, D. L., Wenger, E. A. & Proctor, J. L. Insights into population behavior during the COVID-19 pandemic from cell
                                                                   phone mobility data and manifold learning. Nat. Comput. Sci.          1, 588–597 (2021).
                                                            42.                                      Fan,          W.     et al. Graph neural networks for social recommendation. In The World Wide Web Conference 417–426 (2019).
                                                             43.          Shlomi, J., Battaglia, P. & Vlimant, J.-R. Graph neural networks in particle physics. Mach. Learn. Sci. Technol.                     2, 021001 (2020).
                                                            44.                                      Derrow-Pinion,         A.    et al. ETA prediction with graph neural networks in google maps. In Proceedings of the 30th ACM International
                                                                   Conference on Information & Knowledge Management 3767–3776 (2021).
                                                             45.          Gu, W., Gao, F., Lou, X. & Zhang, J. Discovering latent node Information by graph attention network. Sci. Rep.                             11, 1–10 (2021).
                                                             46.          Gilmer, J., Schoenholz, S. S., Riley, P. F., Vinyals, O. & Dahl, G. E. Neural message passing for quantum chemistry. In Proceedings
                                                                   of the 34th International Conference on Machine Learning   1263–1272 (2017).
                                                             47.        Kipf, T. N. & Welling, M. Semi-supervised classification with graph convolutional networks. In    5th International Conference on
                                                                   Learning Representations (2017).
                                                             48.          Hochreiter, S. & Schmidhuber, J. Long short-term memory. Neural Comput.          9, 1735–1780 (1997).
                                                             49.       Chimmula, V. K. R. & Zhang, L. Time series forecasting of COVID-19 transmission in Canada using LSTM networks.                     Chaos
                                                                   Solitons Fractals 135, 109864 (2020).
                                                            50.                                                         Kufel,           T.     et al. Arima-based forecasting of the dynamics of confirmed COVID-19 cases for selected European countries. Equilib.
                                                                   Q. J. Econ. Econ. Policy                 15, 181–204 (2020).
                                                             51.        Mahmud, S. Bangladesh COVID-19 daily cases time series analysis using Facebook prophet model. Available at SSRN 3660368
                                                                   (2020).
                                                           Acknowledgements
                                                           We would like to thank Facebook for providing the COVID-19 Mobility Data Network. This work was partially
                                                           supported by French state funds managed within the “Plan Investissements d’Avenir” by the ANR (reference
                                                           ANR-10-IAHU-02). This project was partially supported by ECOVISION : Obser vatoire Numérique preVISION-
                                                           nel du COVID en Grand-Est.
                                                           Author contributions
                                                           All authors reviewed the manuscript.
                                                           Competing interests
                                                           The authors declare no competing interests.
                                                           Additional information
                                                           Supplementar y Information The online version contains supplementary material available at https:// doi. org/
                                                           10. 1038/ s41598- 023- 31222-6.
                                                           Correspondence and requests for materials should be addressed to K.S.
                                                           Reprints and permissions information is available at www.nature.com/reprints.
                                                           Publisher’s note                      Springer Nature remains neutral with regard to jurisdictional claims in published maps and
                                                           institutional affiliations.
Scientific Reports |         (2023) 13:5235  |                                                                                                                                                                                                                                                                                          https://doi.org/10.1038/s41598-023-31222-612

                                                                                Open Access                               This article is licensed under a Creative Commons Attribution 4.0 International
                                                                                License, which permits use, sharing, adaptation, distribution and reproduction in any medium or
                                                         format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the
                                                         Creative Commons licence, and indicate if changes were made. The images or other third party material in this
                                                         article are included in the article’s Creative Commons licence, unless indicated other wise in a credit line to the
                                                         material. If material is not included in the article’s Creative Commons licence and your intended use is not
                                                         permitted by statutor y regulation or exceeds the permitted use, you will need to obtain permission directly from
                                                         the copyright holder. To view a copy of this licence, visit http:// creat                                                                              iveco mmons. org/ licen                                                       ses/ by/4. 0/.
                                                         © The Author(s) 2023
Scientific Reports |         (2023) 13:5235  |                                                                                                                                                                                                                                                                                          https://doi.org/10.1038/s41598-023-31222-613

