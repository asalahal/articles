                                                                                              IEEE       TRANSACTIONS       ON       MEDICAL        IMAGING,        VOL.        42,        NO.       2,       FEBRUARY       2023                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   557
            Str uctural                          Attention                          Graph                          Neural                          Networ k                          for
     Diagnosis                         and                         Prediction                          of                         COVID-19                          Sever ity
                         Yanbei           Liu                         ,           Henan           Li,            Tao           Luo,           Changqing           Zhang                                                    ,            Member,            IEEE,           Zhitao           Xiao,           Ying            Wei,
                                                            Yaozong           Gao,            Feng           Shi,            Fei            Shan                                               ,            and           Dinggang           Shen                                   ,            Fellow,           IEEE
       Abstract    —    With                            rapid                            worldwide                            spread                            of                             Coron- (e.g.,        0.58        in        terms        of        Correlation        Coefﬁcient)       performance,
avirus           Disease           2019           (COVID-19),            jointly           identifying           severe                                                                               compared        with        other       comparison        methods.
COVID-19              cases              from              mild              ones              and              predicting              the              con-                                                 Index                    Terms  —    COVID-19                    severity ,                    structural                    attention
version          time           (from           mild           to           severe)          is           essential          to           optimize                                                    mechanism,        graph        neural        network,        multi-task       learning.
the             workﬂow             and             reduce             the             clinician’s            workload.             In             this
study,            we             propose            a             novel            framework             for             COVID-19             diag-
nosis,      termed      as      Structural      Attention      Graph      Neural      Network
(SAGNN),         which         can         combine         the         multi-source        information                                                                                                              INCE                                     the                                     outbreak                                    of                                     Coronavirus                                    Disease                                     2019
including                 features                 extracted                 from                 chest                  CT,                  latent                 lung                                           (COVID-19),               the               prevention             and              control              of               the               epidemic
structural     distribution,     and      non-imaging     patient      information                                                                                                                    S
to          conduct         diagnosis         of          COVID-19         severity         and         predict         the                                                                           have                        brought                       enormous                       burdens                       on                        the                        global                        healthcare
conversion           time           from            mild            to           severe.           Speciﬁcally,          we            ﬁrst                                                           system.          According         to          the          work          reported         by          WHO,          as          of          March
construct          a           graph           to           incorporate          structural           information           of                                                                        20,                2022,                the                 number                of                global                cumulative                cases                was                 up                to
the             lung             and             adopt             graph             attention            network            to             iteratively                                               469.9               million                and                the               cumulative              death                toll                was                6.1               million.
update             representations            of             lung             segments.             To              distinguish                                                                       The                        primarily                         routine                        clinical                         diagnosis                        of                         COVID-19                         is
different           infection           degrees           of            left            and            right            lungs,           we            fur-
ther               introduce              a                structural               attention              mechanism.               Finally,                                                          usually                 based                 on                 the                  epidemiological                history,                 clinical                 mani-
we      introduce     demographic     information     and      develop     a      multi-                                                                                                              festations           and           various          laboratory           detection           methods,           including
task              learning             framework              to              jointly              perform              both              tasks              of                                       Nucleic             Acid              Ampliﬁcation             Test              (NAAT),             Computed             Tomog-
classiﬁcation          and           regression.          Experiments           are           conducted                                                                                               raphy        (CT)        scan         and        serological        techniques.        However,        it         is         well
on        a        real        dataset       with        1687        chest       CT        scans,       which        includes                                                                         known                that                manual                detection                is                 costly,                time-consuming,               and
1328     mild      cases     and      359     severe     cases.     Experimental     results
show                  that                  our                   method                   achieves                  the                   best                  classiﬁcation                        may           increase           the           infection          risk           of           clinicians.           As           an           alternative,
(e.g.,        86.86%       in        terms        of        Area        Under        Curve)       and        regression                                                                               artiﬁcial                intelligence               technique               based                on                chest                CT                images                is
     Manuscript        received        6        November        2022;        accepted        26        November        2022.                                                                          a                 common                and                 effective                diagnosis                method,                which                 can                 show
Date       of      publication      2       December       2022;      date       of      current      version       2      February                                                                   the              pathological              ﬁndings,              e.g  .,              Ground-Glass              Opacity               (GGO)
2023.         This         work         was         suppor ted         in         par t         by         the         National         Natural          Science                                      and                      consolidation                     and                      nodules                     [1],                      providing                     more                      patho-
Foundation     of      China      under      Grant     61976151,     in      par t     by      the      Tianjin     Natural                                                                           logical              information              with               higher             accuracy.             Although              extensive
Science           Foundation           Project           under           Grant           H2021202008,           in          par t           by           the                                          CT-based                         studies                         [2],                         [3]                         focus                        on                         COVID-19                         diagnosis,
China      Postdoctoral       Science      Foundation      under      Grant      2022M712370,      and
in              par t              by               the               National              Key               Research               and              Development               Program               ofthere                   has                   been                   relatively                   little                    research                   on                   severity                   classiﬁ-
China      under      Grant     2018YFC0116400.      (Corresponding      authors:      Tao      Luo;                                                                                                  cation             of             COVID-19             or             conversion            time              regression.             However,
Dinggang        Shen.)                                                                                                                                                                                it                   is                   important                  for                   a                    doctor                   to                    make                   an                   early                   diagnosis                   of
     Yanbei                              Liu                              and                              Zhitao                              Xiao                              are                              with                               the                              School                              of                               Life
Sciences,                               Tiangong                              University,                               Tianjin                              300387,                               China                               (e-mail:COVID-19            and            predict            the            time             that             a             patient            would            spend            to
liuyanbei@tiangong.edu.cn;        xiaozhitao@tiangong.edu.cn).                                                                                                                                        convert            to              severe              stage,              simultaneously.
     Henan                               Li                               is                               with                               the                               School                               of                               Electrical                               and                               ElectronicRecently,                   it                   has                   been                   reported                   that                   COVID-19                   classiﬁca-
Engineering,                       Tiangong                        University,                        Tianjin                       300387,                        China                        (e-mail:
SharonLee1997@163.com).                                                                                                                                                                               tion                and                conversion               time                regression               tasks                are                highly                interre-
     Tao                    Luo                    and                    Changqing                    Zhang                    are                    with                    the                    College                   of                    Intelli-lated            [4],            [5].           Predicting           whether           mild            case            of            COVID-19            will
gence        and       Computing,       Tianjin       University,        Tianjin       300350,       China       (e-mail:                                                                             develop               severe                symptom               and                estimating                the                conversion               time
luo_tao@tju.edu.cn;         zhangchangqing@tju.edu.cn).
     Ying                 Wei,                 Yaozong                 Gao,                 and                 Feng                 Shi                 are                 with                 the                  Depar tmentcan         assist          doctors         in         analyzing        subject         situations         and         supplying
of             Research            and            Development,             Shanghai            United             Imaging            Intelligence                                                     meticulous                treatment.                 A                  computer-aided                COVID-19                 severity
Company            Ltd.,            Shanghai            200232,           China            (e-mail:            ying.wei@uii-ai.com;                                                                   classiﬁcation             system              can              help             prioritize             treatment             for             patients
yaozong.gao@uii-ai.com;        feng.shi@uii-ai.com).
     Fei       Shan        is       with        the        Depar tment       of       Radiology,       Shanghai        Public       Health                                                            with                more                severe                disease                and                alleviate                the                burden                on                health
Clinical                 Center,                 Fudan                 University,                  Shanghai                 200433,                 China                 (e-mail:                   systems           caused           by           COVID-19.           Accurately           regressing           the           con-
shanfei2901@163.com).                                                                                                                                                                                 version          time           of           severe          case           can           he lp           doctors          prevent          deteriora-
     Dinggang        Shen        is        with         the         School        of        Biomedical         Engineering,        Shang-
haiTech       University,        Shanghai        201210,       China,       also        with        Shanghai        United                                                                            tion          of           the          patient’s          condition,         thus          achieving          a           more          objective
Imaging         Intelligence         Company         Ltd.,          Shanghai         200230,         China,         and         also                                                                  and               reliable               diagnosis.               Hence,               instead                of                classifying               patients
with       the       Shanghai       Clinical      Research       and       Trial      Center,       Shanghai      201210,                                                                             into               mild               and               severe              cases               as               a               standalone              problem,              a               multi-
China        (e-mail:        Dinggang.Shen@gmail.com).
     Digital        Object        Identiﬁer        10.1109/TMI.2022.3226575                                                                                                                           task             learning            framework            for             COVID-19            severity             identiﬁcation
                                                1558-254X        ©        2022         IEEE.         Personal        use         is        permitted,        but        republication/redistribution        requires        IEEE         permission.
                                                                                             See         https://www.ieee.org/publications/rights/index.html           for        more         information.
         Authorized licensed use limited to: Necmettin Erbakan Universitesi. Downloaded on February 18,2025 at 17:29:34 UTC from IEEE Xplore.  Restrictions apply.

558                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         IEEE        TRANSACTIONS       ON        MEDICAL       IMAGING,        VOL.       42,        NO.       2,        FEBRUARY       2023
                                                                                                                                                                                                                                                                          demographic                     information                      to                       learn                      comprehensive                     rep-
                                                                                                                                                                                                                                                                          resentation                    for                    diagnosis                    and                    prediction                   of                     COVID-19
                                                                                                                                                                                                                                                                          severity.              To               our              best               knowledge,             this               is               the               ﬁrst               attempt
                                                                                                                                                                                                                                                                          to                   employ                  anatomical                  structure                  of                   lung                  for                   COVID-19
                                                                                                                                                                                                                                                                          diagnosis.
                                                                                                                                                                                                                                                                 •                             We              propose             a             structural             attention             mechanism             with             node-
                                                                                                                                                                                                                                                                          level                   and                   subgraph-level                  attention                   to                   effectively                  distin-
                                                                                                                                                                                                                                                                          guish               different               infection              degrees              of               left               and               right               lungs.
Fig.          1.                                 The          illustration           of          chest           structures           used          for           CT          scan           analysis,                                                                    Speciﬁcally,                         we                         ﬁrst                         leverage                        node-level                        attention                         to
i.e.,         ﬁve         lung        lobes        and        eighteen        lung        segments.                                                                                                                                                                       aggregate                         information                         from                          neighbors                         for                          each                          lung
                                                                                                                                                                                                                                                                          segment,                and                then                introduce                subgraph-level               attention                to
and                conversion               time                prediction               has                more                important                potential                                                                                                        learn                   the                    importance                  of                    different                  lungs                   for                   COVID-19
for                clinical               diagnosis.               Multi-task               learning               can                learn                a               shared                                                                                         diagnosis.
                                                                                                                                                                                                                                                                 •                             We                        conduct                      extensive                       experiments                      on                       a                        dataset                       with
representation                       by                       domain                       information                      from                       interconnected                                                                                                     1687                     chest                     CT                      scans,                     including                     1328                    mild                     cases                     and
tasks,             and            thus,             can            further            improve            the            learning            performance                                                                                                                   359                severe               cases.                Experimental               results                demonstrate               that
and                    make                     models                    more                    efﬁcacious                     [6].                    More                    recently,                    for                                                         our            algorithm            is             able             to            identify            severe            cases             and            predict
COVID-19         diagnosis,         there         are         some         multi-task         learning         meth-                                                                                                                                                      the            conversion          time            from           mild           to            severe           with           Area           Under
ods             focusing             on             segmentation             and             classiﬁcation              [7],             [8],             [9].                                                                                                            Curve                    of                    86.86%,                   Accuracy                   of                    90.40%,                   Sensitivity                    of
         The                        structural                        information                       of                        lung,                       such                        as                        anatomical                                            77.96%,                   Speciﬁcity                   of                   93.75%,                   Correlation                   Coefﬁcient
structure               between                lung                segments               (as                shown                in                   Fig.                1),               plays                                                                        of             0.58,             and             Root              Mean             Square             Error             of             1.27.
an                     important                    role                    in                     extracting                    features                    and                    improving                   the                                              The                        rest                         of                        paper                        is                         organized                        as                         follows.                        We                         brieﬂy
performance       of        different        tasks         [10].        Most         deep        learning        models                                                                                                                                 introduce           the            most            relevant            studies            in            Section            I.            In            Section            II,
based                   on                   Convolutional                  Neural                  Network                   (CNN)                   [11],                   [12],                                                                     we                    present                    our                    method                    in                    detail.                    Experimental                    results                    and
[13]                     for                     COVID-19                     diagnosis                     utilize                     stacked                     convolutional                                                                       analysis                   are                    presented                   in                    Section                   III.                    The                   ﬁnal                    Section                   IV
operations                      to                      extract                      features                      from                      chest                      CT                       scan                      images                       makes             a              conclusion             for             this              paper.
and             show            promising             performance.           However,            these             models             are
limited                      in                      ability                      to                      capture                      relationship                     between                      different                                                                                                                         I.                R ELATED               W ORK
segments                  of                   the                   lung,                   which                   is                   potentially                  very                   conductive
to              COVID-19              diagnosis.             Graph              Neural             Network              (GNN)              [14],                                                                                                        A.                 Graph           Based           Medical           Diagnosis
[15],                   as                   an                   effective                   feature                   extraction                  tool                   for                   graph                   data,                                   Recently,                     graph                    models                     are                     becoming                    increasingly                    pow-
can                   capture                  inherent                  relationshi  p                  between                   different                  parts                   of                                                                erful,                  allowing                   their                   application                  to                   challenging                  problems                  in
the              lung              by              encoding             the               complex             structure              of              different              lung                                                                        the                           medical                          ﬁeld                           [10].                          There                           has                          been                           a                           surge                          of                           uti-
segments,                so                 it                is                potentially                useful                in                improving               the                 model                                                    lizing                           Graph                            Neural                           Networks                           (GNN)                           on                            medical                           diag-
performance.                                                                                                                                                                                                                                            nosis,                         by                         effective                        representation                        of                         complex                         relationship
         To              this              end,             we              propose             a              structural             attention             graph             neural                                                                    between           different          parts           of           medical           images.           For           autism           diagno-
network            (SAGNN)            framework            for            diagnosis            and             prediction            of                                                                                                                 sis,              Rakhimberdina            et              al.             [17]             constructed             graph             networks             by
COVID-19          severity.          Compared         with           previous         studies,           SAGNN                                                                                                                                          using            relationship            between            subjects.            Kazi             et             al.            [18]            proposed
can                   combine                  the                   complex                  lung                   st  ructure,                  features                   extracted                                                                 Inception-GCN                   for                    deep                    learning                    on                    graphs                    for                    node-level
from                   the                   chest                   CT                   and                   non-imaging                  patient                   information                  to                                                  classiﬁcation           of          disease           prediction.          For           Alzheimer’s          Diagnosis
accurately                 identify                 severe                 C OVID-19                 cases                 from                 mild                 cases                                                                              (AD),                         Parisot                         et                         al.                          [19]                         constructed                         a                         population                        graph
and              predict              the              conversion             time               from              mild              to               severe.              Speciﬁ-                                                                      by                   integrating                   subject-speciﬁc                     imaging                   (MRI)                   and                    pairwise
cally,          to          incorporate         structural          information         of          the          lung,          we          ﬁrst                                                                                                        interactions              using               non-imagin  g              data,              and               then               utilized               Graph
construct                   a                    graph                   based                   on                   eighteen                   lung                   segments,                   where                                               Convolutional                  Neural                  (GCN)                   to                   perform                  node                  classiﬁcation
nodes            are             constructed            based             on             lung             segments,             and             edges             are                                                                                   (MCI/AD).                        Besides,                         there                        are                        some                        models                       proposed                       for
deﬁned                 based                 on                 anatomical                 structure                 of                 the                 lung.                 We                  then                                              COVID-19                diagnosis.                Yu                et                al.                 [20]                developed               a                 framework
present              a               structural              attention              mechanism              with               node-level             and                                                                                                to              combine             graph             representation             with              a              Convolutional             Neural
subgraph-level               attention                layers                to                 effectively                distinguish                dif-                                                                                               Network        (CNN)         for         COVID-19        detection,        by         using         the         similar-
ferent                     infection                    degrees                    of                     left                     and                    right                     lungs.                     Moreover,                                ity               between               extracted              features               to               form               edges               between              nodes.
combining              the               lung               graph              and               demographic             factors              (i.e.,               age                                                                                  Saha                  et                  al.                  [21]                  utilized                  lung                  edge                  information                 to                   construct
and                  gender)                  as                   the                   input,                  we                   develop                  a                   multi-task                  learning                                 graph                     and                      then                     obtained                     graph                     representation                     by                      GNN                      to
framework                      to                        jointly                       perform                       classiﬁcation                       and                       regression                                                           perform            classiﬁcation              task.
tasks.               In               our               framework,              the               focal               loss               regularization              [16]               is                                                                       Various                          attention                           mechanisms                          in                           the                           graph,                           e.g.,                           self-
further                   adopted                   to                    solve                    the                    imbalance                   of                    mild                   and                   severe                         attention                         [22]                         and                         soft-attention                        [23],                         have                         been                         used                         in
COVID-19                       cases.                        The                       contributions                      of                        this                        study                        can                        be              medical                 diagnosis                 to                 direct                  the                 model                 to                  focus                 on                 the                  rele-
summarized             as              follows:                                                                                                                                                                                                         vant                parts.                An                attention                architecture               can                preserve               the                details
         •                             We          propose         SAGNN,          which         can         combine         structural         infor-                                                                                                  from                     raw                      signals                      and                      select                      the                      most                      crucial                      information.
                  mation                  of                  lungs,                  features                 extracted                 from                  chest                  CT                  and                                           Liu                 et                 al.                 [24]                proposed                a                 graph-based               attention                 network                to
           Authorized licensed use limited to: Necmettin Erbakan Universitesi. Downloaded on February 18,2025 at 17:29:34 UTC from IEEE Xplore.  Restrictions apply.

LIU       et       al.:          SAGNN       FOR       DIAGNOSIS        AND      PREDICTION       OF       COVID-19       SEVERITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   559
Fig.         2.                              Illustration          of         the          proposed          framework.          It          mainly          consists          of          three          par ts.          First          of         all,          features          extracted          from          the         CT          images          are         utilized          to
construct           a          graph           based          on          anatomical           structure           of          the           lung.          Then,           we          introduce           a          graph           neural           network           with           structural            attention           mechanism           to
obtain         lung         representations.         Moreover,         incorporating         demographic         fac tors         (i.e.,         age         and         gender)        into         lung         representations,         we         develop         a         multi-task
learning        framework         to         jointly        perform        classiﬁcation         and        regression.
select                EEG                channels               to                extract                more               discriminative               features,                                                                    Zhang                 et                 al.                 [31]                 proposed                a                  dis  tributed                 multi-modal                multi-
which           achieved          higher           recognition          accuracies.           Yang           et           al.            [25]                                                                                         task           learning           method          to            jointly           predict           multiple           regression           and
proposed                    a                     graph-attention                   based                     method                    to                     detect                     bipolar                                     classiﬁcation                     variables                    in                     Alzheimer’s                    Disease.                     Meanwhile,
disorder.                   Ma                    et                   al.                    [26]                   proposed                   an                    attention-guided                  deep                          multi-task             learning             was              used              to              diagnose            other             diseases,              such
graph            neural            network            model            to             derive            structural            and            temporal                                                                                 as              cancer             [32],             [33].
graph          features          for          diagnosis          of          Alzheimer’s          Disease.           Attention                                                                                                                There               are               a               few               multi-task               learning              studies               for               COVID-19
mechanism            was             also             beneﬁcial            for            COVID-19            diagnosis            [27],                                                                                              diagnosis.                   The                   bulk                   of                   studies                   focus                   on                   joint                   segmentation
[28].             The             differences             between             these             studies              and             our             work             are                                                             and                localization                of                COVID-19                lesions                [34],                [35],                [36],                [37].
two-fold:                   1)                    The                   manner                   of                    structural                   attention                   framework.                                            Goncharov                        et                         al.                         [38]                        proposed                        a                         model                        to                         identify                        the
Most                 previous               works                adopt                a                 single                 attention                layer                 whereas                                                 potential          COVID-19          cases           and          conduct          severity          quantiﬁcation,
we          utilize          a          structural          attentio n          mechanism          consisting          of          node-                                                                                              which          were          formalized         as          tasks          of          classiﬁcation          and          regression
level               and                subgraph-level              attention.                Node-level               attention               is                to                                                                    of        affected        lung         percentage.        Dif ferent        from        studies         that         focused
learn         segment         representations        by         aggregating       information        from                                                                                                                             on                        how                        to                        identify                       COVID-19                        from                        other                        lung                        diseases,
segment           neighbors          and           subgraph-level          attention           is            to            learn           the                                                                                        Zhu              et              al.          [4]          predicted          the          disease           progression          (classiﬁcation)
importance                of                 different                lungs.                2)                The                 type                of                 used                 features.                               and                      also                       estimated                      the                       conversion                      time                       (regression).                      They
Compared                  with                    previous                  studies                   based                   on                   a                    single                   type                   of            employed                  sparse                   logistic                   regression                  for                   binary                  classiﬁcation
feature,                  we                   combine                  the                   multi-source                  information                 including                                                                     and                       linear                       regression                       for                       the                       regression,                      yet                       the                       designed
features             extracted             from             chest              CT,             l atent             lung              structural             distri-                                                                   method             is              more              applicable             to              linearly              separable             data.
bution             and              non-imaging            patient             information.             This             helps             us              to
take              more             effective             information            into              account.                                                                                                                                                                                              II.                P  ROPOSED                M ODEL
B.                Multi-Task           Lear ning                                                                                                                                                                                              In               this               section,               we                describe               the                overall               architecture               of               our
                                                                                                                                                                                                                                      proposed                      model                       as                       shown                       in                           Fig.                        2.                        It                        consists                        of                        three
        Multi-task            learning           aims            to            improve           learning            efﬁciency           and                                                                                          components,                i.e.,                 1)                 Graph                 construction:                Constructing                 graph
prediction               accuracy               for               each               ta  sk                compared              with                the               case               of                                          based               on                anatomical               structure               of                the                lung                and               infection               fea-
training             a              separate              model              [6],              [29].             It              has             become              one             of              the                              tures                 extracted                 from                 chest                  CT;                  2)                  Structural                 attention                  based
most            effective           methods           in            medical            diagnosis.           For            Alzheimer’s                                                                                                graph                      representation:                     Aggregating                     subgraph                     representations
Diagnosis,                 DM2  L                   [30]                 was                  a                  deep                  multi-task                  multi-channel                                                      by               structural               attention               mechanism;               3)               Joint               classiﬁcation               and
learning             framework             for              simultaneous             brain              disease              classiﬁca-                                                                                               regression             optimization:            To              perform            classiﬁcation              and             regres-
tion               and               clinical               score               regression,              and               it                could               automatically                                                        sion             simultaneously.
learn                     discriminative                    features                    for                     MR                    images                    and                     explicitly                                            We             denote             matrices,             vectors            and             scalars             as             boldface            upper-
incorporate       demographic       information        into        the         learning        process.                                                                                                                               case          letters,          boldface         lowercase          letters         and         normal         italic          letters,
          Authorized licensed use limited to: Necmettin Erbakan Universitesi. Downloaded on February 18,2025 at 17:29:34 UTC from IEEE Xplore.  Restrictions apply.

560                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         IEEE        TRANSACTIONS       ON        MEDICAL       IMAGING,        VOL.       42,        NO.       2,        FEBRUARY       2023
                                                                                                                  TABLE         I
                                      TABLE     OF           M AIN         N OTATI ONS       U SED      IN           T HIS         PAPER
                                                                                                                                                                                                                                                                             Fig.        3.                 The        structural         attention         mechanism        module.
respectively.                     Graphs                      are                      deﬁned                      as                 { G  1 ,        G  2 ,...,                       G  n  }        ⊆                    G  .                                               HU  [−             700,−             500] ,               HU  [−             500,−             200] ,               HU  [−             200,50]                    and               HU  [50,∞]                       .
Each                      graph                      represents                      a                      case                       (one                      chest                      CT                       scan                      image)                        These           ﬁve           ranges          correspond          to           normal          lung           regions,          Ground-
and             contains            two             subgraphs,            i.e.,            {G  1 ,        G  2 }      ⊆                                 G  .             The             label             of                                                                Glass                 Opacity                 (GGO)                 regions,                mixed                Ground-Glass                Opacity
graph            for            classiﬁcation          {  y1 ,         y2,...                 yn  }        ⊆                               Y                   and            for            regression                                                                      (mGGO)              regions,             consolidation             regions             and              regions             of              vessel
{t1 ,       t2 ,...              tn  }        ⊆                                T                are         given.           G            consists         of         a          node         set             V                and         an                                calciﬁcation,             respectively.            Three             quantitative             features            of             these
edge            set                  E ,i.e.,               G          =        ( V  ,          E  ).             Node             attributes            in             graph            can             be                                                                  regions                are                  calculated                 and                 adopted                 as                 node                 attribute,                 which
denoted              as            X.               For               COVID-19               diagnosis              and               conversion              time                                                                                                           are             deﬁned              below:
estimation,            we            aim             to             learn            a               d   -dimensional           vector          z            for            each                                                                                                                               MI         (s )          =       VI        (s )      ×      (ρ               I         (s )      +        1000)      ×        0.001,
graph                     G                     under                  the                  framework                 of                  multi-task                  learning.                 More                                                                                                             VI         (s )          =                V          (si n     f     ect    ),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (2)
details               of              notations              used               in               this               paper              are               summarized              in               the                                                                        where          MI    (s ),         VI    (s )               and           ρ               I    (s )               represent              the              infection              mass
Ta     b     l     e                          I.                                                                                                                                                                                                                             feature,          volume           feature          and           density           feature          of           lung          segment                   s  ,
A.                Graph           Construction                                                                                                                                                                                                                               respectively.            ρ               I    (s )                  is                  deﬁned                 as                 the                 averaged              HU                       valu e                   o f
                                                                                                                                                                                                                                                                             infected           region.           V     (·)            can           calculate           the           volume           of           input           region
          The                construction               of                graph               is                crucial                to                model                interactions                                                                                   and           si n    f     ect                is          the          infected         region         in          lung          segment.         The          volume,
among                  lung                  segments,                   and                  it                   should                   be                   designed                  carefully.                                                                        density                     and                      mass                     features                     in                      the                     parts                     with                      different                  HU
Different                   from                   similarities                    in                    imaging                   feature                   [39]                   or                    non-                                                               value               ranges               are                also                considered               and               the                calculation               method
imaging                         feature                        [18],                        we                         construct                        graph                        based                         on                         lung                           is            similar.           Hence,           each           node           in            gr aph           contains           37- dimensional
anatomy.               The                anatomical               stru  cture               of                the                lung               can                inﬂuence                                                                                             handcrafted                features                  indica  ting                 infected                 region                 in                  each                 lung
the              diffusion             of              infections             (i.e.,             GGO),              which              is              an              important                                                                                             segment.            Due            to            the            original            features            being            of            rather            different
complementary         indicator         in          COVID-19         screening.         In          advanced                                                                                                                                                                 scales,             min-max            normalization            is             used             for            data            preprocessing.
stage,                  GGO                  may                  spread                 into                  surrounding                and                 fuse                  together
into                        consolidations                       [1],                        [40].                        Furthermore,                       edges                        between                                                                            B.                Structural           Attention            Mechanism
nodes                        are                        constructed                        based                        on                         inherent                       structure                       of                         the                                        After                constructing               graph               based                on                anatomical               structure                of
lung              rather              than              being              artiﬁcially              designed,              providing             a               more                                                                                                        the                   lung,                   we                   introduce                   a                    structural                   attention                   mechanism                   to
understandable             and              natural              approach.             In               our              study,              the              graph                                                                                                          learn              lung               representations.              The               presented              module              is               depicted
G                is              constructed             based             on              18             lung             segments             ( | V  |=           18).             The                                                                                     in              Fig.              3.
adjacent           matrix          A            is            deﬁned           based            on           anatomical            connections                                                                                                                                          1)             Node-Level             Attention  :                  Note                   that                  nodes                  (segments)                  with
of                 the                 lung.                 Mathematically,                considering                each                 lung                 segment                                                                                                     different               infection                degrees                should                show                different               importance
as              a              node             in              graph,             the              adjacent             matrix            A              can              be              deﬁned             as:{                                                           in                learning                node                embedding.               To                 aggregate               information               from
                                                                       A i,     j            =              1if               si          ∩                        s     j            =∅                                                                                    neighbors                 for                  each                  node,                 we                   adopt                  a                  Graph                  Attention                  Net-
                                                                                                            0otherwise.                                                                                                                                                                                                                                                                                                                                    (1)work                (GAT)                [42]                for                the                node-level               attention,                which                can                 be
where                    s                      represents                  lung                  segment.                      si            ∩                            s     j                   =∅                            means                  lung              expressed            by             normalizing            over            all             nodes            within             the             neighbor-
segment              si                   is              adjacent             to              lung             segment                s     j     .                                                                                                                         hood             as             follows:
          The                    node                   attribute                xi                         is                    extracted                   from                   chest                    CT                    image                                                                      α      ij             =                                                                                                        exp(σ   (      pT       ·[h(l ,k )∑i                                      ||h(l ,k )j                                   ]))
by                   VB-Net                    [41],                   which                   can                   quantify                   the                   COVID-19                   infec-                                                                                                                                               j   ∈     N   (i )         exp(σ   (      pT       ·[h(l ,k )i                                      ||h(l ,k )j                             ]))   ,                                                                                                                 (3)
tion                       feature                      from                      chest                       CT                       image.                      There                      are                       three                      kinds
of                     features                     used                     in                      our                     study,                     including                     infection                     volume,                                                  where        p           is           the           node-level          attention           vector          and          h(l ,k )i                                                                represents
density                         and                         mass                         feature,                        calculated                         from                         regions                        within                                               feature                 vector                 of                 node              v i                       at                 the                  l  -th                  layer                  in                  the                   k  -th                 (k              =
ﬁve                            Hounsﬁeld                           Unit                            (  HU   )                            value                            ranges:                      HU  [−∞                         ,−             700]  ,                 1,      2)               subgraph,              i.e.,            v          ∈                          G  1                 means              the               node           v                   is               in                left               lung
            Authorized licensed use limited to: Necmettin Erbakan Universitesi. Downloaded on February 18,2025 at 17:29:34 UTC from IEEE Xplore.  Restrictions apply.

LIU       et       al.:          SAGNN       FOR       DIAGNOSIS        AND      PREDICTION       OF       COVID-19       SEVERITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   561
and          v          ∈                          G  2                 means             the              node           v                  is              in               right              lung.             We                              initialize                            demographic              factors               (age               and               gender)              into               graph               representa-
h(0 )i           =        xi     .           N    (i   )                is                the                set                of               nodes               adjacent               to             v i     .           σ                              is                 the     tion.                 As                  shown                  in                   Fig.                  2,                  we                  further                 feed                 the                  concatenated
activation             function             and         ||             denotes            the             concatenation            operation                                                                                                                                             representation             into              the              MLPs              [45]             to              obtain              the              embedding             e
over              two               vectors.                                                                                                                                                                                                                                             by          a           non-linear         mapping.         Finally,          Fully          Connected          (FC)           layers
          Then,                node               representation               is                iteratively                updated               by                neigh-                                                                                                               are                  utilized                  to                  identify                  the                  class                  probability                  and                  predict                  the
bors’                      projected                     features                     with                      corresponding                    coefﬁcients                     as                                                                                                      conversion             time.
follows:                                                                                                                                                                                                                                                                                            Unlike                single-task               method,               our                objective               function               consists
                                                         h(l +1,k )                                                                            α      ij           ·      Mh(l ,k )                                                                                                      of             two             parts.             The             preliminary            objective             function            is             deﬁned             as
                                                               i                                                                           =      σ(                       ∑         j                                  ),                                                                                                                                                                                                       (4)follows:
                                                                                                                    j  ∈     N   (i )
where          M              is              the              state              transformation             matrix.                                                                                                                                                                                                                                                             L              =      Lcl a         +     Lreg  ,                                                                                                                                                                                                                                                                                                                              (9)
          Because                     left                     lung                     segments                    and                     right                     lung                    segments                    do                                                             where            Lcl a                          represents                      the                      loss                       of                      classiﬁcation                       and            Lreg
not                     have                     direct                     interconnection,                    the                     graph                     consists                     of                     two                                                                represents             the              loss              of             regression.
subgraphs                  corresponding                 to                       each                   lung.                  To                   acquire                   the                   sub-                                                                                           For                      the                      classiﬁcation                      task,                      the                      issue                      of                      imbalance                     clas-
graph               representation,              we                adopt               a                “Readout”               function              [43]               to                                                                                                              siﬁcation                           tends                            to                            result                            in                           classiﬁcation                            results                            bias                            to
map                  the                  node                 representation                 into                  a                  unique                 embedding.                 The                                                                                             the                       majority                       class.                        To                        solve                       the                       class                        imbalance                      problem
representation             vector             of              a              subgraph             in              the              previous             layer              can                                                                                                           in                        COVID-19                       dataset,                        the                        Focal                       Loss                        (FL)                       [16]                       is                       intro-
be             represented             as:                                                                     {                                                                                                                                                                         duced                to                 our                model.                 The                 loss                 of                 classiﬁcation                 is                 deﬁned                 as
                                                             zk           =           SUM(                           h(l +1,k )i                                                                   |v i           ∈                          G  k  }).                                                                                                                                                                                                                      (5)follows:
          2)              Subgraph-Level             Attention  :                   According                   to                    [44],                   the                    right                                                                                                                       Lcl a            =        L FL
lung                 is                 wide                 and                 short                 whereas                the                 left                 lung                 is                 narrow                and                                                                                                                           ∑N
long.                      The                       volume,                      total                      capacity                      and                       weight                      of                       the                       right                                                                                =                          1N              −             ζ           (1      −                    C      ·      en  )γ               ·            yn        ·      log     (C      ·       en  )     ,                        (10)
lung                     are                      greater                     than                     those                      of                     the                      left                      one.                     Due                      to                      these                                                                        n=1
differences                in                 anatomy,                the                 infection                 of                 right                 and                 left                 lungs                                                                              where                     N                     is                 the                 number                of                subjects.              en                    and                     yn                     are                the                 ﬁnal
may                be                different.               To                learn                the                importance               of                different               lungs                                                                                         embedding                    and                     corresponding                    label,                     respectively.                   C                      is                      the
for           COVID-19           diagnosis,          the           subgraph-level         attention           is           intro-                                                                                                                                                        parameter                   of                   the                    classiﬁer.                ζ                             and               γ                                 are                   two                    hyperparame-
duced.          The          model          ﬁrst           transforms          the          representation          through         a                                                                                                                                                    ters.                  ζ                                   is                         the                         weighting                         factor                         for                         different                        classes.                          The
nonlinear        transformation.        Subsequently,        it          measures         the         weight                                                                                                                                                                             modulating               factor             γ                              is                 used                 to                down-weight               easy                 cases                 and
of                   subgraph                   representation                   as                   the                    similarity                    of                   transformed                                                                                              focus                      on                      training                      hard                      negat ives.                     Focal                      loss                       can                       assist                       in
embedding                 with                   an                   attention                  vector.                  The                  weight                       a  k                      can                   be                                                           identifying         severe          cases           from          mild          cases           to          enhance          the          model
calculated              as:                                                                                                        (                                                   )                                                                                                 performance.
                                                                  a  k          =        qT           ·        tanh                      W      ·       zk         +      b                    ,                                                                                                                                                                                                                                          (6)For                 the                 regression                task,                 we                 aim                 to                 predict                the                 conversion
                                                                                                                                                                                                                                                                                         time                  from                 mild                  to                  severe.                 We                   ﬁrstly                  divide                  mild                  cases                   into
where            W                is                the                weight                matrix               and            b                is                the                bias                vector.           q                is                                         two                categories,                including                mild                cases                which                convert                to                better
the             attention            vector.            Furthermore,           we             normalize            the             weight            of                                                                                                                                  or                   worse.                   At                    the                   same                   time,                   to                   ensure                   effectiveness                  of                   the
subgraph            by                                                                                                                                                                                                                                                                   above-mentioned           classiﬁcation              tas k,             we              further            set             three-state
                                                                                                                                                 a  k  )                                                                                                                                 cases                 in                  the                 dataset,                  namely                 severe,                 mild                 turning                 better                 and
                                                                                   β             k          =                                                                          exp    (∑2a  k  ).                                                                                                                                                                                                                                                                                                          (7)mild                   turning                  to                   severe.                  The                   state                   of                   mild                   turning                  to                   severe
                                                                                                                         k =1         exp     (                                                                                                                                          plays            a            most            important           role            in              our           model,           because           it            has            label
          Obviously,                  a                  higher              β             k                       means                  left                   (k =1)                  or                  right                  ( k =2)                                              information             of              the              conversion             time.              Hence,             the        Lreg                  consists
lung           plays          a            more           important          role.           And           then,           we           fuse           subgraph                                                                                                                          of               the               Cross-Entropy              Loss               (CE               Loss)         LCE                    for               classiﬁcation
representations             to             obtain             the             graph             representation            by                                                                                                                                                             and                   the                    Mean                    Squared                   Error                   Loss                   (MSE                    Loss)            L MSE                            for
                                                                                                                         2                                                                                                                                                               regression,             which             is              deﬁned             as              follows :
                                                                                                z        =         ∑β             k         ·      zk  ,                                                                                                                                                                                                                                                                                                                                                              (8)
                                                                                                                                                                                                                                                                                                Lreg            =       LCE         +     L MSE
                                                                                                                    k =1                                                                                                                                                                                                                           ∑N                                                                                                                          ∑N
where           graph           representation          z            is            aggregated           from           right           and            left                                                                                                                                                                =                          1N             −                      y  rn         ·      log      (Cr          ·       en  )  +                     1N                 (tn         −                    R      ·      en  )2 ,
lungs              by              the               attention              mechanism.              Afterwards,              we              can               apply                                                                                                                                                                               n=1                                                                                                                         n=1
the              graph             representation             in              multi-task             learning.                                                                                                                                                                                                                                                                                                                                                                                                                                      (11)
C.               Joint          Classiﬁcation          and          Regression          Optimization                                                                                                                                                                                     where                     y  rn                     is                  the                 label                  indicating                 possible                 state                  (severe,                 mild
                                                                                                                                                                                                                                                                                         turning               better                or                mild                turning               to                severe)               and            Cr                     is                the                para-
          With              the             graph             representation            fused             by             the             attention             mech-                                                                                                                     meter            of            the            three-state            classiﬁer.             The            superscript           r                represents
anism,                 our                 study                 performs                two                  tasks                 (i.e.,                  classiﬁcation                 and                                                                                            the                   regression                   task.              R                   is                   the                   parameter                  of                  the                   regressor.                     tn
regression)                 by                 a                 multi-task                 learning                 framework.                To                  compre-                                                                                                               and              R      ·       en                      are                  the                  ground                 truth                  of                  conversion                 time                  and                  the
hensively         diagnose          the          subject’s            condition,         we          incorporate         two                                                                                                                                                             prediction,            respectively.
            Authorized licensed use limited to: Necmettin Erbakan Universitesi. Downloaded on February 18,2025 at 17:29:34 UTC from IEEE Xplore.  Restrictions apply.

562                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         IEEE        TRANSACTIONS       ON        MEDICAL       IMAGING,        VOL.       42,        NO.       2,        FEBRUARY       2023
                                                                                                     TABLE         II                                                                                                                            tasks.                        We                        compare                       SAGNN                        with                        two                        types                       of                       baselines:
       T HE         D EMOGRAPHIC                    I NFORMATION    OF                      S UBJECTS     IN      THE                DATASET .                                                                                                   classical             machine            learning            methods            and            neural            network            based
                   M ILD          C ASES             C ONVERTED      TO                  S EVERE              S TAGE      ON           AVERAGE                                                                                                   methods.                     For                      the                      classiﬁcation                      task,                      we                      compare                     SAGNN
                                                                                          5.1±3.9     D AY  S                                                                                                                                    with         six         baselines.         Classical          machine         learning         methods         include
                                                                                                                                                                                                                                                 Logistic                            Regression                             (LR)                             [46],                            Support                            Vector                             Machine
                                                                                                                                                                                                                                                 (SVM)           [47]           and           Random           Forest           Classiﬁer            (RFC)            [48].           Neural
                                                                                                                                                                                                                                                 network            methods            include            Graph            Convolution           Neural            Network
                                                                                                                                                                                                                                                 (GCN)         [49],         Graph         Sample         and         Aggregate        (GraphSAGE)        [50],
         In                      summary,                     the                      total                     objective                     function                     that                     should                     be               Graph                        Isomorphism                       Network                        (GIN)                         [43],                        ResNet50                         [51],
minimized             is              induced             as              follows :                                                                                                                                                              DenseNet121                         [52],                         ViT                          [53]                         and                          Swin-Transformer                         [54].
                                                                                                                                                                                                                                                 GraphSAGE                       and                       GIN                        are                       two                        popular                       models                       for                        graph
                          L                =       L FL         +      δ        1 LCE         +      δ        2 L MSE                                                                                                                            classiﬁcation.               GCN               is               a               semi-supervised              graph              convolutional
                                                             ∑N                                                                                                                                                                                  network                     method                     and                      it                      is                      used                      for                      graph                     classiﬁcation                      in
                                       =                          1N       −             ζ           (1      −                    C      ·      en  )γ               ·            yn         ·      log      (C      ·       en  )               our              experiment.             ResNet50              and              DenseNet121             are              two              popular
                                                             n=1                                                                                                                                                                                 CNN-based                     models                    for                    image                     classiﬁcation.                     ViT                     interprets
                                                 −                  δ        1     y  rn         ·      log      (Cr          ·       en  )  +      δ        2 (tn         −                    R      ·       en  )2 ,                                                        (12)the                    image                   as                    a                    sequence                   of                    patches                   and                    processes                   it                    by                   a
                                                                                                                                                                                                                                                 vanilla             transformer.            Swin-Transformer           is             an             improved            version
where            non-negative        δ        1               and        δ        2               are            hyperparameters          to            balance                                                                                  of                 ViT,                  which                 combines                the                  ideas                 of                 transformer                 and                 CNN
the          effect          of          classiﬁcation          and          regression.         The          proposed         model                                                                                                             to              model              features              of              different              scales.              For              the              regression              task,
can                 conduct                both                 COVID-19                 diagnosis                 and                 conversion                time                                                                            we               also               compare              SAGNN               with               six               baselines,              including              Ran-
regression                        by                         a                        structural                        attention                        graph                        neural                        network                      dom            Forest             Regressor            (RFR)             [48],            Support            Vector            Regression
framework.                 The                  proposed                 method                 has                  the                  following                 merits:                                                                      (SVR)                   [47],                  Partial                   Least                   Squares                  Regression                  (PLSR)                   [55],
(1)                        it                         can                         combine                        the                         multi-source                        information                        to                         learnGaussian                        Process                        Regressor                       (GPR)                        [56],                       Fully                        Connected
comprehensive          representations          for            diagnosis           and            prediction           of                                                                                                                        Neural                   Network                   (NN)                    [45]                   and                   Deep                    Graph                   Convolutional
COVID-19             severity;             (2)             it              adopts             a              structural             attention             mech-                                                                                  Neural                   Network                   (DGCNN)                    [57].                   Furthermore,                  we                    compare
anism.            Node-level           attention            is             able            to             learn            segment           represen-                                                                                           SAGNN            with            a            multi-task            method           [4]            by            using            sparse            logistic
tations                   by                   aggregating                 information                  from                   segment                  neighbors                                                                                regression                       and                        linear                        regression                       for                        COVID-19                        diagnosis.
and           subgraph-level          attention           is           able           to            learn           the            importance          of                                                                                        In                   this                   study,                  binary                  classiﬁcation                   performance                  is                   evaluated
different             lungs.                                                                                                                                                                                                                     in                   terms                   of                   Accuracy                  (ACC),                   Sensitivity                   (SEN),                   Speciﬁcity
                                                                              III.                E    XPERIMENTS                                                                                                                                (SPE)           and           Area           Under           Curve           (AUC).           Regression           performance
A.                Data           and           Setup                                                                                                                                                                                             is           evaluated          in           terms           of           Correlation           Coefﬁcient          (CC)           and           Root
                                                                                                                                                                                                                                                 Mean             Square             Error             (RMSE).
         In          this           study,          the           dataset          is           collected          by          the           Shanghai          Public                                                                                      In              SAGNN,              we              apply              four             node-level             attention              layers,              one
Health               Clinical              Center,              which               is               composed              of              365              conﬁrmed                                                                             graph-level               attention               layer                and                two                MLP                layers.                Each                node-
COVID-19              subjects              and              each              subject              has              multiple              scans              over                                                                               level                    attention                    layer                    is                     followed                    by                    a                     Batch                    Normalization
time.                    From                    each                    patient,                    we                    coll ected                    the                    following                    infor-                              (BN)               layer               and               a                Rectiﬁed                Linear               Unit               (ReLU).               Dimensions
mation:               (1)              CT               scans,               (2)               clinical               features,              (3)              severity-level,                                                                    of               node-level              attention               vector             p                and               subgraph-level              attention
(4)               patient               outcome               (recovered,              decreased,               or               censored),              and                                                                                     vector         q            are            set            to            256           and            128,           respectively.           We            adopt           Adam
(5)                 outcome                occurring                days                 since                 admission.                 In                 the                 dataset,                                                        optimizer         [58]          with           an           initial          learning          rate          of          0.001,         multiplied
there            are            1687            chest            CT             scan             images            and            the             clinical            features                                                                   by                 0.7                 in                 every                 50                 epochs.                 The                 batch                 size                  is                 set                 to                 64                 and
include                         two                         demographics                       (age                         and                         gender).                        The                         patient                      the                   dropout                  ratio                   is                   set                   to                   0.5.                  For                   hyperparameters                 in                   our
statistics                are               summarized              in                       Ta     b     l     e                            I     I.                             Informed             consents              are                 framework,                      we                       tune                       them                       to                       obtain                       optimal                       performance.
waived            and            all             private            information           of            subjects             is             anonymized.                                                                                          In                       the                      experiment,                      all                       samples                      are                      randomly                      divided                      into
Moreover,               all                 subjects                 are                 conﬁrmed                by                 the                 Chinese                 Center                                                           10                      subsets                      on                      average.                     The                      ratio                      of                      samples                      for                      training,
for                  Disease                   Control                  and                  Prevention                 (China                  CDC)                   based                  on                                                 validation            and             testing             is             8:1:1.            Moreover,            we                          repeat             20             times
the            new             coronavirus           nucleic            acid            antibody            detection.            Subjects                                                                                                       to                    avoid                    possible                    biases.                    The                    mean                   and                    standard                   deviation
undergo           a            thin-section            CT            scan            by            scanners.            The            CT            protocol                                                                                    of               performances              are               reported.               To               ensure               fair                comparison,              all
is                        listed                        as                       follows:                       slice                        thickness:                       1-1.5                       mm,                        kV:                       120,baselines                 are                  initialized                  with                  same                  parameters                 suggested                  by
and                    breath                    hold                    at                    full                    inspiration.                    More                    details                    about                   the            their               papers               and               we               also               furthe r               carefully               turn               parameters              to
image        acquisition        and        the         image         pre-processing       could        be        found                                                                                                                           get             optimal             performance.
in                 [41].                 It                 is                 worth                 noting                that                 the                 conversion                time                 may                 be        B.                Experiment
affected                  by                  some                   treatments,                    such                   as                   taking                  medicine.                  If                   a
mild                       patient                       gets                       better,                      the                       conversion                      time                       will                       become                    1)             Classiﬁcation              and              Regression              Results :                    The                    comparison
longer                  or                  even                  the                   mild                   patient                  will                   not                  turn                  into                   a                   severeresults         are         summarized        in           Table         III.         It         can         be         seen         that         SAGNN
stage.                   Therefore,                  the                   convers  ion                  time                    prediction                   can                    reﬂect                                                      obtains          signiﬁcantly          better          performance        than          baselines          on          both
the              patient’s             condition             to              some              extent.                                                                                                                                           classiﬁcation              and              regression              tasks.
         To                 demonstrate                 the                 effectiveness                of                 SAGNN,                 we                 conduct                                                                                       a)              Classiﬁcation                 results:                  From                Table                III,                we                can                ﬁnd                that
extensive                   experiments                   on                    both                    classiﬁcation                    and                    regression                                                                       SAGNN            achieves            the             best             classiﬁcation             performance           in             terms
           Authorized licensed use limited to: Necmettin Erbakan Universitesi. Downloaded on February 18,2025 at 17:29:34 UTC from IEEE Xplore.  Restrictions apply.

LIU       et       al.:          SAGNN       FOR       DIAGNOSIS        AND      PREDICTION       OF       COVID-19       SEVERITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   563
                                                                                                                                                                                                                              TABLE         III
                                                                                                                              R ESULTS     ON           COVID-19     C      LASSIFICATION    AND                      R EGRESSION                  TASKS
of                    ACC,                    SEN                    and                    AUC.                     As                    for                    SPE,                    the                    performance                   of                                                                                                      TABLE         IV
SAGNN           is           a           little           lower           than          that           of           traditional          machine          learn-                                                                                                                                    R ESULTS     ON             M ULTIPLE           C LASSIFICATION
ing              methods              (i.e.,              LR,              SVM              and              RFC)              as               SAGNN              can              solve
imbalance             problem             of              class              distribution             to              improve             AUC              and
SEN             scores.             Speciﬁcally,             in             terms             of             AUC,              SAGNN             achieves
17.16%-18.33%            and             5.32%-9.54%            improvements            over             classi-
cal                  machine                 learning                 methods                and                 neural                 network                 methods,
respectively.                  Compared                   with                    single-task                   based                    classiﬁcation
methods,                     the                     proposed                     classiﬁcation                     module                     (i.e.,                     SAGNN
w/o                Regression)                achieves               competitive                performances              in                terms
of                 four                 metrics.                 The                 proposed                   method                (i.e.,                 SAGNN)                 could
perform                       joint                       regression                       and                        classiﬁcation,                        thus                       achieving
better              classiﬁcation              results.              Therefore,             joint              classiﬁcation              and                                                                                                     and                   red                    dots                    represent                   mild                    and                    severe                   cases,                    respectively.
regression               framework              is                useful               to               identify               severe               cases                from                                                                     It                       can                        be                       observed                       that                       two                        classes                        are                       distributed                       more
mild                    conﬁrmation                   cases.                     Moreover,                   although                    work                    [4]                    and                                                       clearly                  and                   compactly                  as                   in                    Fig.                  4                   (f),                  which                  demonstrates
our                       method                      are                       both                       multi-task                       learning                       models,                       SAGNN                                    the                  desired                  discriminative                 ability                  of                  SAGNN                  on                  conducting
obtains                     better                      performance                    in                      terms                     of                     all                      four                     evaluation                      graph                classiﬁcation.                 Through               the                 visualization,                we                 can                intu-
metrics                     because                    it                     could                    incorporate                   both                    infection                    feature                                                 itively              see               that               our              model              reduces              the               intra-class              variation              to
and                       lung                       structural                      information                      into                       a                       uniﬁed                       framework.                                  make                classiﬁcation                 better                than                 GCN,                 GIN                and                GraphSAGE,
To                     further                    verify                    the                     effectiveness                    of                     SAGNN                     on                    multiple                              indicating                  that                   the                   learned                  graph                  representation                  of                   SAGNN
classiﬁcation,                  we                  subdivide                 the                  dataset                  into                  four                 categories,                                                                can             better             reveal             the             underlying            class              structure.
i.e.,                        mild,                        moderate,                       severe                        and                        critical.                        We                         adopt                        ACC,            To                   verify                   the                    effectiveness                  of                   structural                   attention                   mecha-
Macro-F1                score                (F1)                 as                 evalua tion                metrics.                 The                 comparison                                                                           nism                and                demographic              information,              we                conduct               the                ablation
results              are              provided             in                        Ta     b     l     e                           I     V.              It              can              be              seen              that              SAGNNexperiment                    as                     shown                     in                        Fig.                      5.                      SAGNN-a                      and                      SAGNN-d
obtains             the             best              performances               compared             with              baselines.                                                                                                                are               two               counterparts              that               do               not               consider               structural              attention
         For            a            more           intuitive           comparison,           we            further           provide           visual-                                                                                           mechanism             and             demographic            information            of             subjects,             respec-
ization         results         of          classiﬁcation,         which         can          visually         demonstrate                                                                                                                        tively.                    From                    Fig.                    5,                    we                    can                    see                    that                   the                    proposed                   method
effectiveness                      and                       informativen  ess                      of                       latent                       representations.                                                                        achieves                  the                   best                   classiﬁcatio n                   performance                  in                   terms                   of                   all
Speciﬁcally,                  we                   learn                   graph                  embeddings                 based                   on                   the                   pro-                                              four                     metrics,                      indicating                     that                      SAGNN                      can                      capture                     the                      rich
posed                   model                  and                   then                   project                  the                   learned                   embeddings                 into                                              information          between          left           and           right           lungs          and           improve          learning
a                     2-dimensional                   space                    by                     t-SNE                    toolkit                    [59].                    Samples                    are                                 performance                with                 the                 help                 of                 demographic                information.                We
colored         based          on         their         labels.          We            report         visualization         results          of                                                                                                   also          adopt         the          independent         two-sample         t-test           between         SAGNN
original             features              of              COVID-19              da ta,              single-task              classiﬁcation                                                                                                       and                two                variants                based                on                20                different                trials                to                 measure                the
methods                     (i.e.,                      GraphSAGE,                     GCN                      and                      GIN),                      the                      proposed                                             signiﬁcance              of              the              improvement,            concluding             that              all              compar-
method         without         considering        regression         task         (i.e.,         Proposed         w/o                                                                                                                             isons             are              statistically              signiﬁcant              (     p        <           0.05).             To             further            verify
Regression)        and        the         proposed       method.        As         shown        in             Fig.         4,blue                                                                                                                the            effectiveness           of            focal            loss              and            joint            training,           we                         compare
           Authorized licensed use limited to: Necmettin Erbakan Universitesi. Downloaded on February 18,2025 at 17:29:34 UTC from IEEE Xplore.  Restrictions apply.

564                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         IEEE        TRANSACTIONS       ON        MEDICAL       IMAGING,        VOL.       42,        NO.       2,        FEBRUARY       2023
Fig.        4.                           Visualization         of         ﬁnal         embedding.        Each         point         indicates        one         case         and         its         c olor        indicates         the         label.        Blue         and         red         points        represent         mild         cases
and        severe         cases,         respectively.
                                                                                                                                                                                                                                                             the                 least                  estimation                 error                 (i.e.,                 1.27            ±                 0.47)                compared                with
                                                                                                                                                                                                                                                             baselines.                    It                    obtains                   0.041                    improvement                  over                   the                     proposed
                                                                                                                                                                                                                                                             w/o                       classiﬁcation                       method                      in                       terms                       of                       CC.                        Similar                       to                       the
                                                                                                                                                                                                                                                             classiﬁcation,                    results                    of                    regression                    show                    advantages                   of                    the
                                                                                                                                                                                                                                                             considerations,             such              as              lung              structural              information,             structural
                                                                                                                                                                                                                                                             attention           mechanism,           demographic          information           and           joint            clas-
                                                                                                                                                                                                                                                             siﬁcation             and             regression.
Fig.        5.                 Ablation         experimental        results.                                                                                                                                                                                 C.               Discussion
                                                                                                                                                                                                                                                                       We                       propose                      a                       structural                      attention                      graph                      neural                      network
                                                                                                                                                                                                                                                             framework               for                COVID-19               severity                classiﬁcation                and                conver-
SAGNN                 with                 three                variants                (i.e.,                 SAGNN                 w/o                 FL,                 SAGNN                                                                           sion                      time                      prediction.                     We                      provide                     detailed                     analysis                      for                     the
w/o           Regression           and           SAGNN           w/o           Classiﬁcation)            and           show           the                                                                                                                    motivation             and             effectiveness             of              each              module             in              this              section.
results               in              Table               III.              It               can               be              seen               that              SAGNN               achieves              the                                                      1)             Graph                Structure :                      The                      graph                     structure                     is                      an                      important
best          performances         compared         with              three          variants,          which          further                                                                                                                               part                        of                        our                        model.                        To                         demonstrate                        the                        rationality                        of                        the
demonstrates             the              superiority            of              our             proposed             SAGNN.                                                                                                                                 proposed                graph                construction,                correlation                coefﬁcient                 between
                   b)              Regression               results:                We              evaluate             regression             performance                                                                                                  two                   different                  lung                   segments                  is                   calculated.                  The                   heat                   map                   is
through                         the                          prediction                          of                          conversion                         time                          from                          mild                           toutilized            to             visualize             the             correlation            coefﬁcient            (i.e.,         |r   |              valu e) .
severe.                                Experimental                               results                                are                                reported                                in                                   Table                                III.Darker                     color                     indicates                     stronger                     correlation                    and                     vice                     versa.
It                   can                   be                   seen                   that                   SAGNN                   achieves                  the                   best                   performance                                     For                |r   |                        valu e,                |r   |        <           0.5,                     0.5        ≤                    |r   |        <           0.7and0.7        ≤                     |r   |        <           1
over                   all                    comparison                  methods.                   Speciﬁcally,                   SAGNN                   obtains                                                                                          indicate                   none                   or                    weak                    correlation,                   medium                   correlation                   and
11.00%-33.00%            improvement         in            terms           of           CC            and           best           perfor-                                                                                                                   strong             correlation             [60],             respectively.
mance           in           terms           of           RMSE            compared          with            other           methods.          With                                                                                                                     Fig.                 7                 shows                 correlation                results.                 It                 can                 be                 seen                 that                 there
structural             attention             mechanism             and             demographic            information,                                                                                                                                       is                        a                        strong                       correlation                      between                       connected                       lung                       segments.
SAGNN            achieves           better            perform ance          than            the            recent           work            [4]                                                                                                              Speciﬁcally,                     from                       Fig.                      7                       (a),                      we                       can                      ﬁnd                      that                      correlation
in               terms              of              CC.                                                                                                                                                                                                      coefﬁcients                 between                 anterior                 segment                 (LS_1),                 upper                 lingual
         Furthermore,               Fig.               6               shows               the               correlation               between               predic-                                                                                         segment                 (LS_2)                  and                  dorsal                  segment                 (LS_4)                  are                  larger                  than
tions               and               ground              truths              for               all               subjects.               We               can               see               that               our                                        between                others,                because                both                L  S_1                and                LS_2                belong               to                the
method               generally               outperforms              all                baselines               in                the                regression                                                                                             left                  upper                 lobe                 and                  are                  adjacent                 to                  LS_4                 in                  the                  anatomical
of                    conversion                   time.                     Moreover,                   the                    proposed                   method                    yields                                                                  structure             of              the             lung.
           Authorized licensed use limited to: Necmettin Erbakan Universitesi. Downloaded on February 18,2025 at 17:29:34 UTC from IEEE Xplore.  Restrictions apply.

LIU       et       al.:          SAGNN       FOR       DIAGNOSIS        AND      PREDICTION       OF       COVID-19       SEVERITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   565
Fig.       6.                         Visualization        for        regression.        Scatter        plots        and        corresponding        correlation        coefﬁcients        of        regression        methods        for        predicting        the         severe        cases.
The        ver tical         axis        displays        the        ground         truths         and        the         horizontal        axis        displays        the         predictions.
Fig.        7.                 Correlation         relationship        between         different        lung        segments.                                                                                                                                                   Fig.        8.                 Statistics         of        the         larger        attention         values        of        left        and         right        lungs.
          2)              Structural          Attention         Mechanism  :                Basically,               left                and               right
lungs                       have                       different                      infection                       degrees.                       SAGNN                        can                       learn
infection                             degrees                            by                             the                             structural                             attention                             mechanism.
A                 larger                attention                 weight                 means                that                 the                 lung                has                 a                 greater
inﬂuence                         for                         multi-task                         learning.                         To                          verify                         the                         effective-
ness                           of                           structural                          attention                          mechanism,                          we                           report                          statis-
tical                              results                               of                              subgraph-level                             attention                              weights                              for                              all
subjects.
          As                shown                in                Fig.                8,                in                the                training               stage,                the                ratio                of                left                       Fig.        9.                 Parameter         sensitivity.
and            right           lungs           with            larger           attention            value           is            74%:26%,           and            it
is                  75%:25%                 in                  the                 test                  stage.                 The                 results                  of                 the                 two                 stages
are                    quite                     consistent,                    indicating                    that                    the                     right                    lung                    may                    be                                        result            is           also            found           in            work           [4],           which           also            concludes           that           the
more          informative          than           the           left           lung.          Some           explanations         can           be                                                                                                                              right           lung           is           usually           more           important           for           COVID-19           diagnosis.
given             from             anatomy.             Since             the              total              volume             of              the             right              lung                                                                                                  3)             Parameter                  Analysis:                         We                         investigate                        the                         sensitivity                         of
is           larger          than          that           of           the          left           lung,          more          infection          features          may                                                                                                        parameters               and                report                results                of                SAGNN                with                 varying               para-
be              extracted             from              the              right              lung             than              the              left              lung.              A              similar                                                                     meters             as              shown              in               Fig.              9              and              Fig.             10.
            Authorized licensed use limited to: Necmettin Erbakan Universitesi. Downloaded on February 18,2025 at 17:29:34 UTC from IEEE Xplore.  Restrictions apply.

566                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         IEEE        TRANSACTIONS       ON        MEDICAL       IMAGING,        VOL.       42,        NO.       2,        FEBRUARY       2023
                                                                                                                                                                                                                                                                                                                                                                         R EFERENCES
                                                                                                                                                                                                                                                                      [1]                     D.         Wang        et         al.,         “Clinical          characteristics           of         138         hospitalized          patients          with
                                                                                                                                                                                                                                                                                    2019            novel             coronavirus–infected               pneumonia             in            Wuhan,             China,”          JA  M  A,
                                                                                                                                                                                                                                                                                    vol.            323,            no.            11,            pp.            1061–1069 ,           Feb.            2020.
                                                                                                                                                                                                                                                                      [2]                     H.               Kang                et               al.,                “Diagnosis                 of               coronavirus                disease                2019               (COVID-19)
                                                                                                                                                                                                                                                                                    with             structured             latent             multi-view              representation               learning,”       IEEE            Trans.
                                                                                                                                                                                                                                                                                    Med.              Imag.,            vol.            39,            no.            8,            pp.            2606–2614 ,            Aug.            2020.
                                                                                                                                                                                                                                                                      [3]                     M.                Barstugan,                U.                Ozkaya,                and                S.                Ozturk,                “Coronavirus                (COVID-19)
                                                                                                                                                                                                                                                                                    classiﬁcation                  using                CT                images                by                machine                 learning                 methods,”                2020,
                                                                                                                                                                                                                                                                                    arXiv:2003.09424.
Fig.    10.               Hyperparameters     tuning     of     SAGNN.    λ          1      and    λ          2       are     the     balancing                                                                                                                       [4]                     X.                  Zhu                   et                   al.,                   “Joint                   prediction                    and                   time                   estimation                    of                   COVID-19
weights        in        our        model.                                                                                                                                                                                                                                          developing              severe             symptoms            using             chest             CT             scan,”          Med.              Image             Anal.,
                                                                                                                                                                                                                                                                                    vol.            67,            Jan.            2021,            Art.            no.            101824 .
                                                                                                                                                                                                                                                                      [5]                     J.             Ye,             M.             Hua,             and             F.            Zhu,             “Machine              learning              algorithms              are             superior
                   a)              Dimension                  of                  embedding                   and                   attention                  vector:                  Since                  the                                                                  to                  conventional                    regression                   models                  in                  predicting                   risk                  stratiﬁcation                    of
performance        our         model         is          affected         by         the         dimension        of         embed-                                                                                                                                                 COVID-19            patients,”            Risk             Manag.              Healthcare              Policy,             vol.             14,            p.            3159,
ding                 z                       and                      subgraph-level                    attention                      vector                  q,                       we                      conduct                                                             Jul.            2021.
                                                                                                                                                                                                                                                                      [6]                     S.          Ruder,          “An          overview          of          multi-task          learning           in          deep          neural          networks,”
experiments          with           varying          dimensions.           According          to           Fig.           9           (a),                                                                                                                                          2017,            arXiv:1706.05098.
with         the         growth        of         dimension        of         embedding        z,         the         performance                                                                                                                                     [7]                     A.                  Amyar,                   R.                  Modzelewski,                    H.                  Li,                  and                   S.                  Ruan,                   “Multi-task                    deep
raises                ﬁrst                and                then                drops               slightly,                which               indicates               overhigh                                                                                                  learning               based               CT              imaging               analysis                for              COVID-19              pneumonia:               Clas-
                                                                                                                                                                                                                                                                                    siﬁcation             and            segmentation,”           Comput.             Biol.            Med.,            vol.           126,            Nov.           2020,
dimension                      may                       cause                       over-ﬁtting.                      Moreover,                     as                       shown                       in                                                                        Art.            no.            104037.
Fig.          9          (b),          it          can          be          observed         that          classiﬁcation          performance        of                                                                                                               [8]                     S.                 El-bana,                  A.                 Al-Kabbany,                  and                  M.                 Sharkas,                  “A                 multi-task                  pipeline
SAGNN            grows           with            increasing            dimensions           of            attention            vector                                                                                                                                               with          specialized            streams           for          classiﬁcation            and          segmentation           of          infection
                                                                                                                                                                                                                                                                                    manifestations           in         COVID-19         scans,”       PeerJ          Comput.           Sci.,         vol.          6,         p.         e303,
and                     achieves                     the                     best                      performance                    when                     it                      is                      set                      to                      128.                Oct.            2020.
However,                    the                      regression                    performance                    of                     SAGNN                     degrades                                                                                           [9]      M.Z.Alom,M.M.S.Rahman,M.S.Nasrin,T.M.Taha,and
with         a         higher        dimension.        Therefore,        we         employ        128-dimension                                                                                                                                                                     V.            K.            Asari,                     “COVID_MTNet:                     COVID-19                     detection                      with                     multi-task
                                                                                                                                                                                                                                                                                    deep            learning            approaches,”             2020,         arXiv:2004.03747.
subgraph-level                attention                 vector                 in                  our                 experiment.                 The                  pos-                                                                                      [10]                     D.                   Ahmedt-Aristizabal,                     M.                   A.                   Armin,                   S.                   Denman,                   C.                   Fookes,                    and
sible                    reason                   for                   performance                  degradation                  in                   regression                   and                                                                                             L.                Petersson,                  “Graph-based                  deep                 learning                  for                 medical                 diagnosis                  and
classiﬁcation                      is                      that                      a                      too                      large                     dimension                      may                      introduce                                                    analysis:                Past,                present               and               future,”              Sensors,                vol.               21,               no.               14,               p.            4758,
                                                                                                                                                                                                                                                                                    Jul.            2021.
redundancies.                                                                                                                                                                                                                                                     [11]                     M.              Polsinelli,                L.              Cinque,               and               G.              Placidi,                “A              light               CNN              for              detecting
                   b)              Hyperparameters        δ        1              and        δ        2 :               Moreover,          we           report           hyper-                                                                                                     COVID-19        from        CT        scans        of        the        chest,”       Pattern         Recognit.         Lett.,         vol.        140,
parameters           tuning            of            SAGNN            on            classiﬁcation            and            regression                                                                                                                                              pp.            95–100,            Dec.            2020.
                                                                                                                                                                                                                                                                  [12]                    M.            F.            Aslan,             M.            F.            Unlersen,             K.            Sabanci,              and             A.            Durdu,             “CNN-based
tasks.                      In                      the                      experiment,                     we                       change                     one                      parameter                      while                                                      transfer                    learning–BiLSTM                     network:                    A                   novel                    approach                    for                    COVID-
ﬁxing            the            other.            Experimental           results           are            provided          in            terms           of                                                                                                                        19                        infection                         detection,”                        Appl.                          Soft                         Comput.,                        vol.                        98,                        Jan.                        2021,
classiﬁcation               AUC              and              regression              CC.                             As               shown              in             Fig.             10,                                                                                       Art.            no.            106912.
                                                                                                                                                                                                                                                                  [13]                     G.                            Jia,                             H.-K.                            Lam,                            and                             Y.                             Xu,                             “Classiﬁcation                               of                            COVID-19
the             performance            is             quite             unpromising            with            δ        1         =    0or         δ        2          =          0,                                                                                                chest                             X-ray                             and                             CT                            images                             using                             a                             type                             of                             dynamic                              CNN
but                       the                       performance                     raises                       with                       larger                  δ        1                         and                 δ        2,which                                         modiﬁcation                           method,”                         Comput.                            Biol.                           Med.,                         vol.                         134,                         Jul.                         2021,
demonstrates                 the                  effectiveness                 of                  multi-task                  learning.                  When                                                                                                                     Art.            no.            104425.
                                                                                                                                                                                                                                                                  [14]                     P.                Saha,                 D.                Mukherjee,                  P.                K.                Singh,               A.                Ahmadian,                 M.                Ferrara,                 and
parameters               δ        1                       and               δ        2                       are                    chosen                    in                     the                    range                    (i.e.,                δ        1                   ∈R.           Sarkar,           “GraphCOVIDNet:           A          graph           neural            network           based           model           for
[0.03,      0.05],               δ        2       ∈[            0.09,      0.1]),                     the                     promising                     performance                                                                                                             detecting                COVID-19               from               CT               scans               and               X-rays               of               chest,”                Sci.                Rep.,
can                       be                      expected.                      Basically,                       the                        model                      is                       relatively                      robust                                             vol.            11,            no.            1,            pp.            1–16,            Dec.            2021.
and                    its                     performance                   is                     stable                     with               δ        1                      and               δ        2                       in                     a                     certain[15]                     A.           G.-U.           Juarez,            R.            Selvan,             Z.           Saghir,            and            M.           De           Bruijne,             “A            joint            3D
                                                                                                                                                                                                                                                                                    UNet-graph          neural          network-based          method          for         airway          segmentation           from
range.                                                                                                                                                                                                                                                                              chest               CTS,”              in               Proc.                Int.                Workshop                Mach.                Learn.                Med.                Imag.             Cham,
                                                                                                                                                                                                                                                                                    Switzerland:             Springer,             2019,            pp.            583–591.
                                                                                     IV.                C ONCLUSION                                                                                                                                               [16]                     T.-Y.             Lin,             P.            Goyal,              R.             Girshick,              K.             He,             and             P.             Dollar,             “Focal              loss             for
                                                                                                                                                                                                                                                                                    dense            object             detection,”             in         Proc.            IEEE            Int.             Conf.             Comput.             Vis.            (ICCV),
         In          this          paper,         we           proposed         a           novel         structural          attention          graph                                                                                                                              Oct.            2017,            pp.            2980–2988 .
neural                     network                     framework                    for                     diagnosis                     and                     prediction                     of                                                               [17]                     Z.                  Rakhimberdina,                   X.                  Liu,                  and                  T.                 Murata,                   “Population                   graph-based
                                                                                                                                                                                                                                                                                    multi-model         ensemble         method         for        diagnosing         autism         spectrum         disorder,”
COVID-19              severity.             The              lung              structural              information,             features                                                                                                                                            Sensors,            vol.            20,            no.            21,            p.            6001,            Oct.            2020.
extracted        from        chest         CT         images         and         non-imaging       patient         infor-                                                                                                                                         [18]                     A.              Kazi               et               al.,               “InceptionGCN:                Receptive                ﬁeld               aware               graph               convolu-
mation                  were                   used                   in                   our                   proposed                  framework.                  Speciﬁcally,                                                                                                 tional             network             for            disease             prediction,”              in         Proc.             Int.             Conf.              Inf.             Process.
                                                                                                                                                                                                                                                                                    Med.              Imag.           Cham,            Switzerland:             Springer,             2019,            pp.            73–85.
we                    ﬁrst                    constructed                   a                     lung                    graph                   by                    lung                    segments                   based                                  [19]                     S.        Parisot         et         al.,         “Disease         prediction          using         graph         convolutional          networks:
on                    anatomical                    structure                    of                     the                    whole                     lung.                    Then,                    we                     pre-                                              Application           to         autism          spectrum          disorder          and         Alzheimer’s           disease,”    Med.
sented                  a                  structural                 attention                 graph                 neural                 network                 to                  obtain                                                                                     Image              Anal.,            vol.            48,            pp.            117–130,            Aug.            2018.
                                                                                                                                                                                                                                                                  [20]                     X.                Yu,                S.                 Lu,                L.                Guo,                S.-H.                Wang,                 and                 Y.-D.                Zhang,                 “ResGNet-C:
graph               representation              for               jointly               performing              classiﬁcation               and                                                                                                                                     A                 graph                  convolutional                    neural                  network                  for                  detection                   of                  COVID-19,”
regression               tasks.                 Experimental               results                validated                that                the                pro-                                                                                                              Neurocomputing,             vol.            452,            pp.            592–605 ,            Sep.            2021.
posed             SAGNN             achieved            the             best             performance           compared             with                                                                                                                          [21]                     M.            Staben,             J.            Raiten,             M.            Lane-Fall,             and            M.            Scott,            “Development             of            an
                                                                                                                                                                                                                                                                                    anesthesiology             disaster             response            plan,”         Anesthesiology              Clinics,             vol.            39,
existing                   methods                  in                   identifying                  severe                   cases                   and                  predicting                                                                                              no.            2,            pp.            245–253,            Jun.            2021.
conversion          time.           We            also            want            to           use            SAGNN            on           MindSpore,                                                                                                            [22]                     A.           Vaswani           et           al.,           “Attention             is           all            you           need,”            in        Proc.            Adv.            Neural            Inf.
which                 is                 a                  new                  deep                 learning                 computing                framework.                These                                                                                             Process.            Syst.,            2017,            pp.            5998–6008 .
                                                                                                                                                                                                                                                                  [23]                     D.             Bahdanau,              K.             Cho,             and             Y.             Bengio,           “Neural              machine              translation               by
problems            are             left              for             future             work.                                                                                                                                                                                      jointly             learning             to           align             and            translate,”             2014,       arXiv:1409.0473.
           Authorized licensed use limited to: Necmettin Erbakan Universitesi. Downloaded on February 18,2025 at 17:29:34 UTC from IEEE Xplore.  Restrictions apply.

LIU       et       al.:          SAGNN       FOR       DIAGNOSIS        AND      PREDICTION       OF       COVID-19       SEVERITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   567
[24]                     S.       Liu,        W.       Zheng,        T.       Song,        and        Y.        Zong,        “Sparse        graphic         attention         LSTM                                                                                              [41]                     F.        Shan        et         al.,         “Lung        infection          quantiﬁcation          of        COVID-19        in        CT         images
                  for            EEG            emotion             recognition,”              in          Proc.             Int.             Conf.             Neural              Inf.             Process.                                                                                      with            deep            learning,”             2020,          arXiv:2003.04655.
                  Cham,            Switzerland:             Springer,             2019,            pp.            690–697.                                                                                                                                                      [42]                     P.                    Velickovic,                      G.                    Cucurull,                     A.                    Casanova,                     A.                    Romero,                    P.                    Lio,                    and
[25]                     H.                   Yang                    et                   al.,                   “Interpretable                     multimodality                     embedding                    of                   cerebral                                                  Y.            Bengio ,            “Graph            attention             networks,”             2017,        arXiv:1710.10903.
                  cortex          using          attention           graph         network          for         identifying           bipolar          disorder,”          in                                                                                                   [43]                     K.             Xu,             W.             Hu,             J.            Leskovec,              and             S.             Jegelka,              “How             powerful             are             graph
                  Proc.            Int.            Conf.             Med.            Image             Comput.             Comput.-Assist.             Intervent.         Cham,                                                                                                                    neural          networks?”           in        Proc.          Int.          Conf.          Learn.          Represent.,         2019,         pp.            1–17.
                  Switzerland:             Springer,             2019,            pp.            799–807.                                                                                                                                                                       [44]                     J.                 F.                 Tomashefski                 and                 C.                 F.                 Farver,                  “Anatomy                 and                 histology                  of                 the
[26]                     J.             Ma,             X.             Zhu,             D.             Yang,              J.             Chen,              and             G.             Wu,             “Attention-guided               deep                                                    lung,”             in             Dail              and             Hammar’s              Pulmonary             Pathology.Berlin,Germany:
                  graph            neural            network            for            longitudinal             Alzheimer’s             disease            analysis,”            in                                                                                                                Springer,             2008,            pp.            20–48.
                  Proc.            Int.            Conf.             Med.            Image             Comput.             Comput.-Assist.             Intervent.         Cham,                                                                                                 [45]                     M.                  W.                  Gardner                   and                  S.                  R.                  Dorling,                   “Artiﬁcial                   neural                   networks                    (the
                  Switzerland:             Springer,             2020,            pp.            387–396.                                                                                                                                                                                          multilayer                   perceptron)—A                   review                  of                 applications                   in                  the                 atmospheric
[27]                     W.                  Zheng                   et                  al.,                   “Pay                   attention                    to                   doctor–patient                    dialogues:                   Multi-                                     sciences,”                          Atmos.                          Environ.,                          vol.                          32,                          nos.                          14–15,                          pp.            2627–2636 ,
                  modal           knowledge            graph           attention            image-text            embedding            for           COVID-19                                                                                                                                      Aug.           1998.
                  diagnosis,”            Inf.            Fusion,            vol.            75,            pp.            168–185,            Nov.            2021.                                                                                                             [46]                     A.          Y.          Ng          and          M.          I.          Jordan,          “On          discriminative            vs.          generative            classiﬁers:
[28]                     C.                 Sitaula                  and                  M.                 B.                 Hossain,                  “Attention-based                   VGG-16                 model                  for                                                     A                comparison                of                logistic                regression                and                naive                Bayes,”                in            Proc.                 Adv.
                  COVID-19                    chest                   X-ray                    image                   classiﬁcation,”                    Appl.                     Intell.,                    vol.                   51,                                                         Neural             Inf.            Process.            Syst.,            2002,            pp.            841–848.
                  pp.            2850–2863 ,            May            2021.                                                                                                                                                                                                    [47]                     L.                      J.                       Cao,                       S.                       S.                      Keerthi,                        C.                       J.                       Ong,                       P.                      Uvaraj,                       X.                       J.                      Fu,                       and
[29]                     R.                         Cipolla,                           Y.                          Gal,                         and                          A.                         Kendall,                          “Multi-task                           learning                          usingH.            P.           Lee,         “Developing           parallel           sequential           minimal          optimization           for          fast
                  uncertainty                     to                    weigh                    losses                    for                   scene                   geometry                    and                    semantics,”                    in                                      training                support               vector                machine,”            Neurocomputing,                 vol.               70,               nos.               1–3,
                  Proc.                    IEEE/CVF                    Conf.                     Comput.                     Vis.                    Pattern                    Recognit. ,                     Jun.                    2018,                                                      pp.            93–104,            Dec.            2006.
                  pp.            7482–7491 .                                                                                                                                                                                                                                    [48]                     V.                 Svetnik,                 A.                Liaw,                 C.                Tong,                J.                C.                 Culberson,                 R.                 P.                Sheridan,                 and
[30]                     M.         Liu,         J.         Zhang,         E.        Adeli,          and         D.         Shen,         “Joint         classiﬁcation          and         regres-                                                                                                B.            P.            Feuston,            “Random             forest:            A            classiﬁcation              and            regression            tool            for
                  sion           via           deep           multi-task            multi-channel             learning            for           Alzheimer’s            disease                                                                                                                     compound              classiﬁcation               and              QSAR             modeling,”           J.              Chem.               Inf.              Comput.
                  diagnosis,”              IEEE              Trans.              Biomed.               Eng.,             vol.             66,              no.              5,             pp.            1195–1206 ,                                                                              Sci.,            vol.            43,            no.            6,            pp.            1947–1958 ,            2003.
                  May            2019.                                                                                                                                                                                                                                          [49]                    M.         Defferrard,           X.         Bresson,          and         P.         Vandergheynst,           “Convolutional            neural
[31]                     D.            Zhang            and            D.            Shen,            “Multi-modal             multi-task             learning             for            joint            pre-                                                                                    networks             on            graphs            with            fast            localized             spectral             ﬁltering,”             in      Proc.            Adv.
                  diction          of         multiple           regression          and          classiﬁcation           variables           in          Alzheimer’s                                                                                                                              Neural             Inf.            Process.            Syst.,            vol.            29,            2016,            pp.            3844–3852.
                  disease,”            NeuroImage,             vol.            59,            pp.            895–907 ,           Jan.            2012.                                                                                                                          [50]                     W.               L.               Hamilton,                R.                Ying,                and                J.               Leskovec,                “Inductive                 representation
[32]                     D.                 Coppola,                  H.                 K.                 Lee,                  and                 C.                  Guan,                  “Interpreting                   mechanisms                  of                                    learning             on            large             graphs,”             in          Proc.             31st             Int.             Conf.             Neural              Inf.             Process.
                  prediction            for          skin           cancer            diagnosis       using           multi-task            learning,”            in        Proc.                                                                                                                  Syst.,            2017,            pp.            1025–1035 .
                  IEEE/CVF            Conf.             Comput.             Vis.            Pattern             Recognit.              Workshops             (CVPRW),                                                                                                           [51]                     K.                  He,                  X.                 Zhang,                  S.                  Ren,                  and                 J.                  Sun,                  “Deep                  residual                  learning                  for
                  Jun.            2020,            pp.            734–735 .                                                                                                                                                                                                                        image          recognition,”            in         Proc.           IEEE          Conf.           Comput.           Vis.           Pattern           Recognit.
[33]                     M.             V.            S.             De            Cea,             K.             Diedrich,             R.             Bakalo,             L.            Ness,             and            D.             Richmond,                                                (CVPR),           Jun.            2016,            pp.            770–778 .
                  “Multi-task           learning           for          detection           and          classiﬁcation            of          cancer            in          screen-                                                                                             [52]                     G.                     Huang,                      Z.                     Liu,                     and                      L.                     Van                      Der                      Maaten,                       “Densely                       connected
                  ing            mammography,”            in           Proc.            Int.             Conf.             Med.             Image             Comput.             Comput.-                                                                                                         convolutional                    networks,”                   in                 Proc.                    IEEE                   Conf.                     Comput.                     Vis.                   Pattern
                  Assist.            Intervent.             Cham,            Switzerland:             Springer,             2020,            pp.            241–250 .                                                                                                                              Recognit.            (CVPR),           Jul.            2017,            pp.            4700–4708 .
[34]                     W.          Ding,          M.          Abdel-Basset,           H.          Hawash,           and          O.          M.          Elkomy,          “MT-nCov-                                                                                           [53]                     A.            Dosovitskiy             et            al.,            “An            image            is            worth             16×16           words:            Transformers
                  net:                   A                   multitask                   deep-learning                     framework                   for                   efﬁcient                   diagnosis                    of                                                            for            image            recognition             at            scale,”             2020,         arXiv:2010.11929.
                  COVID-19         using         tomography         scans,”       IEEE        Trans.         Cybern.,         early         access,                                                                                                                             [54]                     Z.           Liu           et            al.,            “Swin           Transformer:            Hierarchical             vision            transformer            using
                  Nov.           18,           2021,            doi:           10.1109/TCYB.2021.3123173.                                                                                                                                                                                          shifted         windows,”        in       Proc.        IEEE/CVF       Int.        Conf.        Comput.        Vis.,        Oct.        2021,
[35]                     P.                   Yazdekhasty                     et                   al.,                    “Bifurcated                     autoencoder                     for                    segmentation                     of                                              pp.            10012–10022 .
                  COVID-19            infected              regions             in            CT             images,”             in         Proc.             Int.             Conf.             Pattern                                                                       [55]                     H.             Martens               and             M.              Martens,              “Modiﬁed               jack-knife               estimation               of              para-
                  Recognit.           Cham,            Switzerland:             Springer,             2021,            pp.            597–607.                                                                                                                                                     meter             uncertainty               in             bilinear              modelling              by             partial             least             squares              regres-
[36]                     D.              Fan              et              al.,              “Inf-Net:               Automatic               COVID-19              lung              infection               segmen-                                                                                sion               (PLSR),”                 Food                 Quality                  Preference,                 vol.                11,                nos.                1–2,                pp.            5–16,
                  tation                    from                   CT                   images,”     IEEETrans.Med.Imag.                   ,                   vol.                   39,                   no.                   8,                                                               Jan.            2000.
                  pp.            2626–2637 ,            Aug.            2020.                                                                                                                                                                                                   [56]                     C.              E.              Rasmussen,               “Gaussian               processes               in              machine               learning,”               in           Sum-
[37]                     G.            Wang            et            al.,            “A            noise-robust             framework            for            automatic             segmentation                                                                                                 mer                  School                  on                 Machine                  Learning.                 Berlin,                 Germany:                 Springer,                 2003,
                  of            COVID-19            pneumonia             lesions             from            CT             images,”          IEEE           Trans.            Med.                                                                                                               pp.            63–71.
                  Imag.,            vol.            39,            no.            8,            pp.            2653–2663 ,           Aug.            2020.                                                                                                                      [57]                     M.               Zhang,               Z.               Cui,                M.               Neumann,               and               Y.               Chen,                “An               end-to-end                deep
[38]                     M.                   Goncharov                     et                    al.,                   “CT-based                    COVID-19                    triage:                     Deep                    multitask                                                    learning           architecture            for          graph          classiﬁcation,”            in     Proc.          32nd          AAAI         Conf.
                  learning             improves            joint            identiﬁcation              and           severity             quantiﬁcation,”       Med.                                                                                                                               Artif.             Intell.,            2018,            pp.            1–8.
                  Image              Anal.,            vol.            71,            Jul.            2021,            Art.            no.            102054 .                                                                                                                  [58]                     D.          P.          Kingma          and          J.          Ba,          “Adam:          A          method          for          stochastic           optimization,”
[39]                     S.             I.             Ktena             et             al.,             “Distance              metric             learning              using             graph             convolutional                                                                         in            Proc.            Int.            Conf.             Learn.            Represent.             (ICLR),            2016,            pp.            1–15.
                  networks:            Application            to           functional            brain           networks,”            in     Proc.           Int.            Conf.                                                                                             [59]                     L.                 V.                  D.                 Maaten,                  “Accelerating                    t-SNE                 using                  tree-based                   algorithms,”
                  Med.                    Image                     Comput.                    Comput.-Assist.                     Intervent.                 Cham,                   Switzerland:                                                                                                 J.             Mach.             Learn.            Res.,            vol.            15,            no.            1,            pp.            3221–3245 ,            Oct.            2014.
                  Springer,             2017,            pp.            469–477 .                                                                                                                                                                                               [60]                     J.                   Li,                   J.-B.                   Martens,                    and                   J.                   J.                   V.                   Wijk,                    “Judging                    correlation                     from
[40]                     M.         Chung         et         al.,         “CT         imaging         features          of         2019         novel         coronavirus          (2019-                                                                                                          scatterplots             and           parallel             coordinate             plots,”       Inf.            Visualizat.,            vol.           9,            no.           1,
                  nCoV),”            Radiology,             vol.            295,            no.            1,            pp.            202–207 ,            2020.                                                                                                                                 pp.            13–30,            Jan.            2010.
            Authorized licensed use limited to: Necmettin Erbakan Universitesi. Downloaded on February 18,2025 at 17:29:34 UTC from IEEE Xplore.  Restrictions apply.

